{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/action-on-scroll.js","webpack:///./src/aria-attributes.js","webpack:///./src/how-to-apply--research.js","webpack:///./src/main.js","webpack:///./src/patterns.js","webpack:///./src/patterns/accordion/accordion.js","webpack:///./src/patterns/animation/content-fade-in/content-fade-in.js","webpack:///./src/patterns/animation/content-separator/content-separator.js","webpack:///./src/patterns/animation/content-slide-up/content-slide-up.js","webpack:///./src/patterns/animation/image-expand/image-expand.js","webpack:///./src/patterns/animation/number-animation/number-animation.js","webpack:///./src/patterns/animation/particle/particle.js","webpack:///./src/patterns/animation/svg-path-animation/svg-path-animation.js","webpack:///./src/patterns/back-to-top/back-to-top.js","webpack:///./src/patterns/charts/charts.js","webpack:///./src/patterns/cms-editor-warning/cms-editor-warning.js","webpack:///./src/patterns/devcorate/devcorate.js","webpack:///./src/patterns/dropdown-filter/dropdown-filter.js","webpack:///./src/patterns/feedback/feedback.js","webpack:///./src/patterns/image-carousel/carousel-constructor.js","webpack:///./src/patterns/image-carousel/default-carousel/default-carousel-constructor.js","webpack:///./src/patterns/image-carousel/default-carousel/default-carousel.js","webpack:///./src/patterns/image-carousel/image-carousel.js","webpack:///./src/patterns/image-carousel/swipe.js","webpack:///./src/patterns/key-information/key-information--lifelong-learning.js","webpack:///./src/patterns/link-finder/link-finder.js","webpack:///./src/patterns/load-more/load-more.js","webpack:///./src/patterns/menu/menu-formatters.js","webpack:///./src/patterns/menu/menu.js","webpack:///./src/patterns/modal/modal.js","webpack:///./src/patterns/navigation/navigation-primary.js","webpack:///./src/patterns/navigation/navigation-secondary.js","webpack:///./src/patterns/paginated-list/paginated-list.js","webpack:///./src/patterns/pagination/pagination.js","webpack:///./src/patterns/show-more/show-more.js","webpack:///./src/patterns/slider-responsive/slider-responsive.js","webpack:///./src/patterns/slider/custom_counter/slider_dot_counter.js","webpack:///./src/patterns/slider/slider.js","webpack:///./src/patterns/tabs/prepareAccordionTabs.js","webpack:///./src/patterns/tabs/tabs.js","webpack:///./src/patterns/tooltip/image-credit/image-credit.js","webpack:///./src/patterns/tooltip/social-share/social-share.js","webpack:///./src/patterns/video/video.js","webpack:///./src/util.js"],"names":["actionOnScroll","element","action","repeat","options","threshold","actionOnScrollAction","entries","forEach","entry","isIntersecting","classList","add","observer","unobserve","IntersectionObserver","observe","aria","activeDescendant","atomic","autoComplete","busy","checked","colCount","colIndex","colSpan","controls","current","describedBy","details","disabled","dropEffect","errorMessage","expanded","flowTo","grabbed","hasPopup","hidden","invalid","keyShortcuts","label","labelledBy","level","live","modal","multiLine","multiSelectable","orientation","owns","placeholder","posInset","pressed","readOnly","relevant","required","roleDescription","rowCount","rowIndex","rowSpan","selected","setSize","sort","valueMax","valueMin","valueNow","valueText","Object","freeze","className","launchResearchApplyCta","cta","applyAnchor","querySelector","applyAnchorHref","getAttribute","applyCta","setAttribute","remove","launchFn","launchQuery","edgeVersion","tryCatch","f","e","gaEvent","lineNumber","message","fileName","window","location","launchPattern","pattern","Array","from","document","querySelectorAll","filter","elem","indexOf","accordionizeTabs","root","potential","prepareAccordionTabs","addEventListener","test","navigator","userAgent","getElementsByTagName","html","ie","detectIE","removeClass","trim","patterns","parameters","parametersToObject","search","devcorate","accordion","chartBarHorizontal","cmsEditorWarning","feedback","loadMore","menu","primaryNavigation","secondaryNavigation","paginatedList","pagination","tabs","linkFinder","contentSeparator","imageExpand","contentFadeIn","contentSlideUp","slider","sliderResponsive","carousel","keyInformation","numberAnimation","showMore","gallery","svgPathAnimation","backToTop","dropdownFilter","tooltipImageCredit","tooltipSocialShare","researchApplyCta","particle","video","headingClassName","headingTextClassName","headingIconClassName","bodyClassName","oneSecond","tenthOfASecond","scrollDuration","reduceMotion","scrollTo","setSection","heading","open","dataset","firstElementChild","calculateAccordionBodyHeight","section","nextElementSibling","closed","height","offsetHeight","setupTransition","initialHeight","style","cleanupTransition","toBool","previousElementSibling","buttonClick","button","headings","toggleOpen","parentNode","accordionSection","capture","once","setTimeout","sectionHeight","sections","parentElement","id","verticallyInWindow","scroll","to","buttonFromHeading","createElement","wrapper","textSpan","iconSpan","appendChild","createTextNode","textContent","appendAll","launchAccordion","toggleopen","defaultOpen","defaultopen","allowSingle","allowsingle","idLinked","length","content","replaceChild","firstChild","contentFadein","viewPortHeight","innerHeight","isMobile","elemOffset","offsetTop","screenPos","pageYOffset","includes","contentSeparatorContainer","el","insertElement","prepend","contentSlideup","elemOffsetTop","parentElemHeight","parseInt","getComputedStyle","getPropertyValue","image","DURATION","findNumberContainer","widget","nested","initNumberAnimation","startStr","animationNumberStart","start","parseFloat","numberContainer","numberStr","innerHTML","replace","match","animationNumberValue","animationNumberFloat","runNumberAnimation","isFloat","value","first","startTime","startValue","lastValue","timestamp","t","finish","k","Math","pow","v","round","toLocaleString","requestAnimationFrame","init","elm","lazyNumbers","slice","call","checkIntersectionObserver","lazyUnit","initParticles","particlesJS","particles","number","color","shape","type","stroke","width","polygon","nb_sides","src","opacity","random","anim","enable","speed","opacity_min","sync","size","size_min","line_linked","distance","move","direction","straight","out_mode","bounce","attract","rotateX","rotateY","interactivity","detect_on","events","onhover","mode","onclick","resize","modes","grab","bubble","duration","repulse","push","particles_nb","retina_detect","initSvgPathAnimation","animateSvg","paths","path","getTotalLength","strokeDashoffset","strokeDasharray","contains","scrollPos","initBacktoTop","backToTopAnchor","createHTMLElement","val","updateProgress","showAnchor","positionOnScreen","docked","removeAttribute","progressPath","pathLength","documentElement","scrollHeight","progress","collectionMaxValue","setCollectionMaxValue","chartCollection","charts","singleBarTotals","chart","singleBarTotal","barTotal","max","buildBars","segmentWidths","chartCollectionUnits","units","singleBarTotalEls","singleBarSegmentEls","singleBarSegment","barSegment","barWidth","segmentWidth","relativeWidth","segments","segment","segmentRelativeWidths","largestSegmentWidth","widestSegment","widestSegmentLabel","append","launchChart","warningClass","buttonClass","wrapperClass","createButton","launchRemover","warnings","w","removeChild","insertBefore","param","anchor","origin","href","pathname","objectToParameters","hash","dataGroupElement","showAll","prepareDropdown","listItems","firstItemVisible","firstItemShow","displayAll","hideListItems","insertSelect","select","selectChange","items","itemsArray","i","item","selectBox","selectWrapper","labelFor","labelValue","labelEl","labelShow","noSelection","text","defaultItemOverride","lastItemOverride","alphabetical","a","b","last","itemsLength","showAllOption","name","splice","defaultItemOverridePosition","lastPositionOriginal","dataValue","dataName","option","target","closest","dataGroup","listItem","targetListItem","otherListItems","srcElement","selectedIndex","o","feedbackPage","sendFeedback","toString","handleNo","container","messagePrefix","linkText","link","messageSuffix","childNodes","handleYes","messageText","launchFeedback","questionText","directFeedbackWrapper","directFeedbackForm","directFeedbackFieldset","questionLegend","buttonWrapper","yesButton","noButton","Carousel","constructor","config","x0","locked","sliderTranslateCoOr","numIndicator","index","innerText","activeSlider","sliders","toArray","tabIndex","toggle","toogleNextBtn","nextBtn","checkEventType","hidNumInd","tooglePrevBtn","prevBtn","moveSlide","sl","defaultCarousel","tagName","setProperty","children","sliderWidthIndex","totalSliderWidth","sliderWidth","activeThumbnail","next","preventDefault","previous","unify","changedTouches","lock","clientX","drag","dx","s","sign","tx","p","animateSlider","stopDrag","stopPropagation","totalWidth","currentStyle","offsetWidth","marginRight","lr","lazyImages","IntersectionObserverEntry","prototype","lazyImageObserver","lazyImage","nextSibling","_C","numInd","numIndActiveSl","numIndSeparator","numbIndSlLength","buttonsWrap","prevBtnWrap","nextBtnWrap","bind","sliderLength","keyCodeTab","keyCodeEnter","Defaultcarousel","inital","self","thumbnails","rootMargin","edge","edgeThumbnailsObserver","intersectionRatio","thumbnailsObserver","onClickThunbnail","keyCode","translateThumbnails","thumbnail","thumbindex","currentThumbnailSpan","listThumbnail","li","thumbnailLi","thumbnailLength","translate","galleria","carouselGallery","dc","c","mousePosition","event","swipeCal","x","y","loadMoreBatch","prepareStartDates","startDates","startDate","sliderposition","loadmorevisible","updateButtonState","nextButton","prevButton","loadMoreButton","handleNextPrevClick","currentPage","focusNext","removeEventListener","focus","hideCurrent","focusPrevious","handleLoadMoreClick","hiddenDates","date","firstElement","shift","launchKeyInformation","startDateList","controlsWrapper","nextButtonSpan","prevButtonSpan","indicator","totalPages","divider","dividerVisible","dividerScreenReader","loadMoreButtonSpan","prependIcon","node","findExternalLink","findDocumentLinks","fileTypes","pdf","docx","doc","xlsx","xls","key","anchorText","toUpperCase","findLinks","anchors","hashedUrl","loadMoreId","itemsDisplay","visibleItems","loadMoreBtn","display","scrollToItem","itemsIncrement","targetItem","pushUrlState","parentType","childrenType","wrapperId","targetListingUrlParam","history","pushState","replaceUrlState","replaceState","launchLoadMore","increment","hashedUrlParts","split","activeItem","numberFromString","onpopstate","loadMoreIdElement","getElementById","updatedUrlParts","currentItem","relatedItems","setNavigationItemButtonDetails","rootClass","navigationItem","sectionText","title","buttonClassName","buttonTextClassName","toggleSubNavigation","intoView","prepareSubNavigation","navigationItemBtn","controlsClassName","buttonIconClassName","currentClassName","hierarchyClassName","prepareNavigation","navigation","subNavigation","textWrapper","cloneNode","listenForNavigationToggles","veilClassName","contentClassName","contentHeaderClassName","buttonDisplayClassName","level1ClassName","menuSetter","setMenu","buttonText","toggleMenu","trap","veil","deactivate","on","activate","createMenuToggle","child","createFocusTrap","initialFocus","join","isVisible","onDeactivate","clickOutsideDeactivates","launchMenu","keyCodeEscape","launchModal","dialogArray","dialogTopic","list","modalcontent","listButton","listButtonSpan","listBody","listHeader","customHeader","format","header","keepFormat","shortName","createDialog","body","topic","shortname","parent","position","closeBtn","dialog","bodyWrapper","wrapperWrapper","dialogStrapline","dialogTitle","dialogBody","main","closeDialog","trapFocus","createControl","buttonPrev","controlButton","buttonNext","pos","addDialogEvent","dialogContent","nextState","buttonLabel","checkNextState","buttonIcon","buttonLabelWrapper","modalInner","classNameSpecific","topLevelClassName","openCloseTextClassName","navigationTextClassName","headerClassName","openText","closeText","navigationText","createCloseAll","buttons","createSectionToggle","closeAll","prepareTopLevel","topLevels","buttonDiv","srOpenCloseSpan","srNavigationSpan","toggleSection","setupTabPrevious","firstButton","restButtons","shiftKey","thisSectionButton","previousSection","previousSectionButton","lastNavigationAnchor","togglePreviousSection","setupTabNext","closeButton","restSectionsCloseButtons","nextSectionButton","toggleNextSection","prepareLowerLevels","prepareHeaders","currentPageWrapper","wholeText","addCloseButtons","closeButtonWrapper","closeButtonDiv","closeButtonText","closeButtonIcon","launchPrimaryNavigation","launchSecondaryNavigation","minimumPage","defaultPage","maximumPage","setPageSize","pageSizeSetting","launchPaginatedList","Number","pagesize","pageSize","pages","reversed","hasAttribute","pageNumber","pageItems","page","newList","pageClassName","addPagination","wrapperClassName","controlsElementClassName","ellipsisClassName","summaryClassName","nextPrevRegEx","maximumButtonsToDisplay","minimumPagesRequiringEllipsis","createToggleNextPrev","prev","pageCount","toggleNextPrev","setProximity","buttonNumber","proximity","toggleButton","createOpenPage","openPage","pagesArray","controlsArray","createNextPrevOpenPage","newPageFn","nextPrevOpenPage","setSummaryText","summary","itemCount","summaryText","prepareNextPrev","class","btn","btnSpan","createPageButton","buttonSpan","pageButtons","ellipsisFirst","ellipsisFirstInner","ellipsisLast","ellipsisLastInner","pageButton","pagecount","toggleShowMore","firstHeadingElement","contentElement","showMoreAnchorLinkText","hiddenElement","createShowMoreButton","showMoreElement","showMoreButtonDiv","showMoreButtonSpan","showMoreButton","icon","showMoreText","dataTitle","srTextElement","showMoreTextElements","sliderChildren","sliderChildrenLength","updatedPosition","sliderIncrement","currentPosition","sliderDirection","progressUpdate","controlWraps","controlWrap","control","currentGroup","progressIndicator","totalSlides","totalSlidesDisplay","firstInGroup","ceil","launchResponsiveSlider","sliderChild","buildControls","deviceType","slides","sliderControlsWrap","sliderControls","sliderProgress","sliderButtons","parentWrapper","createSliderDot","sliderType","sliderObject","slidesTotal","dot","dotEvent","dots","active","launchSlider","totalItems","perPageTablet","perPageDesk","maxTablet","maxDesk","default","endPosition","maxItem","pageAttr","visAttr","counterAttr","ariaLabel","mobile","tablet","desk","sliderControl","controlWrapper","setVisibility","createProgressTracker","createSliderButton","setSwipe","swipeDown","swipeUp","swipe","btnWrap","curBtn","actionBtn","previousSibling","btnLength","convert","elType","lastChild","defaultEvent","tabletSlides","arraySlicer","deskSlides","slicedArrayIterator","arr","visibilityAttr","subArray","j","createProgressElements","firstPage","separator","lastPage","createButtonElement","buttonPrevTablet","buttonNextTablet","buttonPrevDesk","buttonNextDesk","classname","currentSlide","nextPage","nextSlide","counterEl","counterValue","nextAttr","prevAttr","panelClassName","linksClassName","accordionize","assetid","panel","accordionHeading","accordionWrapper","tabid","linkItems","numberOfTabs","mobiletabs","neveraccordion","endKey","homeKey","arrowLeft","arrowUp","arrowRight","arrowDown","selectTab","newTab","panels","linkItem","selectTabEvent","keyEvents","currentTab","currentTabLI","which","prepareLinks","preparePanels","panelElements","launchTabs","authorElement","sourceElement","showCredit","tooltipWrapper","createLabel","elText","elUrl","elTextNode","launchBannerTooltip","banner","tooltipDisplay","authorText","authorUrl","sourceText","sourceUrl","iconBtn","labelSpan","author","source","dividerText","copyIconToClipboard","copy","url","textlink","textnode","range","createRange","selectNode","getSelection","addRange","successful","execCommand","msg","err","Error","removeAllRanges","loopVideo","maxPlays","playInstance","onended","pause","createController","controllerBtn","controllerIcon","statusPaused","paused","toggleController","videoEl","status","play","launchAutoplayVideo","plays","partialMatchFn","m","fullMatchFn","removePartials","matchFn","reducedMotionQuery","matchMedia","matches","getBoundingClientRect","top","parameterString","substr","parameter","parameterObj","keys","eventCategory","eventAction","eventLabel","eventValue","nonInteractionHit","dataLayer","string","screen","viewPortWidth","innerWidth","mobileScreen","obj","array","ua","versionLength","msie","msieVersionOffset","substring","trident","tridentVersionOffset","rv","edgeVersionOffset","attributes","map","att","uppercaseFirstLetterLowercaseRest","charAt","toLowerCase","axiosRequest","httpOK","axios","then","response","data","catch","isCancel","daySuffix","day","eleventh","thirteenth","lastDigit","formatReactDate","months","days","toISOString","getUTCDay","getUTCDate","getUTCMonth","getUTCFullYear","len","newArray","n"],"mappings":"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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"main\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"core\",\"vendor-dependencies\",\"react\",\"vendor-direct\",\"axios\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/**\n *\n * actionOnScroll use the IntersectionObserver API to check if element is intersceting\n *\n * @param {HTMLElement} element - element to observer\n * @param {Action} Function/String - To either excute provided function on element or add the string as a class name\n * @param {Boolean} defualt false - pass true if you want the function to run every time element is Intersecting\n * @param {Object} Object - Pass options to customise IntersectionObserver see docs\n */\nexport function actionOnScroll(\n    element,\n    action,\n    repeat = false,\n    options = { threshold: [0, 0.1, 1] }\n) {\n    if (element && typeof element !== 'undefined' && element !== null) {\n        let actionOnScrollAction = function(entries) {\n            entries.forEach(entry => {\n                //what to do with element depending on action type\n                if (entry.isIntersecting) {\n                    if (typeof action === 'string') {\n                        element.classList.add(action);\n                    } else if (typeof action === 'function') {\n                        action(element);\n                    }\n                    // stop observing if repeat === false\n                    if (repeat === false) {\n                        observer.unobserve(element);\n                    }\n                }\n            });\n        };\n        //intialise observer and observer element\n        let observer = new IntersectionObserver(actionOnScrollAction, options);\n        observer.observe(element);\n    }\n}\n","/**\n * WAI-ARIA attributes\n *\n * Quicker to type, intellisensible, documents what they're for, and saves a\n * tiny amount of code by replacing the string 'aria-' with a minifiable\n * variable and dot notation.\n *\n * @module aria-attributes\n * @author Web Development\n * @copyright City, University of London 2018\n */\n\n/**\n * @readonly\n * @enum {string}\n */\nconst aria = {\n    /** Identifies the currently active element when DOM focus is on a composite widget, textbox, group, or application. */\n    activeDescendant: 'aria-activedescendant',\n    /** Indicates whether assistive technologies will present all, or only parts of, the changed region based on the change notifications defined by the aria-relevant attribute. */\n    atomic: 'aria-atomic',\n    /** Indicates whether inputting text could trigger display of one or more predictions of the user's intended value for an input and specifies how predictions would be presented if they are made. */\n    autoComplete: 'aria-autocomplete',\n    /** Indicates an element is being modified and that assistive technologies MAY want to wait until the modifications are complete before exposing them to the user. */\n    busy: 'aria-busy',\n    /** Indicates the current \"checked\" state of checkboxes, radio buttons, and other widgets. */\n    checked: 'aria-checked',\n    /** Defines the total number of columns in a table, grid, or treegrid. */\n    colCount: 'aria-colcount',\n    /** Defines an element's column index or position with respect to the total number of columns within a table, grid, or treegrid. */\n    colIndex: 'aria-colindex',\n    /** Defines the number of columns spanned by a cell or gridcell within a table, grid, or treegrid. */\n    colSpan: 'aria-colspan',\n    /** Identifies the element (or elements) whose contents or presence are controlled by the current element. */\n    controls: 'aria-controls',\n    /** Indicates the element that represents the current item within a container or set of related elements. */\n    current: 'aria-current',\n    /** Identifies the element (or elements) that describes the object. */\n    describedBy: 'aria-describedby',\n    /** Identifies the element that provides a detailed, extended description for the object. */\n    details: 'aria-details',\n    /** Indicates that the element is perceivable but disabled, so it is not editable or otherwise operable. */\n    disabled: 'aria-disabled',\n    /** [Deprecated in ARIA 1.1] Indicates what functions can be performed when a dragged object is released on the drop target. */\n    dropEffect: 'aria-dropeffect',\n    /** Identifies the element that provides an error message for the object. */\n    errorMessage: 'aria-errormessage',\n    /** Indicates whether the element, or another grouping element it controls, is currently expanded or collapsed. */\n    expanded: 'aria-expanded',\n    /** Identifies the next element (or elements) in an alternate reading order of content which, at the user's discretion, allows assistive technology to override the general default of reading in document source order. */\n    flowTo: 'aria-flowto',\n    /** [Deprecated in ARIA 1.1] Indicates an element's \"grabbed\" state in a drag-and-drop operation. */\n    grabbed: 'aria-grabbed',\n    /** Indicates the availability and type of interactive popup element, such as menu or dialog, that can be triggered by an element. */\n    hasPopup: 'aria-haspopup',\n    /** Indicates whether the element is exposed to an accessibility API. */\n    hidden: 'aria-hidden',\n    /** Indicates the entered value does not conform to the format expected by the application. */\n    invalid: 'aria-invalid',\n    /** Indicates keyboard shortcuts that an author has implemented to activate or give focus to an element. */\n    keyShortcuts: 'aria-keyshortcuts',\n    /** Defines a string value that labels the current element. */\n    label: 'aria-label',\n    /** Identifies the element (or elements) that labels the current element. */\n    labelledBy: 'aria-labelledby',\n    /** Defines the hierarchical level of an element within a structure. */\n    level: 'aria-level',\n    /** Indicates that an element will be updated, and describes the types of updates the user agents, assistive technologies, and user can expect from the live region. */\n    live: 'aria-live',\n    /** Indicates whether an element is modal when displayed. */\n    modal: 'aria-modal',\n    /** Indicates whether a text box accepts multiple lines of input or only a single line. */\n    multiLine: 'aria-multiline',\n    /** Indicates that the user may select more than one item from the current selectable descendants. */\n    multiSelectable: 'aria-multiselectable',\n    /** Indicates whether the element's orientation is horizontal, vertical, or unknown/ambiguous. */\n    orientation: 'aria-orientation',\n    /** Identifies an element (or elements) in order to define a visual, functional, or contextual parent/child relationship between DOM elements where the DOM hierarchy cannot be used to represent the relationship. */\n    owns: 'aria-owns',\n    /** Defines a short hint (a word or short phrase) intended to aid the user with data entry when the control has no value. A hint could be a sample value or a brief description of the expected format. */\n    placeholder: 'aria-placeholder',\n    /** Defines an element's number or position in the current set of listitems or treeitems. Not required if all elements in the set are present in the DOM. */\n    posInset: 'aria-posinset',\n    /** Indicates the current \"pressed\" state of toggle buttons. */\n    pressed: 'aria-pressed',\n    /** Indicates that the element is not editable, but is otherwise operable. */\n    readOnly: 'aria-readonly',\n    /** Indicates what notifications the user agent will trigger when the accessibility tree within a live region is modified. */\n    relevant: 'aria-relevant',\n    /** Indicates that user input is required on the element before a form may be submitted. */\n    required: 'aria-required',\n    /** Defines a human-readable, author-localized description for the role of an element. */\n    roleDescription: 'aria-roledescription',\n    /** Defines the total number of rows in a table, grid, or treegrid. */\n    rowCount: 'aria-rowcount',\n    /** Defines an element's row index or position with respect to the total number of rows within a table, grid, or treegrid. */\n    rowIndex: 'aria-rowindex',\n    /** Defines the number of rows spanned by a cell or gridcell within a table, grid, or treegrid. */\n    rowSpan: 'aria-rowspan',\n    /** Indicates the current \"selected\" state of various widgets. */\n    selected: 'aria-selected',\n    /** Defines the number of items in the current set of listitems or treeitems. Not required if all elements in the set are present in the DOM. */\n    setSize: 'aria-setsize',\n    /** Indicates if items in a table or grid are sorted in ascending or descending order. */\n    sort: 'aria-sort',\n    /** Defines the maximum allowed value for a range widget. */\n    valueMax: 'aria-valuemax',\n    /** Defines the minimum allowed value for a range widget. */\n    valueMin: 'aria-valuemin',\n    /** Defines the current value for a range widget. */\n    valueNow: 'aria-valuenow',\n    /** Defines the human readable text alternative of aria-valuenow for a range widget. */\n    valueText: 'aria-valuetext',\n};\n\nexport default Object.freeze(aria);\n","/**\n * Research apply CTA (no modal)\n *\n * @module patterns/accordion/accordion\n * @author Web Development\n * @copyright City, University of London 2020\n */\n\nconst className = 'cta-block__cta--no-modal';\n\n/**\n * Disables modal behaviour on research degree apply CTA where one date exists\n * for a method of study and modal of multiple start dates is not required. Pass\n * relevant URL path to CTA so it behaves as a standard anchor.\n *\n * @param {HTMLElement} cta - A standard research apply CTA (no modal).\n */\nfunction launchResearchApplyCta(cta) {\n    let applyAnchor = cta.querySelector('.cta-block__cta__path'),\n        applyAnchorHref = applyAnchor.getAttribute('href'),\n        applyCta = cta.querySelector('.research-apply-link');\n\n    applyCta.setAttribute('href', applyAnchorHref);\n\n    // Remove duplicate anchor, as href is now placed on apply CTA\n    applyAnchor.remove();\n}\n\nexport default {\n    launchFn: launchResearchApplyCta,\n    launchQuery: `.${className}`,\n};\n","/**\n * Main entry\n *\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport patterns from './patterns';\nimport { removeClass, parametersToObject, gaEvent, detectIE } from './util';\nimport { devcorate } from './patterns/devcorate/devcorate';\nimport prepareAccordionTabs from './patterns/tabs/prepareAccordionTabs';\n\nconst edgeVersion = 12;\n\n/**\n * try a function, log the error if it throws an exception.\n *\n * @param {Function} f - The function to call.\n */\nexport function tryCatch(f) {\n    try {\n        return f();\n    } catch (e) {\n        // console.log(e);\n        gaEvent(\n            'jsError',\n            'JavaScript error',\n            `Line ${e.lineNumber} – ${e.message}`,\n            `Pattern launch ${e.fileName} (${window.location})`,\n            true\n        );\n    }\n}\n\n/**\n * Runs the function for each pattern against every element that has the\n * matching class, unless the element also has that class with a '-no-js' suffix\n * (for cases where you want to use the CSS for a pattern, but not the\n * functionality).\n *\n * @param {object} pattern - An object containing the class name to trigger the pattern and the launch function to run for those elements.\n */\nfunction launchPattern(pattern) {\n    if (typeof pattern === 'function') {\n        tryCatch(pattern);\n    } else if (pattern.launchQuery) {\n        const { launchFn, launchQuery } = pattern;\n        Array.from(document.querySelectorAll(launchQuery))\n            .filter((elem) => elem.className.indexOf(`${launchQuery}-no-js`))\n            .forEach((elem) => tryCatch(() => launchFn(elem)));\n    }\n}\n\n/**\n * Recursively generate accordion--tabs HTML for tabs.\n *\n * @param {HTMLElement} root\n */\nfunction accordionizeTabs(root) {\n    Array.from(root.querySelectorAll('.tabs'))\n        .filter((elem) => elem.className.indexOf('.tabs-no-js'))\n        .forEach((elem) => {\n            const potential = tryCatch(() => prepareAccordionTabs(elem));\n            potential && accordionizeTabs(potential);\n        });\n}\n\ndocument.addEventListener(\n    'DOMContentLoaded',\n    () => {\n        if (/(Trident|MSIE)/.test(navigator.userAgent)) {\n            return;\n        } else {\n            // disable for now\n            // if ('serviceWorker' in navigator) {\n            //     window.addEventListener('load', function() {\n            //         navigator.serviceWorker\n            //             .register('sw.js')\n            //             .then(function() {}, function() {});\n            //     }, false);\n            // }\n            Array.from(document.getElementsByTagName('html')).forEach(\n                (html) => {\n                    let ie = detectIE();\n                    removeClass(html, 'no-js', false);\n                    if (ie >= edgeVersion) {\n                        html.className = (\n                            html.className +\n                            ' js ' +\n                            'edge'\n                        ).trim();\n                    } else {\n                        html.className = (html.className + ' js').trim();\n                    }\n                }\n            );\n\n            accordionizeTabs(document);\n            patterns.forEach(launchPattern);\n\n            const parameters = parametersToObject(location.search);\n            parameters['dev'] &&\n                devcorate(\n                    document.querySelector('body'),\n                    'dev',\n                    parameters['dev']\n                );\n            parameters['rel'] &&\n                devcorate(\n                    document.querySelector('body'),\n                    'rel',\n                    parameters['rel']\n                );\n        }\n    },\n    false\n);\n","/**\n * Pattern library\n *\n * Exports an array of patterns to execute on startup.\n *\n * @module patterns\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport accordion from './patterns/accordion/accordion';\nimport backToTop from './patterns/back-to-top/back-to-top';\nimport carousel from './patterns/image-carousel/image-carousel';\nimport chartBarHorizontal from './patterns/charts/charts';\nimport cmsEditorWarning from './patterns/cms-editor-warning/cms-editor-warning';\nimport contentFadeIn from './patterns/animation/content-fade-in/content-fade-in';\nimport contentSeparator from './patterns/animation/content-separator/content-separator';\nimport contentSlideUp from './patterns/animation/content-slide-up/content-slide-up';\nimport dropdownFilter from './patterns/dropdown-filter/dropdown-filter';\nimport feedback from './patterns/feedback/feedback';\nimport gallery from './patterns/image-carousel/default-carousel/default-carousel';\nimport imageExpand from './patterns/animation/image-expand/image-expand';\nimport keyInformation from './patterns/key-information/key-information--lifelong-learning';\nimport linkFinder from './patterns/link-finder/link-finder';\nimport loadMore from './patterns/load-more/load-more';\nimport menu from './patterns/menu/menu';\nimport modal from './patterns/modal/modal';\nimport numberAnimation from './patterns/animation/number-animation/number-animation';\nimport paginatedList from './patterns/paginated-list/paginated-list';\nimport pagination from './patterns/pagination/pagination';\nimport particle from './patterns/animation/particle/particle';\nimport primaryNavigation from './patterns/navigation/navigation-primary';\nimport researchApplyCta from './how-to-apply--research';\nimport secondaryNavigation from './patterns/navigation/navigation-secondary';\nimport showMore from './patterns/show-more/show-more';\nimport slider from './patterns/slider/slider';\nimport sliderResponsive from './patterns/slider-responsive/slider-responsive';\nimport svgPathAnimation from './patterns/animation/svg-path-animation/svg-path-animation';\nimport tabs from './patterns/tabs/tabs';\nimport tooltipImageCredit from './patterns/tooltip/image-credit/image-credit';\nimport tooltipSocialShare from './patterns/tooltip/social-share/social-share';\nimport video from './patterns/video/video';\n\nexport default [\n    accordion,\n    chartBarHorizontal,\n    cmsEditorWarning,\n    feedback,\n    loadMore,\n    menu,\n    primaryNavigation,\n    secondaryNavigation,\n    paginatedList,\n    pagination,\n    tabs,\n    linkFinder,\n    contentSeparator,\n    imageExpand,\n    contentFadeIn,\n    contentSlideUp,\n    modal,\n    slider,\n    sliderResponsive,\n    carousel,\n    keyInformation,\n    numberAnimation,\n    showMore,\n    gallery,\n    svgPathAnimation,\n    backToTop,\n    dropdownFilter,\n    tooltipImageCredit,\n    tooltipSocialShare,\n    researchApplyCta,\n    particle,\n    video,\n];\n","/**\n * Accordion\n *\n * @module patterns/accordion/accordion\n * @author Web Development\n * @copyright City, University of London 2018-2019\n */\nimport scroll from 'zenscroll';\nimport aria from '../../aria-attributes';\nimport {\n    appendAll,\n    reduceMotion,\n    removeClass,\n    toBool,\n    verticallyInWindow,\n} from '../../util';\n\nconst className = 'accordion',\n    headingClassName = className + '__heading',\n    headingTextClassName = headingClassName + '__text',\n    headingIconClassName = headingClassName + '__indicator fal',\n    bodyClassName = className + '__body',\n    oneSecond = 1000,\n    tenthOfASecond = 100,\n    scrollDuration = reduceMotion() ? 0 : oneSecond,\n    scrollTo = true;\n\n/**\n * Sets a heading and the button nested within to be open or closed.\n *\n * @param {HTMLHeadingElement} heading - An accordion heading.\n * @param {boolean} open - Set this section to be open?\n */\nfunction setSection(heading, open) {\n    heading.dataset.open = open;\n    heading.firstElementChild.setAttribute(aria.expanded, open);\n}\n\n/**\n * Open a section, calculate its height, then close it again.\n *\n * With no transition, this is essentially invisible to the user.\n *\n * @param {HTMLHeadingElement} heading - An accordion heading.\n * @return {string} The pixel height of the section when open.\n */\nfunction calculateAccordionBodyHeight(heading) {\n    const section = heading.nextElementSibling;\n\n    setSection(heading, true);\n    section.dataset.closed = 'false';\n    const height = section.offsetHeight + 'px';\n\n    setSection(heading, false);\n    section.dataset.closed = 'true';\n\n    return height;\n}\n\n/**\n * Set style properties for transition.\n *\n * @param {HTMLElement} element - The section to transition.\n * @param {string} initialHeight - The initial height from which to transition.\n */\nfunction setupTransition(element, initialHeight) {\n    element.style.height = initialHeight;\n    element.dataset.closed = 'false';\n    return true;\n}\n\n/**\n * Cleanup after transition.\n *\n * @param {HTMLElement} accordionSection - The section that transitioned.\n */\nfunction cleanupTransition(section) {\n    const open = toBool(section.previousElementSibling.dataset.open);\n    section.style.height = null;\n    section.dataset.closed = open ? 'false' : 'true';\n}\n\n/**\n * Respond to button clicks - open if closed, close if open.\n *\n * If opening, will also push the heading ID into the history, so C+Ping the URL\n * will open the most recently viewed section. Closing a section removes any\n * hash.\n *\n * @param {HTMLButtonElement} button - The button that was clicked.\n * @param {HTMLElement[]} headings - All headings in this accordion.\n * @param {boolean} [toggleOpen] - Should other accordion sections close? Default to false.\n */\nfunction buttonClick(button, headings, toggleOpen) {\n    const heading = button.parentNode,\n        accordionSection = heading.nextElementSibling;\n\n    /**\n     * After we've transitioned the opening/closing, we want to revert to\n     * letting the CSS size the element. Add a listener to do this that will\n     * self-destruct after running.\n     */\n    accordionSection.addEventListener(\n        'transitionend',\n        () => cleanupTransition(accordionSection),\n        { capture: true, once: true }\n    );\n\n    if (toBool(button.getAttribute(aria.expanded))) {\n        // Starting height is the current height\n        setupTransition(accordionSection, accordionSection.offsetHeight + 'px');\n        // setTimeout lets the DOM recalculate before we continue, so the transition will fire\n        setTimeout(() => {\n            accordionSection.style.height = '0px';\n        }, tenthOfASecond);\n\n        setSection(heading, false);\n    } else {\n        // Calclulate and save how big we're transitioning to\n        const sectionHeight = calculateAccordionBodyHeight(heading);\n        // Starting height is 0\n        setupTransition(accordionSection, '0px');\n        // setTimeout lets the DOM recalculate before we continue, so the transition will fire\n        setTimeout(() => {\n            accordionSection.style.height = sectionHeight;\n        }, tenthOfASecond);\n\n        if (toggleOpen) {\n            const sections = Array.from(\n                heading.parentNode.parentNode.querySelectorAll(\n                    `#${heading.parentElement.id} > .${bodyClassName}`\n                )\n            );\n            headings.forEach((heading) => setSection(heading, false));\n            sections\n                .filter((section) => section.id !== accordionSection.id)\n                .forEach((section) => {\n                    section.dataset.closed = 'true';\n                });\n        }\n        setSection(heading, true);\n\n        if (\n            scrollTo &&\n            !(\n                verticallyInWindow(heading) &&\n                verticallyInWindow(accordionSection)\n            )\n        ) {\n            scroll.to(heading, scrollDuration);\n        }\n    }\n}\n\n/**\n * Create a button from the text content of a heading.\n *\n * @param {HTMLElement} heading - An accordion heading.\n * @returns {HTMLButtonElement} An accordion section button.\n */\nfunction buttonFromHeading(heading) {\n    const button = document.createElement('button'),\n        // Chrome can't apply grid layout to buttons, need to wrap contents\n        wrapper = document.createElement('div'),\n        textSpan = document.createElement('span'),\n        iconSpan = document.createElement('span');\n\n    textSpan.className = headingTextClassName;\n    iconSpan.className = headingIconClassName;\n    iconSpan.setAttribute(aria.hidden, true);\n    button.setAttribute('type', 'button');\n\n    textSpan.appendChild(document.createTextNode(heading.textContent));\n    appendAll(wrapper, [textSpan, iconSpan]);\n    button.appendChild(wrapper);\n\n    return button;\n}\n\n/**\n * Transform an element with the accordion class into an accordion.\n *\n * accordions should contain an even number of children, alternating headings\n * and content elements. The element type is unimportant - headings should have\n * the headingClassName - but headings should contain only text, no other\n * children.\n *\n * e.g.\n *\n * <div class=\"accordion\">\n * <h2 class=\"accordion__heading\">Heading 1</h2>\n * <div>Content 1</div>\n * <h2 class=\"accordion__heading\">Heading 2</h2>\n * <div>Content 2</div>\n * </div>\n *\n * @param {HTMLElement} accordion - An HTML element with the accordion class.\n */\nfunction launchAccordion(accordion) {\n    const toggleOpen = toBool(accordion.dataset.toggleopen),\n        defaultOpen = toBool(accordion.dataset.defaultopen),\n        allowSingle = toBool(accordion.dataset.allowsingle),\n        headings = Array.from(\n            accordion.parentNode.querySelectorAll(\n                `#${accordion.id} > .${headingClassName}`\n            )\n        );\n\n    let idLinked = false;\n\n    if (!(allowSingle || headings.length > 1)) {\n        /**\n         * not enough content to accordion\n         */\n        removeClass(accordion, className, false);\n        return;\n    }\n\n    headings.forEach((heading) => {\n        const content = heading.nextElementSibling,\n            button = buttonFromHeading(heading);\n\n        content.setAttribute(aria.labelledBy, heading.id);\n        content.setAttribute('role', 'region');\n        heading.replaceChild(button, heading.firstChild);\n\n        setSection(heading, false);\n        heading.nextElementSibling.dataset.closed = 'true';\n\n        button.addEventListener(\n            'click',\n            () => buttonClick(button, headings, toggleOpen),\n            true\n        );\n    });\n\n    /* Show first item of accordion, if accordion is set to default open,\n           and we haven't linked to a specific section */\n    if (defaultOpen && !idLinked) {\n        setSection(headings[0], true);\n        headings[0].nextElementSibling.dataset.closed = 'false';\n    }\n}\n\nexport default {\n    launchFn: launchAccordion,\n    launchQuery: `.${className}`,\n};\n","/**\n *  Animates content section to fade in and upwards on down scroll\n *\n * @module paint-layouts/case-study-transition-effects/content-section\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019!\n */\n\nimport { isMobile } from '../../../util';\n\nconst className = 'content-fade-in';\n\nfunction contentFadeIn(contentFadein) {\n    const viewPortHeight = window.innerHeight; // calculates viewport height\n\n    if (!isMobile()) {\n        contentFadein.classList.add('content-fade-in--start');\n\n        window.addEventListener('scroll', function () {\n            const elemOffset = contentFadein.offsetTop;\n            const screenPos = window.pageYOffset; // calculates scroll position\n\n            if (\n                screenPos > elemOffset - viewPortHeight + 10 &&\n                !contentFadein.className.includes('content-fade-in--complete')\n            ) {\n                contentFadein.classList.add('content-fade-in--complete');\n            }\n        });\n    }\n}\n\nexport default {\n    launchFn: contentFadeIn,\n    launchQuery: `.${className}`,\n};\n","/**\n * Leading separator transition\n *\n * @module paint-layouts/case-study-transition-effects/leading-separator\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019!\n */\n\nimport { isMobile } from '../../../util';\n\nconst className = 'content-separator-container';\n\n/**\n *\n * @param {HTMLElement} contentSeparatorContainer: the separator is the\n * first child of this container\n *\n */\nfunction contentSeparator(contentSeparatorContainer) {\n    const viewPortHeight = window.innerHeight; // calculates viewport height\n\n    let el = insertElement(contentSeparatorContainer);\n\n    if (!isMobile()) {\n        el.classList.add('content-separator--transition-start');\n        window.addEventListener('scroll', function () {\n            const elemOffset = el.offsetTop;\n            const screenPos = window.pageYOffset; // calculates scroll position\n\n            if (\n                screenPos > elemOffset - viewPortHeight + 20 &&\n                !el.className.includes('content-separator--transition-complete')\n            ) {\n                el.classList.add('content-separator--transition-complete');\n            }\n        });\n    }\n}\n\n/**\n *\n * @param {HTMLElement} contentSeparatorContainer: the separator is the\n * first child of this container\n *\n * @returns {HTMLElement} el: the element that has the transition\n *\n */\nfunction insertElement(contentSeparatorContainer) {\n    let el = document.createElement('div');\n    el.setAttribute('class', 'content-separator');\n    contentSeparatorContainer.prepend(el);\n\n    return el;\n}\n\nexport default {\n    launchFn: contentSeparator,\n    launchQuery: `.${className}`,\n};\n","/**\n * Background slideup transition, Animates content to slide up on down scroll\n *\n * @module paint-layouts/case-study-transition-effects/content-slideup\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019!\n */\n\nimport { isMobile } from '../../../util';\n\nconst className = 'content-slide-up';\n\nfunction contentSlideUp(contentSlideup) {\n    const viewPortHeight = window.innerHeight; // calculates viewport height\n\n    if (!isMobile()) {\n        contentSlideup.classList.add('content-slideup--start');\n        window.addEventListener('scroll', function () {\n            const screenPos = window.pageYOffset; // calculates scroll position\n            const elemOffsetTop = contentSlideup.offsetTop; // calculates element offset from top to the page\n            const parentElemHeight =\n                contentSlideup.parentElement.offsetHeight -\n                parseInt(\n                    window\n                        .getComputedStyle(contentSlideup.parentElement, null)\n                        .getPropertyValue('padding-bottom')\n                ) -\n                parseInt(\n                    window\n                        .getComputedStyle(contentSlideup.parentElement, null)\n                        .getPropertyValue('padding-top')\n                );\n\n            if (\n                screenPos >\n                    elemOffsetTop -\n                        viewPortHeight -\n                        (parentElemHeight * 70) / 100 &&\n                !contentSlideup.className.includes('content-slideup--end')\n            ) {\n                contentSlideup.classList.add('content-slideup--end');\n            }\n        });\n    }\n}\n\nexport default {\n    launchFn: contentSlideUp,\n    launchQuery: `.${className}`,\n};\n","/**\n * Image transition\n *\n * @module paint-layouts/case-study-transition-effects/banner-image\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019!\n */\n\nimport { isMobile } from '../../../util';\n\nconst className = 'image-expand';\n\nfunction imageExpand(image) {\n    if (!isMobile()) {\n        const viewPortHeight = window.innerHeight; // calculates viewport height\n\n        image.classList.add('image-expand--start');\n\n        window.addEventListener('scroll', function () {\n            const elemOffset = image.offsetTop;\n            const screenPos = window.pageYOffset; // calculates scroll position\n\n            if (\n                screenPos > elemOffset - viewPortHeight + 100 &&\n                !image.className.includes('image-expand--complete')\n            ) {\n                image.classList.add('image-expand--complete');\n            }\n        });\n    }\n}\n\nexport default {\n    launchFn: imageExpand,\n    launchQuery: `.${className}`,\n};\n","import { actionOnScroll } from '../../../action-on-scroll';\nimport { checkIntersectionObserver } from '../../../util';\n\nconst className = 'animate-number',\n    DURATION = 1500; // set duration variable 1500 ms increase if want longer animation\n\n/**\n *\n * find container containing the number\n *\n * @param {HTMLElement} element - html element to be animated\n * @return {HTMLElement} element - if element to be animated is found return it else return original element\n */\n\nfunction findNumberContainer(widget) {\n    const nested = widget.querySelector('.animate--number__number');\n    return typeof nested !== 'undefined' && nested !== null ? nested : widget;\n}\n\n/**\n *\n * Intial setup\n * add data attr : data-animation-number-value - number to animate\n * add data attr : data-animation-number-float - boolean value if number is float\n * add data attr : data-animation-numner-start - number value of where to start animation from\n * add class name - animate--number--init\n *\n * @param {HTMLElement} element - The section that need to be animated\n * @return {boolean} - if number animation is setup?\n */\n\nfunction initNumberAnimation(widget) {\n    const startStr = widget.dataset.animationNumberStart || '0';\n    const start = parseFloat(startStr);\n    const numberContainer = findNumberContainer(widget);\n    const numberStr = numberContainer.innerHTML.trim().replace(/,/g, '');\n    if (numberStr.match(/^-?[0-9,]+(\\.[0-9,]+])?/)) {\n        widget.dataset.animationNumberValue = parseFloat(numberStr);\n        widget.dataset.animationNumberFloat = !!numberStr.match(/\\./);\n        widget.dataset.animationNumberStart = start;\n        numberContainer.innerHTML = startStr;\n        widget.classList.add('animate--number--init');\n        return true;\n    } else {\n        return false;\n    }\n}\n\n/**\n *\n * run animation function\n *\n * @param {HTMLElement} element - element to be animated\n */\n\nfunction runNumberAnimation(widget) {\n    const numberContainer = findNumberContainer(widget);\n\n    const isFloat = widget.dataset.animationNumberFloat;\n    const value = parseInt(widget.dataset.animationNumberValue);\n\n    if (value !== 0) {\n        let first = true;\n        let startTime = 0;\n        let startValue = parseInt(widget.dataset.animationNumberStart);\n        let lastValue = 0;\n\n        /**\n         * function to run animation\n         *\n         * @param {timestamp} time stamp - time stamp from requestAnimationFrame API\n         */\n\n        const f = (timestamp) => {\n            if (first) {\n                startTime = timestamp;\n                first = false;\n            }\n            const t = (timestamp - startTime) / DURATION;\n            // difference in time between two discrete points in time divied by duration\n\n            const finish = t >= 1;\n\n            let k = finish ? 1 : 1 - Math.pow(1 - t, 4);\n\n            let v = k * (value - startValue) + startValue;\n\n            if (isFloat) {\n                v = Math.round(v);\n            }\n\n            if (lastValue !== v) {\n                lastValue = v;\n                numberContainer.innerHTML = v.toLocaleString('en-GB'); // append and format to GB\n            }\n\n            if (finish) {\n                //end of animation\n                widget.classList.add('animate--number--complete');\n            } else {\n                //repeat call requestAnimationFrame until finish is true\n                window.requestAnimationFrame(f);\n            }\n        };\n        /**\n         * run requestAnimationFrame to repaint animation to screen\n         */\n\n        window.requestAnimationFrame(f);\n    }\n}\n\n/**\n *\n * Intial setup\n *\n * number animation should contain a wrapper with a class name 'animate-number'\n * there should be at least one child element with a class name 'animate--number__heading'\n * and a span element with a class name 'animate--number__number' containing the number\n *\n * e.g.\n *\n * <div class=\"animate-number\">\n *  <h2 class=\"animate animate--number__heading\">\n *      <span class=\"animate--number__number\">10,000</span>\n *  </h2>\n * </div>\n *\n * @param {HTMLElement} elm - An HTML element with the 'animate-number' class.\n *\n */\n\nfunction init(elm) {\n    const lazyNumbers = [].slice.call(elm.querySelectorAll('.animate--number'));\n    /**\n     * check if browser support IntersectionObserver api\n     */\n\n    if (checkIntersectionObserver()) {\n        lazyNumbers.forEach(function (lazyUnit) {\n            initNumberAnimation(lazyUnit);\n            /**\n             * pass the element and function to actionOnScroll\n             * to animate when element is intersecting\n             */\n            actionOnScroll(lazyUnit, runNumberAnimation);\n        });\n    }\n}\n\nexport default {\n    launchFn: init,\n    launchQuery: `.${className}`,\n};\n","/**\n * Back To Top Link Scroll\n *\n * @module patterns/animation/particle\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019\n */\nimport '../../../../node_modules/particles.js/particles.js';\n\n/**\n * This pattern loads the particle.js NMP module. The function below executes the animation with given parameters below.\n * For full documentation please refer to https://github.com/VincentGarreau/particles.js\n * The function applies the particle animation to a div with the ID 'particles-js'.\n */\n\nconst className = 'particle-animation';\n\nfunction initParticles() {\n    particlesJS('particles-js', {\n        particles: {\n            number: {\n                value: 80,\n            },\n            color: {\n                value: '#e5e5e5',\n            },\n            shape: {\n                type: 'circle',\n                stroke: {\n                    width: 0,\n                    color: '#000000',\n                },\n                polygon: {\n                    nb_sides: 5,\n                },\n                image: {\n                    src: 'img/github.svg',\n                    width: 100,\n                    height: 100,\n                },\n            },\n            opacity: {\n                value: 0.8,\n                random: false,\n                anim: {\n                    enable: false,\n                    speed: 1,\n                    opacity_min: 0.4,\n                    sync: false,\n                },\n            },\n            size: {\n                value: 7,\n                random: true,\n                anim: {\n                    enable: false,\n                    speed: 40,\n                    size_min: 3,\n                    sync: false,\n                },\n            },\n            line_linked: {\n                enable: true,\n                distance: 150,\n                color: '#e5e5e5',\n                opacity: 0.9,\n                width: 2,\n            },\n            move: {\n                enable: true,\n                speed: 1,\n                direction: 'none',\n                random: false,\n                straight: false,\n                out_mode: 'out',\n                bounce: false,\n                attract: {\n                    enable: false,\n                    rotateX: 600,\n                    rotateY: 1200,\n                },\n            },\n        },\n        interactivity: {\n            detect_on: 'canvas',\n            events: {\n                onhover: {\n                    enable: true,\n                    mode: 'grab',\n                },\n                onclick: {\n                    enable: true,\n                    mode: 'push',\n                },\n                resize: true,\n            },\n            modes: {\n                grab: {\n                    distance: 140,\n                    line_linked: {\n                        opacity: 1,\n                    },\n                },\n                bubble: {\n                    distance: 400,\n                    size: 40,\n                    duration: 2,\n                    opacity: 8,\n                    speed: 3,\n                },\n                repulse: {\n                    distance: 200,\n                    duration: 0.4,\n                },\n                push: {\n                    particles_nb: 4,\n                },\n                remove: {\n                    particles_nb: 2,\n                },\n            },\n        },\n        retina_detect: true,\n    });\n}\n\nexport default {\n    launchFn: initParticles,\n    launchQuery: `.${className}`,\n};","/**\n * SVG path animation\n *\n * @module patterns/animation/svg path\n * @author adapted by Walter Reyneke <walter.reyneke@city.ac.uk> from CASS polaris\n * @copyright City, University of London 2019!\n */\n\nconst className = 'animate-svg';\n\n/**\n * This animation targets SVG paths. When in scrolling distance the path will animated from a starting position of zero till the full length of the path is shown.\n *\n * @param {class} animateSvg - Selects a parent class which will contain the paths targetted for animation\n *\n */\n\nfunction initSvgPathAnimation(animateSvg) {\n    const viewPortHeight = window.innerHeight; // calculates viewport height\n\n    window.addEventListener('DOMContentLoaded', () => {\n        var paths = animateSvg.querySelectorAll('.animate--svg-path');\n\n        // prepares the animation\n        paths.forEach((path) => {\n            let length = path.getTotalLength() + 'px';\n            path.classList.add('animate--svg-path--jsinit');\n\n            path.style.strokeDashoffset = length;\n            path.style.strokeDasharray = `${length}, ${length}`;\n        });\n\n        // starts animation when in scrolling view\n        window.addEventListener('scroll', function () {\n            const elemOffset = animateSvg.offsetTop;\n            const screenPos = window.pageYOffset; // calculates scroll position\n\n            if (screenPos > elemOffset - viewPortHeight + 30) {\n                paths.forEach(function (path) {\n                    !path.classList.contains('animate--svg-path--jsrun')\n                        ? path.classList.add('animate--svg-path--jsrun')\n                        : null;\n                    setTimeout(() => {\n                        path.style.strokeDashoffset = 0;\n                    }, 100);\n                });\n            }\n        });\n    });\n}\n\nexport default {\n    launchFn: initSvgPathAnimation,\n    launchQuery: `.${className}`,\n};\n","/**\n * Back To Top Link Scroll\n *\n * @module patterns/back-to-top/back-to-top\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019\n */\nimport { createHTMLElement } from '../../util';\nconst className = 'back-to-top',\n    viewPortHeight = window.innerHeight;\n\n/**\n * Back to top anchor anchor only appears on long pages and when you have scrolled down long enough\n * Please change the parameter below to alter the behaviour of the back to top anchor.\n *\n * scrollPos - sets how many viewport heights you need to scroll down for back to top to appear. 1 = 1 viewport height\n */\nconst scrollPos = 4;\n\n/**\n *\n * @param {HTMLElement} - selects back to top parent element, which is used in return to select children elements\n */\nfunction initBacktoTop(backToTop) {\n    const backToTopAnchor = backToTop.querySelectorAll('a')[0];\n\n    window.addEventListener('load', function () {\n        backToTop.querySelector('.back-to-top__button__arrow').appendChild(\n            createHTMLElement('span', [\n                { label: 'content', val: 'top' },\n                { label: 'class', val: 'back-to-top__button__arrow__label' },\n            ])\n        ); // adds inner button label for if javascript enabled\n\n        backToTop.setAttribute('hidden', 'true');\n\n        window.addEventListener(\n            'scroll',\n            () => {\n                updateProgress(backToTopAnchor);\n                showAnchor(backToTop);\n            },\n            false\n        );\n    });\n}\n/**\n *  Anchor fading behaviour\n *\n * @param {HTMLElement} backToTop - back to top element.\n */\nfunction showAnchor(backToTop) {\n    const positionOnScreen = window.pageYOffset;\n\n    if (positionOnScreen > viewPortHeight * scrollPos) {\n        // shows anchor when scrolled down far enough - see parameters\n        backToTop.dataset.docked = 'false';\n        backToTop.removeAttribute('hidden');\n    } else if (positionOnScreen < 200) {\n        // hides anchor when close to top of the page\n        backToTop.setAttribute('hidden', 'true');\n        backToTop.dataset.docked = 'false';\n    }\n}\n\n/**\n *  Progress meter\n *\n * @param {HTMLElement} backToTopAnchor - The anchor of the back to top element.\n */\nfunction updateProgress(backToTopAnchor) {\n    // Setting up SVG animation\n    const progressPath = backToTopAnchor.querySelector('path'),\n        pathLength = progressPath.getTotalLength();\n\n    progressPath.style.strokeDasharray = pathLength + ' ' + pathLength;\n    progressPath.style.strokeDashoffset = pathLength;\n\n    // Calculate values\n    const scroll = window.pageYOffset,\n        height = document.documentElement.scrollHeight - window.innerHeight,\n        progress = pathLength - (scroll * pathLength) / height;\n\n    // Updates progress bar\n    progressPath.style.strokeDashoffset = progress;\n}\n\nexport default {\n    launchFn: initBacktoTop,\n    launchQuery: `.${className}`,\n};\n","/**\n * Horizontal bar chart with proportional segments.\n *\n * @module patterns/chart/chart\n * @author Web Development\n * @copyright City, University of London 2020\n */\n\nconst className = 'chart--bar--horizontal';\n\nlet collectionMaxValue;\n\n/**\n * Find each chart collection's maximum bar value and set as a global variable.\n * This will be used to benchmark the collection's constituent charts' relative width against.\n *\n * Example scenario: Apple yields per year\n * Bar 1 (Year 1) = 100 apples\n * Bar 2 (Year 2) = 200 apples\n * Bar 3 (Year 3) =  50 apples\n *\n * Result: Chart collection maximum = 200.\n *\n * @param {HTMLElement} chartCollection - A collection of horizontal bar charts.\n */\nfunction setCollectionMaxValue(chartCollection) {\n    let charts = chartCollection.querySelectorAll(\n            '.chart--bar--horizontal__collection'\n        ),\n        singleBarTotals = [];\n\n    for (const chart of charts) {\n        let singleBarTotal = chart.querySelector('[data-bar-total]');\n        singleBarTotal = parseInt(singleBarTotal.dataset.barTotal);\n        singleBarTotals.push(singleBarTotal);\n    }\n\n    collectionMaxValue = Math.max(...singleBarTotals);\n}\n\n/**\n * Build bar charts with segment values.\n *\n * @param {HTMLElement} chartCollection - A collection of horizontal bar charts.\n */\nfunction buildBars(chartCollection) {\n    let charts = chartCollection.querySelectorAll(\n            '.chart--bar--horizontal__collection'\n        ),\n        segmentWidths = [],\n        chartCollectionUnits = chartCollection.dataset.units;\n\n    for (const chart of charts) {\n        let singleBarTotalEls = chart.querySelector('[data-bar-total]'),\n            singleBarSegmentEls = chart.querySelector('[data-bar-segment]'),\n            singleBarTotal = parseInt(singleBarTotalEls.dataset.barTotal),\n            singleBarSegment = parseInt(singleBarSegmentEls.dataset.barSegment);\n\n        /**\n         * Set bar widths relative to collection maximum value. Display as\n         * numbers (0-100) to allow CSS to set percentage widths.\n         *\n         * Example: Apple yields per year (maximum 200)\n         * Bar 1 (Year 1) => (100/200 * 100) =  50\n         * Bar 2 (Year 2) => (200/200 * 100) = 100\n         * Bar 3 (Year 3) => ( 50/200 * 100) =  25\n         */\n        let barWidth = Math.round((singleBarTotal / collectionMaxValue) * 100),\n            segmentWidth = Math.round(\n                (singleBarSegment / singleBarTotal) * 100\n            );\n        chart.setAttribute('data-bar-width', `${barWidth}`);\n\n        /**\n         * Create data attributes for:\n         *   1. Segment width proportional to bar\n         *   2. Segment width relative to collection width\n         *\n         * Display as numbers (0-100) to allow CSS to set percentage widths.\n         *\n         * Example: Variety of apples as part of overall yield (max 200).\n         * Bar 1\n         *      Braeburn: 50, total yield: 100\n         *      Segment relative to bar => (50/100) * 100 = 50\n         *      Segment relative to collection => (50/200) * 100 = 25\n         * Bar 2\n         *      Braeburn: 40, total yield: 200\n         *      Segment relative to bar => (40/200) * 100 = 20\n         *      Segment relative to collection => (40/200) * 100 = 20\n         * Bar 3\n         *      Braeburn: 5, total yield: 50\n         *      Segment relative to bar => (5/50) * 100 = 10\n         *      Segment relative to collection => (5/200) * 100 = 2.5\n         */\n\n        let relativeWidth = Math.round((segmentWidth * barWidth) / 100);\n        singleBarSegmentEls.setAttribute(\n            'data-relative-width',\n            `${relativeWidth}`\n        );\n\n        let segments = chart.querySelectorAll('[data-bar-segment]');\n\n        for (const segment of segments) {\n            let segmentRelativeWidths = parseInt(segment.dataset.relativeWidth);\n            segmentWidths.push(segmentRelativeWidths);\n        }\n\n        singleBarSegmentEls.setAttribute(\n            'data-segment-width',\n            `${segmentWidth}`\n        );\n    }\n\n    /**\n     * Apply units label to segment with largest relative width, not just a segment's\n     * absolute value.\n     *\n     * Example:\n     * Bar 1 => Segment width: 50%, chart width: 50%, relative layout width: 25%\n     * Bar 2 => Segment width: 30%, chart width: 90%, relative layout width: 27%\n     *\n     * Result: Units label added to segment in Bar 2.\n     */\n    let largestSegmentWidth = Math.max(...segmentWidths),\n        widestSegment = chartCollection.querySelector(\n            `[data-relative-width=\"${largestSegmentWidth}\"]`\n        ),\n        widestSegmentLabel = widestSegment.querySelectorAll('span');\n\n    // Only append units once, even if segment widths are equal on multiple bars\n    widestSegmentLabel[0].append(` ${chartCollectionUnits}`);\n}\n\nfunction launchChart(chartCollection) {\n    setCollectionMaxValue(chartCollection);\n    buildBars(chartCollection);\n}\n\nexport default {\n    launchFn: launchChart,\n    launchQuery: `.${className}`,\n};\n","/**\n * Warning removal\n *\n * @module patterns/cms-editor-warning/cms-editor-warning\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport { removeClass } from '../../util';\n\nconst className = 'cms-editor',\n    warningClass = className + '-warning',\n    buttonClass = warningClass + '-remover',\n    wrapperClass = 'wrapper--' + buttonClass;\n\n/**\n * Create a warning remover button.\n *\n * @returns {HTMLButtonElement} A button element.\n */\nfunction createButton() {\n    const button = document.createElement('button');\n    button.className = buttonClass;\n    button.setAttribute('type', 'button');\n    button.appendChild(document.createTextNode('Remove CMS editor warnings'));\n    return button;\n}\n\n/**\n * The Web 2020 design adds a class .cms-editor to the body tag if the current\n * has write access to the page.\n *\n * If there are any CMS editor warnings inside the launch element, this will\n * append a button to the element that will remove that class, the warnings,\n * and the button itself, leaving the page as it would appear to the user.\n *\n * @param {HTMLElement} elem - An HTML element with the cms-editor class.\n */\nfunction launchRemover(elem) {\n    const warnings = Array.from(elem.querySelectorAll(`.${warningClass}`));\n\n    if (warnings.length) {\n        const button = createButton(),\n            wrapper = document.createElement('div');\n\n        button.addEventListener(\n            'click',\n            () => {\n                warnings.forEach((w) => w.parentNode.removeChild(w));\n                button.parentNode.removeChild(button);\n                removeClass(elem, className, false);\n            },\n            true\n        );\n\n        wrapper.className = wrapperClass;\n        wrapper.appendChild(button);\n\n        document\n            .querySelector('body')\n            .insertBefore(wrapper, document.querySelector('.global-footer'));\n    }\n}\n\nexport default {\n    launchFn: launchRemover,\n    launchQuery: `.${className}`,\n};\n","/**\n * Devcorate\n *\n * @module patterns/devcorate/devcorate\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport { parametersToObject, objectToParameters } from '../../util';\n\n/**\n * Persist a query parameter to all same-site anchors inside an element.\n *\n * @param {HTMLElement} elem - An element containing anchors to decorate.\n * @param {string} param - The name of a query parameter.\n * @param {string} value - The value for the query parameter.\n */\nexport function devcorate(elem, param, value) {\n    Array.from(elem.querySelectorAll('a')).forEach((anchor) => {\n        if (anchor.origin === window.location.origin) {\n            const parameters = anchor.search\n                ? parametersToObject(anchor.search)\n                : {};\n\n            parameters[param] = value;\n            anchor.href = `${anchor.origin}${\n                anchor.pathname\n            }${objectToParameters(parameters)}${anchor.hash}`;\n        }\n    });\n}\n","/**\n * Dropdown filter\n *\n * @module patterns/dropdown-filter/dropdown-filter\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nconst className = 'dropdown-filter';\nlet dataGroupElement = '';\nlet showAll = '';\n\n/**\n * Entry function: loops through and hides list items, sets up event listener on\n * child select box\n *\n * @param {HTMLElement} element: the dropdown div containing all elements\n */\nfunction prepareDropdown(element) {\n    // Only get direct children\n    const listItems = element.querySelectorAll('ul.data-group > li'),\n        firstItemVisible = element.dataset.firstItemShow;\n\n    // Check if all items should be displayed on load\n    showAll = element.dataset.displayAll;\n\n    // Hide list items\n    hideListItems(listItems, firstItemVisible, showAll);\n\n    // Insert the select box to toggle items\n    insertSelect(listItems, element, firstItemVisible, showAll);\n\n    // Display list items on select change\n    const select = element.querySelector('.dropdown-filter__select');\n    select.addEventListener('change', selectChange);\n}\n\n/**\n * Hide list items: both functions require all list items to be hidden.\n * Ths function takes care of this\n *\n * @param {HTMLElements} items - The list of items to hide.\n * @param {boolean} firstItemVisible - Whether first item should be visible on load.\n * @param {boolean} showAll - Option to display all items.\n */\nfunction hideListItems(items, firstItemVisible, showAll) {\n    // Check if dropdown should show first item\n    if (firstItemVisible === 'true' && showAll === 'false') {\n        let itemsArray = Array.from(items);\n        itemsArray[0].setAttribute('data-hidden', 'false');\n        for (var i = 1; i < itemsArray.length; i++) {\n            itemsArray[i].setAttribute('data-hidden', 'true');\n        }\n    } else if (firstItemVisible === 'false' && showAll === 'false') {\n        items.forEach(function (item) {\n            item.setAttribute('data-hidden', 'true');\n        });\n    } else if (showAll === 'true') {\n        items.forEach(function (item) {\n            item.setAttribute('data-hidden', 'false');\n        });\n    }\n    // First item automatically visible is only relevant to component load. Other behaviour is applied when interacting with component.\n    firstItemVisible = 'false';\n}\n\n/**\n * Insert select: build and add the select box to source\n *\n * @param {HTMLElements} items - The list of content for the select options.\n * @param {HTMLElement} parentElement - The element where we need to insert the select.\n * @param {boolean} firstItemVisible - Whether first item should be visible on load.\n */\nfunction insertSelect(items, parentElement, firstItemVisible) {\n    dataGroupElement = parentElement.querySelector('ul.data-group');\n\n    const selectBox = document.createElement('select'),\n        selectWrapper = parentElement.querySelector(\n            '.wrapper--dropdown-filter__select'\n        ),\n        labelFor = parentElement.dataset.labelFor,\n        labelValue = parentElement.dataset.labelValue,\n        labelEl = document.createElement('label');\n\n    labelEl.textContent = labelValue;\n    labelEl.setAttribute('for', labelFor);\n    parentElement.dataset.labelShow === 'false'\n        ? (labelEl.className = 'sr-only')\n        : null;\n\n    selectBox.className = 'dropdown-filter__select';\n    selectBox.setAttribute('id', labelFor);\n    selectBox.setAttribute('name', labelFor);\n\n    selectWrapper.append(labelEl, selectBox);\n\n    // Add default select text if filter doesn't have show all enabled\n    if (parentElement.dataset.displayAll === 'false') {\n        let noSelection = document.createElement('option');\n        noSelection.text = parentElement.getAttribute('data-text');\n        noSelection.setAttribute('value', 'no-selection');\n        selectBox.appendChild(noSelection);\n    }\n\n    let defaultItemOverride, lastItemOverride;\n\n    // Sort by dataset.value to display list alphabetically\n    if (parentElement.dataset.alphabetical === 'true') {\n        items = Array.from(items).sort((a, b) =>\n            a.dataset.value < b.dataset.value\n                ? -1\n                : a.dataset.value > b.dataset.value\n                ? 1\n                : 0\n        );\n    } else {\n        items = [...items];\n    }\n\n    // Update output list items to correct order\n    for (const item of items) {\n        dataGroupElement.append(item);\n    }\n\n    // Find items with first/last position overrides\n    for (const item of items) {\n        item.dataset.first === 'true' ? (defaultItemOverride = item) : null;\n        item.dataset.last === 'true' ? (lastItemOverride = item) : null;\n    }\n\n    const itemsLength = items.length;\n\n    // Display show all option at top of dropdown if pattern has this configuration option set as true\n    if (parentElement.dataset.displayAll === 'true') {\n        let showAllOption = document.createElement('li');\n        showAllOption.dataset.name = `All ${parentElement.dataset.units}`;\n        showAllOption.dataset.value = 'show-all';\n        items.splice(0, 0, showAllOption);\n    }\n\n    // Remove item with dataset.first='true' from original position in array\n    let defaultItemOverridePosition = items.indexOf(defaultItemOverride);\n\n    // Remove item with dataset.last='true' from original position in array\n    if (lastItemOverride) {\n        let lastPositionOriginal = items.indexOf(lastItemOverride);\n        items.splice(lastPositionOriginal, 1);\n        // If custom last option exists, place as last selectable option\n        items.splice(itemsLength, 0, lastItemOverride);\n    }\n\n    // Iterate over each item and create/append select option\n    Array.from(items).forEach((item) => {\n        const dataValue = item.dataset.value,\n            dataName = item.dataset.name,\n            option = document.createElement('option');\n\n        option.value = dataValue;\n        option.text = dataName;\n\n        selectBox.appendChild(option);\n    });\n\n    // Set first item in list as selected\n    if (firstItemVisible === 'true' && showAll === 'false') {\n        const options = parentElement.querySelectorAll('option');\n        if (defaultItemOverride) {\n            if (lastItemOverride) {\n                // Last item override exists\n                if (parentElement.dataset.alphabetical === 'true') {\n                    options[defaultItemOverridePosition].setAttribute(\n                        'selected',\n                        'selected'\n                    );\n                } else {\n                    options[defaultItemOverridePosition + 1].setAttribute(\n                        'selected',\n                        'selected'\n                    );\n                }\n            } else {\n                // Default show & no last item override\n                options[defaultItemOverridePosition + 1].setAttribute(\n                    'selected',\n                    'selected'\n                );\n            }\n        }\n    }\n}\n\n/**\n * Select change: respond to select change event\n *\n * @param {event} e: The select change event.\n */\nfunction selectChange(e) {\n    // Get list items grouping\n    const dropdownFilter = e.target.closest('.dropdown-filter'),\n        dataGroup = dropdownFilter.querySelector('.data-group');\n\n    // Get direct children list items\n    const listItems = dataGroup.querySelectorAll('ul.data-group > li');\n    for (const listItem of listItems) {\n        listItem.removeAttribute('data-hidden');\n    }\n\n    // Hide all items before displaying chosen item\n    showAll = 'false';\n    hideListItems(listItems, showAll);\n\n    // Get the list item corresponding to the select value chosen\n    const targetListItem = dataGroup.querySelector(\n        'li.data-group__item[data-value=' + e.target.value + ']'\n    );\n\n    // Get not selected list items\n    const otherListItems = dataGroup.querySelectorAll(\n        'li.data-group__item:not([data-value=' + e.target.value + '])'\n    );\n\n    // Show/hide content based on pattern's configuration options\n    if (e.target.value !== 'show-all' && e.srcElement.selectedIndex !== 0) {\n        targetListItem.removeAttribute('data-hidden');\n        for (const o of otherListItems) {\n            o.setAttribute('data-hidden', 'true');\n        }\n    } else if (\n        e.target.value !== 'show-all' &&\n        e.srcElement.selectedIndex === 0\n    ) {\n        for (const o of otherListItems) {\n            o.setAttribute('data-hidden', 'true');\n        }\n        return;\n    }\n}\n\nexport default {\n    launchFn: prepareDropdown,\n    launchQuery: `.${className}`,\n};\n","/**\n * Feedback\n *\n * @module patterns/feedback/feedback\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport aria from '../../aria-attributes';\nimport { gaEvent, appendAll } from '../../util';\n\nconst className = 'feedback',\n    feedbackPage = '/feedback';\n\n/**\n * Push a Google Analytics page feedback event into the data layer queue.\n *\n * @param {string} action - The event action.\n * @param {number} value - The event value\n */\nfunction sendFeedback(action, value) {\n    gaEvent(\n        'pageFeedback',\n        'Page feedback',\n        action,\n        window.location.toString(),\n        value,\n        true\n    );\n}\n\n/**\n * Handle a click on the \"no, it's not useful\" button.\n *\n * @param {HTMLParagraphElement} container - The button container.\n */\nfunction handleNo(container) {\n    sendFeedback('Not useful', 0);\n\n    const message = document.createElement('p'),\n        messagePrefix = document.createTextNode(\n            'We’re sorry to hear that, please consider '\n        ),\n        linkText = document.createTextNode('sending us some feedback'),\n        link = document.createElement('a'),\n        messageSuffix = document.createTextNode(' so we can make it better.');\n    container.childNodes.forEach((elem) => container.removeChild(elem));\n    link.href = feedbackPage;\n    link.appendChild(linkText);\n    appendAll(message, [messagePrefix, link, messageSuffix]);\n    message.setAttribute(aria.live, 'polite');\n    container.appendChild(message);\n}\n\n/**\n * Handle a click on the \"yes, it's useful\" button.\n *\n * @param {HTMLParagraphElement} container - The button container.\n */\nfunction handleYes(container) {\n    sendFeedback('Useful', 1);\n\n    const message = document.createElement('p'),\n        messageText = document.createTextNode(\n            'Thanks! Your feedback will be used to improve our website.'\n        );\n    container.childNodes.forEach((elem) => container.removeChild(elem));\n    message.appendChild(messageText);\n    message.setAttribute(aria.live, 'polite');\n    container.appendChild(message);\n}\n\n/**\n * By default, the Feedback widget contains a link to the feedback form.\n *\n * With JavaScript, we add “is it useful?” buttons to track events to GA.\n *\n * @param {HTMLElement} elem - The feedback widget.\n */\nfunction launchFeedback(elem) {\n    const questionText = document.createTextNode('Is this page useful?'),\n        directFeedbackWrapper = document.createElement('div'),\n        directFeedbackForm = document.createElement('form'),\n        directFeedbackFieldset = document.createElement('fieldset'),\n        questionLegend = document.createElement('legend'),\n        buttonWrapper = document.createElement('div'),\n        yesButton = document.createElement('button'),\n        noButton = document.createElement('button');\n\n    yesButton.setAttribute('type', 'button');\n    yesButton.appendChild(document.createTextNode('Yes'));\n    yesButton.addEventListener(\n        'click',\n        () => handleYes(directFeedbackWrapper),\n        true\n    );\n\n    noButton.setAttribute('type', 'button');\n    noButton.appendChild(document.createTextNode('No'));\n    noButton.addEventListener(\n        'click',\n        () => handleNo(directFeedbackWrapper),\n        true\n    );\n\n    buttonWrapper.className = 'feedback__direct__buttons';\n\n    questionLegend.appendChild(questionText);\n    appendAll(buttonWrapper, [yesButton, noButton]);\n    appendAll(directFeedbackFieldset, [questionLegend, buttonWrapper]);\n    directFeedbackForm.appendChild(directFeedbackFieldset);\n    directFeedbackWrapper.appendChild(directFeedbackForm);\n    directFeedbackWrapper.className = className + '__direct';\n\n    elem.insertBefore(directFeedbackWrapper, elem.firstElementChild);\n}\n\nexport default {\n    launchFn: launchFeedback,\n    launchQuery: `.${className}`,\n};\n","import { toArray, detectIE } from '../../util';\n\nconst ie = detectIE();\n\nexport default class Carousel {\n    constructor(elem, options) {\n        this.elem = elem;\n        this.config = options ? options : {};\n        this.i = 0;\n        this.x0 = null;\n        this.locked = false;\n        this.sliderTranslateCoOr = 0;\n    }\n\n    /**\n     * Set the number indicators Number\n     *\n     * @param {number} carousel index - current carousel index\n     * @param {HTMLelement} indicator html - pass HTML containing the indicator\n     */\n\n    numIndicator(index, e) {\n        e.querySelector('.swiper-indicator__active-slider').innerText =\n            index + 1;\n    }\n\n    /**\n     *\n     * Set active slider\n     *\n     * @param {number} carousel index - current carousel index\n     * @param {HTMLelement} sliders html - pass HTML containing the sliders\n     */\n\n    activeSlider(index, sliders) {\n        let a = toArray(sliders.querySelectorAll('.swiper-slide'));\n        a.forEach((e) => {\n            e.classList.remove('active');\n            e.querySelectorAll('a').forEach((a) => (a.tabIndex = -1)); // disable focus on non active slider with hyperlinks\n            e.setAttribute('aria-hidden', 'true');\n        });\n        a[index].classList.toggle('active');\n        a[index].querySelectorAll('a').forEach((a) => (a.tabIndex = 0));\n        a[index].setAttribute('aria-hidden', 'false');\n    }\n\n    /**\n     *\n     * Toggle next button\n     *\n     * @param {number} carousel index - current carousel index\n     * @param {number} length of sliders -\n     * @param {event} user event - interaction event perform by user\n     */\n\n    toogleNextBtn(index, length, e) {\n        let nextBtn = this.checkEventType(e);\n\n        if (index + 1 === length) {\n            nextBtn.querySelector('.swiper-button-next button').disabled = true;\n            nextBtn.querySelector(\n                '.swiper-button-prev button'\n            ).disabled = false;\n        } else if (this.i + 1 < length) {\n            nextBtn.querySelector(\n                '.swiper-button-next button'\n            ).disabled = false;\n            nextBtn.querySelector(\n                '.swiper-button-prev button'\n            ).disabled = false;\n        }\n        this.activeSlider(index, nextBtn);\n        if (!this.config.hidNumInd) {\n            this.numIndicator(index, nextBtn);\n        }\n    }\n\n    /**\n     *\n     * Toggle previous button\n     *\n     * @param {number} carousel index - current carousel index\n     * @param {number} length of sliders -\n     * @param {event} user event - interaction event perform by user\n     */\n\n    tooglePrevBtn(index, length, e) {\n        let prevBtn = this.checkEventType(e);\n\n        if (index + 1 === 1) {\n            prevBtn.querySelector('.swiper-button-prev button').disabled = true;\n            prevBtn.querySelector(\n                '.swiper-button-next button'\n            ).disabled = false;\n        } else if (this.i + 1 > 1) {\n            prevBtn.querySelector(\n                '.swiper-button-prev button'\n            ).disabled = false;\n            prevBtn.querySelector(\n                '.swiper-button-next button'\n            ).disabled = false;\n        }\n        this.activeSlider(index, prevBtn);\n        if (!this.config.hidNumInd) {\n            this.numIndicator(index, prevBtn);\n        }\n    }\n\n    /**\n     *\n     * Move slide either forwards or backwards\n     *\n     * @param {event} user event - interaction event perform by user from onClick on btn or thumbnail\n     * @param {boolean} boolean for either next or pervious - boolean to check if next or previous is called\n     */\n\n    moveSlide(e, t) {\n        const sl = this.checkEventType(e).querySelector('.swiper-wrapper');\n\n        if (sl.classList.contains('smooth')) {\n            sl.classList.toggle('smooth');\n        }\n\n        if (!ie) {\n            if (this.config.defaultCarousel && e.target.tagName === 'INPUT') {\n                sl.style.setProperty('--i', this.i);\n            } else {\n                t\n                    ? sl.style.setProperty(\n                          '--i',\n                          this.i !== 0 ? (this.i += 1) : (this.i = 1)\n                      )\n                    : sl.style.setProperty(\n                          '--i',\n                          this.i !== 0 ? (this.i -= 1) : (this.i = 1)\n                      );\n            }\n\n            sl.classList.toggle('smooth');\n\n            t\n                ? this.toogleNextBtn(this.i, sl.children.length, e)\n                : this.tooglePrevBtn(this.i, sl.children.length, e);\n        } else {\n            let sliderWidthIndex =\n                    (this.totalSliderWidth(e) / sl.children.length) * this.i,\n                sliderWidth = this.totalSliderWidth(e) / sl.children.length;\n\n            t\n                ? (this.sliderTranslateCoOr -= sliderWidth)\n                : (this.sliderTranslateCoOr += sliderWidth);\n\n            sl.classList.toggle('smooth');\n\n            if (this.config.defaultCarousel && e.target.tagName === 'INPUT') {\n                this.sliderTranslateCoOr = -sliderWidthIndex;\n                sl.style.setProperty(\n                    'transform',\n                    'translate(-' + sliderWidthIndex + 'px)'\n                );\n                sl.style.setProperty('--i', this.i);\n            } else {\n                sl.style.setProperty(\n                    'transform',\n                    'translate(' + this.sliderTranslateCoOr + 'px)'\n                );\n                t\n                    ? this.i !== 0\n                        ? (this.i += 1)\n                        : (this.i = 1)\n                    : this.i !== 0\n                    ? (this.i -= 1)\n                    : (this.i = 1);\n            }\n            t\n                ? this.toogleNextBtn(this.i, sl.children.length, e)\n                : this.tooglePrevBtn(this.i, sl.children.length, e);\n        }\n        if (this.config.defaultCarousel) {\n            this.activeThumbnail(this.i, e);\n        }\n    }\n\n    /**\n     *\n     * Next slide\n     *\n     * @param {event} user event - interaction event perform by user from onClick on btn or thumbnail\n     */\n\n    next(e) {\n        e.preventDefault();\n        this.moveSlide(e, true);\n    }\n\n    /**\n     *\n     * Prvious slide\n     *\n     * @param {event} user event - interaction event perform by user from onClick on btn or thumbnail\n     */\n\n    previous(e) {\n        e.preventDefault();\n        this.moveSlide(e, false);\n    }\n\n    /**\n     *\n     * Return touch points of either touch or mouse\n     *\n     * @param {event} user event - event on silder from either mouse or touch events\n     * @returns {event | object} - either return the event back or the object of touch events\n     */\n\n    unify(e) {\n        return e.changedTouches ? e.changedTouches[0] : e;\n    }\n\n    /**\n     *\n     * Start of slider move Set mousedown value to global and toggle smooth class for css transition on mouse down or touch start\n     *\n     * @param {event} user event - user action either mosuedown or touch start\n     */\n\n    lock(e) {\n        this.x0 = this.unify(e).clientX; //set mousedown clientX value\n        e.target.classList.toggle('smooth', !(this.locked = true));\n    }\n\n    /**\n     *\n     * Moving the slider - moving the slider trigger by mouse move or touch move\n     *\n     * @param {event} user event - mousetouch or touchmove\n     */\n\n    drag(e) {\n        if (this.i !== e.target.children.length - 1 && this.i !== 0) {\n            if (this.locked) {\n                e.target.style.setProperty(\n                    '--tx',\n                    `${Math.round(this.unify(e).clientX - this.x0)}px`\n                );\n            }\n        }\n    }\n\n    /**\n     *\n     * Move slider\n     *\n     * @param {event} user event - mouseup or touchend\n     */\n\n    move(e) {\n        if (this.locked) {\n            let dx = this.unify(e).clientX - this.x0, //dx is value calculate by using clientX mousedown and after value\n                s = Math.sign(dx), //check if swipe is left or right by checking value is negative or positive\n                tx = getComputedStyle(e.target).getPropertyValue('--tx'),\n                p = parseInt(tx.replace(/\\D/g, '')); // MAY use the drag length as a condition to move slider\n\n            if (\n                (this.i > 0 || s < 0) &&\n                (this.i < e.target.children.length - 1 || s > 0) &&\n                (p > 100 ||\n                    this.i === 0 ||\n                    this.i === e.target.children.length - 1) //conditions to swip to slider\n            ) {\n                if (!ie) {\n                    e.target.style.setProperty('--i', (this.i -= s)); //increment i (i repersent the slider)\n                    e.target.style.setProperty('--tx', '0px'); //reset touch x value\n                    e.target.classList.toggle('smooth', !(this.locked = false));\n                    this.x0 = null;\n                    if (s === -1) {\n                        this.toogleNextBtn(this.i, e.target.children.length, e);\n                    } else {\n                        this.tooglePrevBtn(this.i, e.target.children.length, e);\n                    }\n                } else {\n                    this.animateSlider(e, s);\n                    s === -1\n                        ? this.toogleNextBtn(\n                              this.i,\n                              e.target.children.length,\n                              e\n                          )\n                        : this.tooglePrevBtn(\n                              this.i,\n                              e.target.children.length,\n                              e\n                          );\n                }\n                if (this.config.defaultCarousel) {\n                    this.activeThumbnail(this.i, e);\n                }\n            }\n        }\n    }\n\n    /**\n     *\n     * Stop drag when mouse or touch move outside the slider element\n     *\n     * @param {event} user event - mouseup or touchend\n     */\n\n    stopDrag(e) {\n        e.target.style.setProperty('--tx', '0px');\n        e.stopPropagation();\n        e.target.classList.toggle('smooth', !(this.locked = false));\n    }\n\n    /**\n     *\n     * Check event type and passing the correct parent node\n     *\n     * @param {event} user event - either mouse, touch, click events and thumbnail click events\n     * @returns {HTMLSliderElement} -\n     */\n\n    checkEventType(e) {\n        if (e.target.parentElement.classList.contains('galleria-thumbnail')) {\n            return e.target.parentElement.parentElement.parentElement\n                .parentElement;\n        } else {\n            switch (e.type) {\n                case 'mouseup':\n                    return e.target.parentElement.parentElement;\n\n                case 'touchend':\n                    return e.target.parentElement.parentElement;\n\n                default:\n                    return e.target.parentElement.parentElement.parentElement;\n            }\n        }\n    }\n\n    /**\n     *\n     * For edge browsers calculate silders total width\n     *\n     * @param {event} user event -\n     * @returns {number} - total width of slider\n     */\n    //edge fall back cannot use CSS var inside a cal()\n    totalSliderWidth(e) {\n        const sliders = toArray(\n            this.checkEventType(e).querySelectorAll('.swiper-slide')\n        );\n        let totalWidth = 0;\n\n        sliders.forEach((s) => {\n            let style = window.getComputedStyle\n                ? getComputedStyle(s, null)\n                : s.currentStyle;\n\n            totalWidth += s.offsetWidth + parseInt(style.marginRight) || 0;\n        });\n\n        return totalWidth;\n    }\n\n    /**\n     *\n     * Animate slider by setting translate value\n     *\n     * @param {event} user event -\n     * @param {number}  - number either negative or a positive number\n     */\n\n    animateSlider(e, lr) {\n        let sliderWidth = this.totalSliderWidth(e) / e.target.children.length;\n\n        lr === -1\n            ? (this.sliderTranslateCoOr -= sliderWidth)\n            : (this.sliderTranslateCoOr += sliderWidth);\n        e.target.style.setProperty(\n            'transform',\n            'translate(' + this.sliderTranslateCoOr + 'px)'\n        );\n        e.target.classList.toggle('smooth');\n        this.i -= lr;\n    }\n\n    /**\n     *\n     * Adds and setups carousel controls\n     * e.g.\n     *\n     *  <div class=\"swiper-viewport\">\n     *      <div class=\"swiper-container\">\n     *\n     *          <ul class=\"swiper-wrapper\">\n     *              <li class=\"swiper-slide\">\n     *                  <div class=\"swiper-slide__image-wrapper\">\n     *                      <img src=\"https://web2020.city.ac.uk/documentation/patterns/carousel/_DP57645_1920x1080.jpg\" alt=\"Image\">\n     *                  </div>\n     *                  <div class=\"swiper-slide__text\">\n     *                      <p>We are a leading provider of healthcare .....</p>\n     *                  </div>\n     *              </li>\n     *              <li class=\"swiper-slide\">\n     *                  <div class=\"swiper-slide__image-wrapper\">\n     *                      <img class=\"lazy\" src=\"https://web2020.city.ac.uk/documentation/patterns/carousel/_DP57645_1920x1080.jpg\" alt=\"Image\">\n     *                  </div>\n     *                  <div class=\"swiper-slide__text\">\n     *                      <p>We are a leading provider of healthcare .....</p>\n     *                  </div>\n     *              </li>\n     *          </ul>\n     *\n     *      </div>\n     *  </div>\n     *\n     *@param {HTMLElement} elem - The element to carousel.\n     *@param {Object} object - Object containing setting to setup defualt carousel. if using full width carousel\n     * then do not pass in object unless you want to hide the number indicators.\n     * To intialise the defualt carousel pass this object\n     * {\n     *  defaultCarousel: true,\n     *  hidNumInd: true,\n     *  }\n     *\n     */\n\n    init() {\n        const lazyImages = [].slice.call(\n            this.elem.querySelectorAll('img.lazy')\n        );\n        if (\n            'IntersectionObserver' in window &&\n            'IntersectionObserverEntry' in window &&\n            'intersectionRatio' in window.IntersectionObserverEntry.prototype\n        ) {\n            let lazyImageObserver = new IntersectionObserver(function (\n                entries\n            ) {\n                entries.forEach(function (entry, i) {\n                    if (i === 0) {\n                        entry.target.firstElementChild.classList.remove('lazy');\n                    }\n                    if (entry.isIntersecting) {\n                        let lazyImage =\n                            entry.target.parentNode.nextSibling\n                                .firstElementChild.firstElementChild;\n                        lazyImage.src = lazyImage.dataset.src;\n                        lazyImage.classList.remove('lazy');\n                        lazyImageObserver.unobserve(entry.target);\n                    }\n                });\n            });\n\n            lazyImages.forEach(function (lazyImage, i, a) {\n                if (i !== a.length - 1) {\n                    lazyImageObserver.observe(lazyImage.parentNode);\n                } else {\n                    lazyImage.classList.remove('lazy');\n                }\n            });\n        } else {\n            lazyImages.forEach((e) => {\n                if (e.dataset.src) {\n                    e.src = e.dataset.src;\n                }\n                e.classList.remove('lazy');\n            });\n        }\n\n        const _C = this.elem.querySelector('.swiper-wrapper'),\n            numInd = document.createElement('div'),\n            numIndActiveSl = document.createElement('span'),\n            numIndSeparator = document.createElement('span'),\n            numbIndSlLength = document.createElement('span'),\n            buttonsWrap = document.createElement('div'),\n            prevBtnWrap = document.createElement('div'),\n            nextBtnWrap = document.createElement('div'),\n            nextBtn = document.createElement('BUTTON'),\n            prevBtn = document.createElement('BUTTON');\n        //setup carousel buttons\n        buttonsWrap.className = 'swiper-buttons-wrap';\n        prevBtnWrap.className = 'swiper-button-prev';\n        nextBtnWrap.className = 'swiper-button-next';\n        nextBtn.name = 'nextButton';\n        nextBtn.type = 'button';\n        nextBtn.className =\n            'fas fa-arrow-right swiper-slider-arrow arrow-right--btn-next';\n        nextBtn.setAttribute('aria-label', 'Next slider');\n        nextBtn.addEventListener('click', this.next.bind(this), false);\n        prevBtn.name = 'prevButton';\n        prevBtn.type = 'button';\n        prevBtn.className =\n            'fas fa-arrow-left swiper-slider-arrow arrow-left--btn-prev';\n        prevBtn.setAttribute('aria-label', 'Previous slider');\n        prevBtn.addEventListener('click', this.previous.bind(this), false);\n        prevBtn.disabled = true;\n\n        nextBtnWrap.appendChild(nextBtn);\n        prevBtnWrap.appendChild(prevBtn);\n        buttonsWrap.appendChild(prevBtnWrap);\n        buttonsWrap.appendChild(nextBtnWrap);\n\n        if (!this.config.hidNumInd) {\n            //perpare the indicators to append to html\n            numInd.className = 'swiper-indicator';\n            numIndActiveSl.className = 'swiper-indicator__active-slider';\n            numbIndSlLength.className = 'swiper-indicator__slider-length';\n            numIndActiveSl.innerText = this.i + 1;\n            numbIndSlLength.innerText = _C.children.length;\n            numIndSeparator.innerText = ' /';\n\n            numInd.appendChild(numIndActiveSl);\n            numInd.appendChild(numIndSeparator);\n            numInd.appendChild(numbIndSlLength);\n\n            this.elem.appendChild(numInd);\n        }\n\n        this.elem.appendChild(buttonsWrap);\n\n        this.config.sliderLength = _C.children.length;\n\n        if (this.config.defaultCarousel) {\n            this.elem\n                .querySelector('.galleria-thumbnails-list')\n                .style.setProperty('--thumbnails', this.config.sliderLength);\n        }\n\n        _C.style.setProperty('--n', this.config.sliderLength);\n        //add event listeners\n        _C.addEventListener('mousedown', this.lock.bind(this), false);\n        _C.addEventListener('touchstart', this.lock.bind(this), false);\n        _C.addEventListener('mousemove', this.drag.bind(this), false);\n        _C.addEventListener('touchmove', this.drag.bind(this), false);\n        _C.addEventListener('mouseup', this.move.bind(this), false);\n        _C.addEventListener('touchend', this.move.bind(this), false);\n        _C.addEventListener('mouseout', this.stopDrag.bind(this), false);\n\n        _C.firstElementChild.classList.toggle('active');\n\n        this.activeSlider(this.i, _C);\n    }\n}\n","import { checkIntersectionObserver } from '../../../util';\nimport Carousel from '../carousel-constructor';\n\nconst keyCodeTab = 9,\n    keyCodeEnter = 13;\n\nexport default class Defaultcarousel extends Carousel {\n    constructor(elem, options) {\n        super(elem, options);\n    }\n\n    inital() {\n        super.init();\n        let self = this;\n\n        let thumbnails = [].slice.call(\n            this.elem\n                .querySelector('.galleria-thumbnails-list')\n                .querySelectorAll('li')\n        );\n        //edge work around intersectionObserver not triggering using isIntersecting\n        let options = {\n                rootMargin: '0px',\n                threshold: [0, 1],\n            },\n            edge = document.documentElement.classList.contains('edge');\n\n        let edgeThumbnailsObserver = new IntersectionObserver(function (\n            entries\n        ) {\n            entries.forEach(function (entry) {\n                if (entry.intersectionRatio === 1) {\n                    entry.target.setAttribute('aria-hidden', 'false');\n                } else {\n                    entry.target.setAttribute('aria-hidden', 'true');\n                }\n            });\n        },\n        options);\n\n        let thumbnailsObserver = new IntersectionObserver(function (entries) {\n            entries.forEach(function (entry) {\n                if (entry.isIntersecting) {\n                    entry.target.setAttribute('aria-hidden', 'false');\n                } else if (!entry.isIntersecting) {\n                    entry.target.setAttribute('aria-hidden', 'true');\n                }\n            });\n        });\n\n        thumbnails.forEach(function (e, i) {\n            if (i === 0) {\n                e.classList.add('active');\n            }\n            e.addEventListener(\n                'click',\n                function (t) {\n                    self.onClickThunbnail(t, i);\n                },\n                false\n            );\n            e.addEventListener(\n                'keyup',\n                function (e) {\n                    switch (e.keyCode) {\n                        case keyCodeEnter:\n                            self.onClickThunbnail(e, i);\n                            break;\n                        case keyCodeTab:\n                            self.translateThumbnails(i, e);\n                            break;\n                        default:\n                            break;\n                    }\n                },\n                false\n            );\n            e.setAttribute('aria-hidden', 'false');\n            if (checkIntersectionObserver && !edge) {\n                thumbnailsObserver.observe(e);\n            } else if (checkIntersectionObserver && edge) {\n                edgeThumbnailsObserver.observe(e);\n            }\n        });\n    }\n\n    /**\n     *\n     * Exported function for defualt caousel to preform when thumbnail it cliked on\n     * move slider forward or backwards\n     *\n     * @param {event} user event - onlcik event on thumbnail\n     * @param {number} thumbnail index -\n     */\n\n    onClickThunbnail(thumbnail, thumbindex) {\n        if (thumbindex > this.i) {\n            this.i = thumbindex;\n            this.next(thumbnail);\n        } else if (thumbindex < this.i) {\n            this.i = thumbindex;\n            this.previous(thumbnail);\n        }\n\n        this.activeThumbnail(thumbindex, thumbnail);\n    }\n\n    /**\n     *\n     * Set click on thumbnail to be active\n     *\n     * @param {number} thumbnail index -\n     * @param {event} user event - onlcik event on thumbnail\n     */\n\n    activeThumbnail(thumbindex, e) {\n        let thumbnail = this.checkEventType(e),\n            currentThumbnailSpan = document.createElement('span'),\n            listThumbnail = thumbnail\n                .querySelector('.galleria-thumbnails-list')\n                .getElementsByTagName('li');\n        currentThumbnailSpan.innerText = 'Current thumbnail';\n        currentThumbnailSpan.className =\n            'galleria-thumbnail__current-thumbnail';\n        for (const li of listThumbnail) {\n            li.classList.remove('active');\n            if (li.querySelector('.galleria-thumbnail__current-thumbnail')) {\n                li.querySelector(\n                    '.galleria-thumbnail__current-thumbnail'\n                ).remove();\n            }\n        }\n\n        /*slider === 1\n\t        ? listThumbnail[thumbindex + 3].classList.add('fade')\n\t        : slider > lastTwoSlider\n\t        ? null\n\t        : listThumbnail[thumbindex + 2].classList.add('fade');*/\n\n        listThumbnail[thumbindex].classList.add('active');\n        listThumbnail[thumbindex].appendChild(currentThumbnailSpan);\n        this.translateThumbnails(thumbindex, e);\n    }\n\n    /**\n     *\n     * Move thumbnail\n     *\n     * @param {number} thumbnail index -\n     * @param {event} user event - onlcik event on thumbnail\n     */\n\n    translateThumbnails(thumbindex, e) {\n        let thumbnailLi = this.checkEventType(e).querySelector(\n                '.galleria-thumbnails-list'\n            ),\n            thumbnailLength = thumbnailLi.getElementsByTagName('li').length,\n            translate = 0;\n\n        if (thumbindex !== 0 && thumbnailLength > 4) {\n            let galleria = thumbnailLi.getElementsByTagName('li');\n            galleria.forEach((e, i) => {\n                if (i < thumbindex - 1) {\n                    let style = window.getComputedStyle\n                        ? getComputedStyle(e, null)\n                        : e.currentStyle;\n                    let width =\n                        parseInt(style.width) + parseInt(style.marginRight);\n                    translate += width;\n                }\n            });\n            if (thumbindex >= 2) {\n                thumbnailLi.style.setProperty(\n                    'transform',\n                    'translate(-' + translate + 'px)'\n                );\n            } else {\n                thumbnailLi.style.setProperty('transform', 'translate(0px)');\n            }\n        }\n    }\n}\n","import Defaultcarousel from './default-carousel-constructor';\n\nconst className = 'carousel-gallery';\n\n/**\n *\n * Init the defualt gallery\n *\n *\n *\n * HTML e.g.\n *\n *  <div class=\"carousel-gallery-default\">\n *      <div class=\"carousel-gallery\">\n *          <h3>Gallery title</h3>\n *          <ul class=\"swiper-wrapper\">\n *              <li class=\"swiper-slide\">\n *                  <div class=\"swiper-slide__image-wrapper\">\n *                      <img src=\"centre-healthcare-innovation-research.jpg\" alt=\"Banner depicting \">\n *                  </div>\n *              </li>\n *              <li class=\"swiper-slide\">\n *                  <div class=\"swiper-slide__image-wrapper\">\n *                      <img class=\"lazy\" src=\"centre-healthcare-innovation-research.jpg\" alt=\"Banner depicting \">\n *                  </div>\n *              </li>\n *              <li class=\"swiper-slide\">\n *                  <div class=\"swiper-slide__image-wrapper\">\n *                      <img class=\"lazy\" src=\"centre-healthcare-innovation-research.jpg\" alt=\"Banner depicting \">\n *                      <noscript>\n *                          <img class=\"lazy\" src=\"https://web2020.city.ac.uk/__data/assets/image/0019/341236/Phonetics-lab.jpg\" alt=\"Woman using the phonetics lab\">\n *                      </noscript>\n *                  </div>\n *              </li>\n *          </ul>\n *          <div class=\"galleria-thumbnails-wrap\">\n *              <ul class=\"galleria-thumbnails-list\">\n *                  <li class=\"galleria-thumbnail\">\n *                      <img src=\"big_thumbnail.jpg\" alt=\"Banner depicting \"/>\n *                  </li>\n *                  <li class=\"galleria-thumbnail\">\n *                      <img src=\"big_thumbnail.jpg\" alt=\"Banner depicting \"/>\n *                  </li>\n *                  <li class=\"galleria-thumbnail\">\n *                      <img src=\"big_thumbnail.jpg\" alt=\"Banner depicting \"/>\n *                  </li>\n *              </ul>\n *          </div>\n *      </div>\n *  </div>\n *\n * @param {HTMLElement} elem - The element to carousel.\n */\n\nfunction carouselGallery(elem) {\n    let dc = new Defaultcarousel(elem, {\n        defaultCarousel: true,\n        hidNumInd: true,\n    });\n    dc.inital();\n}\n\nexport default {\n    launchFn: carouselGallery,\n    launchQuery: `.${className}`,\n};\n","import Carousel from './carousel-constructor';\n\nconst className = 'swiper-container';\n\nfunction init(elem) {\n    const c = new Carousel(elem);\n    c.init();\n}\n\nexport default {\n    launchFn: init,\n    launchQuery: `.${className}`,\n};\n","function unify(e) {\n    return e.changedTouches ? e.changedTouches[0] : e;\n}\n\nfunction mousePosition(event) {\n    return unify(event).clientX;\n}\n\nexport function swipeCal(x) {\n    return function(y) {\n        return mousePosition(x) - mousePosition(y);\n    };\n}\n","/**\n * Short courses/CPD key information\n *\n * @module patterns/key-information/key-information--lifelong-learning\n * @author Web Development\n * @copyright City, University of London 2020\n */\nimport scroll from 'zenscroll';\nimport { reduceMotion, verticallyInWindow } from '../../util';\nimport aria from '../../aria-attributes';\n\nconst className = 'key-information--lifelong-learning',\n    loadMoreBatch = 3,\n    oneSecond = 1000,\n    scrollDuration = reduceMotion() ? 0 : oneSecond,\n    scrollTo = true;\n/**\n * Initialise data atributes on the start dates.\n *\n * @param  {HTMLLIElement[]} startDates - The start dates.\n */\nfunction prepareStartDates(startDates) {\n    startDates.forEach((startDate, i) => {\n        startDate.setAttribute('tabindex', -1);\n        startDate.setAttribute(\n            aria.label,\n            `Start date ${i + 1} of ${startDates.length}`\n        );\n\n        if (i < 1) {\n            startDate.dataset.sliderposition = 0;\n            startDate.dataset.loadmorevisible = true;\n            startDate.dataset.hidden = false;\n        } else if (i < loadMoreBatch) {\n            startDate.dataset.sliderposition = 1;\n            startDate.dataset.loadmorevisible = true;\n            startDate.dataset.hidden = true;\n        } else {\n            startDate.dataset.sliderposition = 1;\n            startDate.dataset.loadmorevisible = false;\n            startDate.dataset.hidden = true;\n        }\n    });\n}\n\n/**\n * @param  {HTMLElement} keyInformation - The key information element.\n */\nfunction updateButtonState(keyInformation) {\n    const nextButton = keyInformation.querySelector(\n            `.${className}__controls__next`\n        ),\n        prevButton = keyInformation.querySelector(\n            `.${className}__controls__prev`\n        ),\n        loadMoreButton = keyInformation.querySelector(\n            `.${className}__controls__loadmore`\n        );\n\n    keyInformation.querySelector('[data-sliderposition=\"-1\"]')\n        ? prevButton.removeAttribute('disabled')\n        : prevButton.setAttribute('disabled', true);\n\n    keyInformation.querySelector('[data-sliderposition=\"1\"]')\n        ? nextButton.removeAttribute('disabled')\n        : nextButton.setAttribute('disabled', true);\n\n    if (\n        loadMoreButton &&\n        !keyInformation.querySelector('[data-loadmorevisible=\"false\"]')\n    ) {\n        loadMoreButton.parentNode.removeChild(loadMoreButton);\n    }\n}\n\n/**\n * Handle clicks on the next/previous buttons.\n *\n * @param  {HTMLElement} keyInformation - The keyInformation element.\n * @param  {Number} direction - The scroll direction, 1 = next, -1 = previous.\n */\nfunction handleNextPrevClick(keyInformation, direction) {\n    const startDates = Array.from(\n            keyInformation.querySelectorAll(`.${className}__dates > li`)\n        ),\n        current = keyInformation.querySelector('[data-sliderposition=\"0\"]'),\n        currentPage = keyInformation.querySelector(\n            `.${className}__indicator__current`\n        ),\n        nextButton = keyInformation.querySelector(\n            `.${className}__controls__next`\n        ),\n        prevButton = keyInformation.querySelector(\n            `.${className}__controls__prev`\n        );\n\n    nextButton.setAttribute('disabled', true);\n    prevButton.setAttribute('disabled', true);\n\n    if (direction === 1) {\n        const next = current.nextElementSibling;\n\n        next.addEventListener(\n            'transitionend',\n            function focusNext() {\n                next.removeEventListener('transitionend', focusNext, true);\n                next.focus();\n                updateButtonState(keyInformation);\n            },\n            true\n        );\n\n        current.addEventListener(\n            'transitionend',\n            function hideCurrent() {\n                current.removeEventListener('transitionend', hideCurrent, true);\n                current.dataset.hidden = true;\n            },\n            true\n        );\n\n        if (next) {\n            current.dataset.sliderposition = -1;\n            next.dataset.hidden = false;\n            next.dataset.sliderposition = 0;\n            next.dataset.loadmorevisible = true;\n            currentPage.innerText = startDates.indexOf(next) + 1;\n        }\n    } else {\n        const previous = current.previousElementSibling;\n\n        previous.addEventListener(\n            'transitionend',\n            function focusPrevious() {\n                previous.removeEventListener(\n                    'transitionend',\n                    focusPrevious,\n                    true\n                );\n                previous.focus();\n                updateButtonState(keyInformation);\n            },\n            true\n        );\n\n        current.addEventListener(\n            'transitionend',\n            function hideCurrent() {\n                current.removeEventListener('transitionend', hideCurrent, true);\n                current.dataset.hidden = true;\n            },\n            true\n        );\n\n        if (previous) {\n            current.dataset.sliderposition = 1;\n            previous.dataset.hidden = false;\n            previous.dataset.sliderposition = 0;\n            currentPage.innerText = startDates.indexOf(previous) + 1;\n        }\n    }\n}\n\n/**\n * Load another batch of start dates, remove the button if we're done.\n *\n * @param  {HTMLElement} keyInformation - The key information element.\n */\nfunction handleLoadMoreClick(keyInformation) {\n    const hiddenDates = Array.from(\n            keyInformation.querySelectorAll(\n                `.${className}__dates > [data-loadmorevisible=\"false\"]`\n            )\n        ),\n        loadMoreButton = keyInformation.querySelector(\n            `.${className}__controls__loadmore`\n        );\n\n    if (loadMoreBatch >= hiddenDates.length) {\n        loadMoreButton.parentNode.removeChild(loadMoreButton);\n    }\n\n    hiddenDates.slice(0, loadMoreBatch).forEach((date) => {\n        date.dataset.loadmorevisible = true;\n    });\n\n    const firstElement = hiddenDates.shift();\n\n    if (firstElement && scrollTo && !verticallyInWindow(firstElement)) {\n        scroll.to(firstElement, scrollDuration);\n    }\n\n    firstElement && firstElement.focus();\n}\n\n/**\n * Adds a slider and load more functionality to a short course key information section.\n *\n * @param  {HTMLElement} keyInformation - The key information element.\n */\nfunction launchKeyInformation(keyInformation) {\n    const startDates = Array.from(\n            keyInformation.querySelectorAll(`.${className}__dates > li`)\n        ),\n        startDateList = keyInformation.querySelector(`.${className}__dates`);\n\n    if (startDates.length < 2) {\n        return;\n    } else {\n        keyInformation.classList.add(`${className}__dates--controllable`);\n        startDateList.setAttribute('role', 'presentation');\n    }\n\n    const controlsWrapper = document.createElement('nav'),\n        nextButton = document.createElement('button'),\n        nextButtonSpan = document.createElement('span'),\n        prevButton = document.createElement('button'),\n        prevButtonSpan = document.createElement('span'),\n        indicator = document.createElement('div'),\n        currentPage = document.createElement('span'),\n        totalPages = document.createElement('span'),\n        divider = document.createElement('span'),\n        dividerVisible = document.createElement('span'),\n        dividerScreenReader = document.createElement('span'),\n        loadMoreButton = document.createElement('button'),\n        loadMoreButtonSpan = document.createElement('span');\n\n    nextButtonSpan.appendChild(document.createTextNode('Next start date'));\n    nextButton.appendChild(nextButtonSpan);\n    nextButton.setAttribute('type', 'button');\n    nextButton.className = className + '__controls__next';\n    nextButton.addEventListener(\n        'click',\n        () => handleNextPrevClick(keyInformation, 1),\n        true\n    );\n\n    prevButtonSpan.appendChild(document.createTextNode('Previous start date'));\n    prevButton.appendChild(prevButtonSpan);\n    prevButton.setAttribute('type', 'button');\n    prevButton.setAttribute('disabled', 'true');\n    prevButton.className = className + '__controls__prev';\n    prevButton.addEventListener(\n        'click',\n        () => handleNextPrevClick(keyInformation, -1),\n        true\n    );\n\n    if (startDates.length > loadMoreBatch) {\n        loadMoreButtonSpan.appendChild(\n            document.createTextNode('Load more start dates')\n        );\n        loadMoreButton.appendChild(loadMoreButtonSpan);\n        loadMoreButton.setAttribute('type', 'button');\n        loadMoreButton.className = className + '__controls__loadmore';\n        loadMoreButton.addEventListener(\n            'click',\n            () => handleLoadMoreClick(keyInformation),\n            true\n        );\n    }\n\n    currentPage.appendChild(document.createTextNode(1));\n    currentPage.className = className + '__indicator__current';\n\n    dividerVisible.appendChild(document.createTextNode('/'));\n    dividerVisible.className = className + '__indicator__divider--visible';\n    dividerVisible.setAttribute(aria.hidden, 'true');\n    dividerScreenReader.appendChild(document.createTextNode(' of '));\n    dividerScreenReader.className = className + '__indicator__divider--sr';\n    divider.appendChild(dividerVisible);\n    divider.appendChild(dividerScreenReader);\n    divider.className = className + '__indicator__divider';\n\n    totalPages.appendChild(document.createTextNode(startDates.length));\n    totalPages.className = className + '__indicator__total';\n\n    indicator.appendChild(currentPage);\n    indicator.appendChild(divider);\n    indicator.appendChild(totalPages);\n    indicator.className = className + '__indicator';\n\n    controlsWrapper.appendChild(indicator);\n    controlsWrapper.appendChild(prevButton);\n    controlsWrapper.appendChild(nextButton);\n\n    if (startDates.length > loadMoreBatch) {\n        controlsWrapper.appendChild(loadMoreButton);\n    }\n\n    controlsWrapper.className = className + '__controls';\n    controlsWrapper.setAttribute(aria.label, 'Course start dates navigation');\n\n    prepareStartDates(startDates);\n\n    keyInformation.appendChild(controlsWrapper);\n}\n\nexport default {\n    launchFn: launchKeyInformation,\n    launchQuery: `.${className}`,\n};\n","/**\n * Link Finder\n *\n * @module patterns/link-finder/link-finder\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport aria from '../../aria-attributes';\n\nconst className = 'link-finder';\n\n/**\n * Function that prepends icon to anchor paramater\n *\n * @param {HTMLElement} anchor - HTML element to prepend icon to\n * @param {string} className - class name to specify FA icon\n */\nfunction prependIcon(anchor, className) {\n    let node = document.createElement('span');\n    node.className = 'fas ' + className + '  link-decorator';\n    node.setAttribute(aria.hidden, true);\n    anchor.parentNode.insertBefore(node, anchor);\n}\n\n/**\n * Checks if anchor has to have external URL icon\n *\n * @param {HTMLElement} anchor - an anchor HTML element\n */\nfunction findExternalLink(anchor) {\n    if (\n        anchor.origin !== window.location.origin &&\n        anchor.querySelectorAll('img').length < 1 &&\n        anchor.querySelectorAll('.fa-external-link').length < 1 &&\n        !anchor.parentElement.className.includes('cta-like-anchor') &&\n        anchor.className !== 'social-icon' &&\n        !anchor.className.includes('cta') &&\n        !anchor.parentElement.className.includes('cta-block') &&\n        !anchor.parentElement.className.includes('card') &&\n        anchor.href.indexOf('mailto:') !== 0 &&\n        anchor.href.indexOf('tel:') !== 0 &&\n        anchor.href.indexOf('javascript:') !== 0 &&\n        anchor.origin\n    ) {\n        let node = document.createElement('span');\n        node.className = 'far fa-external-link inline-external-link';\n        node.setAttribute(aria.label, '(external link)');\n        anchor.appendChild(node);\n    }\n}\n\n/**\n * This function checks if the anchor has any of the extensions from the 'fileTypes' object\n * if yes it calls prependIcon() to add the appropriate FA icon\n *\n * @param {HTMLElement} anchor - an anchor HTML element\n */\nfunction findDocumentLinks(anchor) {\n    const fileTypes = {\n        pdf: 'pdf',\n        docx: 'word',\n        doc: 'word',\n        xlsx: 'excel',\n        xls: 'excel',\n    };\n\n    for (let key in fileTypes) {\n        if (anchor.href.indexOf('.' + key) !== -1) {\n            prependIcon(anchor, 'fa-file-' + fileTypes[key]);\n\n            let anchorText = anchor.textContent;\n            anchorText += ' [' + key.toUpperCase() + ']';\n            anchor.textContent = null;\n            anchor.textContent = anchorText;\n            break;\n        }\n    }\n}\n\n/**\n * Every anchor on the webpage has to have appropriate icons prepended or appended depending on predefined requirements\n * This function will iterate through every anchor of the HTML element and calls the appropriate function to add the right icon\n * if required\n *\n * @param {HTMLElement} e - an HTML element with 'link-finder' class name\n */\nfunction findLinks(e) {\n    const anchors = e.querySelectorAll('a');\n\n    anchors.forEach(function (anchor) {\n        findDocumentLinks(anchor);\n        findExternalLink(anchor);\n    });\n}\n\nexport default {\n    launchFn: findLinks,\n    launchQuery: `.${className}`,\n};\n","/**\n * Load more - show additional items on 'Load more' button click. Update URL to illustrate where user is in item set.\n *\n * @module patterns/load-more/load-more\n * @author Mark Skinsley <mark.skinsley@city.ac.uk>\n * @copyright City, University of London 2019\n */\n\nimport { numberFromString } from '../../util';\nimport scroll from 'zenscroll';\n\nconst className = 'load-more';\n\nlet hashedUrl = window.location.hash,\n    loadMoreId;\n\n/**\n * Control what items will display based on wrapper's 'data-listings-show' data attribute.\n *\n * @param {HTMLElements} [items] - Elements controlled by 'Load more' button.\n * @param {number} visibleItems - Number of items visible at any one time.\n * @param {HTMLElement} loadMoreBtn - Button controlling particular item group.\n */\nfunction itemsDisplay(items, visibleItems, loadMoreBtn) {\n    for (const item of items.entries()) {\n        item[1].setAttribute('tabindex', '-1');\n        if (item[0] >= visibleItems) {\n            item[1].classList.add('hide');\n            item[1].style.display = 'none';\n        } else {\n            item[1].classList.remove('hide');\n            item[1].style.display = 'grid';\n        }\n    }\n    // Hide 'load more' button when reached end of listings\n    if (visibleItems > items.length) {\n        loadMoreBtn.classList.add('hide');\n    } else {\n        loadMoreBtn.classList.remove('hide');\n    }\n}\n\n/**\n * Scroll to, and focus first listing of newly visible items batch.\n *\n * @param {HTMLElement} [items] - Elements controlled by 'Load more' button.\n * @param {number} visibleItems - Number of items visible at any one time.\n * @param {number} itemsIncrement - Number of additional items shown when 'Load more' button is clicked.\n */\nfunction scrollToItem(items, visibleItems, itemsIncrement) {\n    let targetItem = visibleItems - itemsIncrement;\n    for (const item of items.entries()) {\n        if (item[0] === targetItem) {\n            item[1].focus();\n            scroll.to(item[1]);\n        } else if (visibleItems === itemsIncrement) {\n            if (item[0] === 0) {\n                item[1].focus();\n                scroll.to(item[1]);\n            }\n        }\n    }\n}\n\n/**\n * Push state to URL: used to build initial hash after first 'Load more' click.\n *\n * @param {string} parentType - Data attribute describing parent group.\n * @param {string} childrenType - Data attribute describing child items.\n * @param {HTMLElement} wrapperId - Parent element wrapping items and 'Load more' button.\n * @param {number} visibleItems - Number of items visible at any one time.\n * @param {number} itemsIncrement - Number of additional tems shown when 'Load more' button is clicked.\n */\nfunction pushUrlState(\n    parentType,\n    childrenType,\n    wrapperId,\n    visibleItems,\n    itemsIncrement\n) {\n    let targetListingUrlParam = visibleItems - (itemsIncrement - 1);\n    history.pushState(\n        '',\n        '',\n        `#${parentType}${wrapperId}-${childrenType}${targetListingUrlParam}`\n    );\n}\n\n/**\n * Replace URL state: used to swap existing hash\n *\n * @param {string} parentType - Data attribute describing parent group.\n * @param {string} childrenType - Data attribute describing child items.\n * @param {HTMLElement} wrapperId - Parent element wrapping items and 'Load more' button.\n * @param {number} visibleItems - Number of items visible at any one time.\n * @param {number} itemsIncrement - Number of additional tems shown when 'Load more' button is clicked.\n */\nfunction replaceUrlState(\n    parentType,\n    childrenType,\n    wrapperId,\n    visibleItems,\n    itemsIncrement\n) {\n    let targetListingUrlParam = visibleItems - (itemsIncrement - 1);\n    history.replaceState(\n        '',\n        '',\n        `#${parentType}${wrapperId}-${childrenType}${targetListingUrlParam}`\n    );\n}\n\nfunction launchLoadMore(e) {\n    let wrapperId = e.getAttribute('id'),\n        items = e.querySelectorAll('.item'),\n        itemsIncrement = parseInt(e.dataset.increment),\n        loadMoreBtn = e.querySelector('.content-toggle button'),\n        parentType = e.getAttribute('data-item-parent'),\n        childrenType = e.getAttribute('data-item-children');\n    /**\n     * Give wrapper a numeric data attribute. As this changes, so\n     * will the number of visible items.\n     */\n    e.setAttribute('data-items-visible', itemsIncrement);\n    let visibleItems = parseInt(e.getAttribute('data-items-visible'));\n\n    // Load correct number of items based on URL hash\n    if (hashedUrl) {\n        let hashedUrlParts = hashedUrl.split('-');\n        let activeItem = parseInt(numberFromString(hashedUrlParts[1]));\n        visibleItems = activeItem + (itemsIncrement - 1);\n        e.setAttribute('data-items-visible', visibleItems);\n        itemsDisplay(items, visibleItems, loadMoreBtn);\n        scrollToItem(items, visibleItems, itemsIncrement);\n    } else {\n        itemsDisplay(items, visibleItems, loadMoreBtn);\n    }\n\n    // Run on every 'load more' click: increase listings by batch number\n    loadMoreBtn.addEventListener('click', () => {\n        visibleItems += itemsIncrement;\n        e.setAttribute('data-items-visible', visibleItems);\n        itemsDisplay(items, visibleItems, loadMoreBtn);\n        scrollToItem(items, visibleItems, itemsIncrement);\n        hashedUrl = window.location.hash;\n        hashedUrl\n            ? replaceUrlState(\n                  parentType,\n                  childrenType,\n                  wrapperId,\n                  visibleItems,\n                  itemsIncrement\n              )\n            : pushUrlState(\n                  parentType,\n                  childrenType,\n                  wrapperId,\n                  visibleItems,\n                  itemsIncrement\n              );\n        loadMoreId = e.id;\n    });\n\n    // Back/forward browser clicks.\n    window.onpopstate = () => {\n        let loadMoreIdElement = document.getElementById(loadMoreId);\n\n        // Must re-assign variable on pop state change\n        hashedUrl = window.location.hash;\n\n        if (hashedUrl) {\n            // Capture latest hash\n            let updatedUrlParts = window.location.hash.split('-');\n            let currentItem = parseInt(numberFromString(updatedUrlParts[1]));\n            currentItem = currentItem + (itemsIncrement - 1);\n            visibleItems = currentItem;\n\n            e.setAttribute('data-items-visible', visibleItems);\n            itemsDisplay(items, visibleItems, loadMoreBtn);\n            scrollToItem(items, visibleItems, itemsIncrement);\n        } else {\n            let relatedItems = loadMoreIdElement.querySelectorAll('.item');\n            visibleItems = itemsIncrement;\n            itemsDisplay(items, visibleItems, loadMoreBtn);\n            e.setAttribute('data-items-visible', itemsIncrement);\n            scrollToItem(relatedItems, visibleItems, itemsIncrement);\n        }\n    };\n}\n\nexport default {\n    launchFn: launchLoadMore,\n    launchQuery: `.${className}`,\n};\n","/**\n * Generic navigation functions for menu and secondary navigation.\n *\n * @module menu-formatters\n * @author Web Development\n * @copyright City, University of London 2020\n */\n\nimport scroll from 'zenscroll';\nimport { toBool, appendAll, reduceMotion } from '../../util';\nimport aria from '../../aria-attributes';\n\nconst oneSecond = 1000,\n    scrollDuration = reduceMotion() ? 0 : oneSecond;\n\n/**\n * Set sub-menu button attributes for the open/closed state.\n *\n * @param {HTMLButtonElement} button - The button to decorate.\n * @param {boolean} open - Should it be open?\n * @param {string} buttonTextClassName - The class of the text span.\n */\nfunction setNavigationItemButtonDetails(button, open, rootClass) {\n    const navigationItem = button.closest('li'),\n        sectionText = navigationItem.dataset.title + ' section',\n        buttonClassName = rootClass + '__button',\n        buttonTextClassName = buttonClassName + '__text',\n        textSpan = button.querySelector(`.${buttonTextClassName}`),\n        text = open ? 'Close ' : 'Open ';\n\n    open &&\n        Array.from(\n            button.closest('ul').querySelectorAll('button')\n        ).forEach((button) =>\n            setNavigationItemButtonDetails(button, false, rootClass)\n        );\n\n    navigationItem.dataset.open = open;\n    button.setAttribute(aria.expanded, open);\n    button.title = text + sectionText;\n    textSpan.innerText = text + sectionText;\n}\n\n/**\n * Toggle a sub-navigation open or closed.\n */\nfunction toggleSubNavigation(button, rootClass) {\n    const expanded = button.getAttribute(aria.expanded);\n\n    toBool(expanded)\n        ? setNavigationItemButtonDetails(button, false, rootClass)\n        : setNavigationItemButtonDetails(button, true, rootClass);\n\n    scroll.intoView(button.closest('li'), scrollDuration);\n}\n\n/**\n * Decorate sub-navigation element with the appropriate attributes.\n *\n * @param {HTMLLIElement} navigationItem - The list item representing button navigation item.\n * @param {string} rootClass - The class of the navigation element.\n */\nfunction prepareSubNavigation(navigationItem, rootClass) {\n    const navigationItemBtn = document.createElement('button'),\n        iconSpan = document.createElement('span'),\n        textSpan = document.createElement('span'),\n        controlsClassName = rootClass + '__controls',\n        buttonClassName = rootClass + '__button',\n        buttonTextClassName = buttonClassName + '__text',\n        buttonIconClassName = buttonClassName + '__icon',\n        currentClassName = rootClass + '__current',\n        hierarchyClassName = rootClass + '__hierarchy',\n        controlsWrapper = navigationItem.querySelector(`.${controlsClassName}`);\n\n    navigationItemBtn.setAttribute('type', 'button');\n    iconSpan.setAttribute(aria.hidden, 'true');\n    iconSpan.className = `${buttonIconClassName} fal fa-fw`;\n    textSpan.className = `${buttonTextClassName}`;\n    appendAll(navigationItemBtn, [iconSpan, textSpan]);\n    controlsWrapper.appendChild(navigationItemBtn);\n\n    if (\n        navigationItem.className.indexOf(currentClassName) >= 0 ||\n        navigationItem.className.indexOf(hierarchyClassName) >= 0\n    ) {\n        setNavigationItemButtonDetails(navigationItemBtn, true, rootClass);\n    } else {\n        setNavigationItemButtonDetails(navigationItemBtn, false, rootClass);\n    }\n}\n\n/**\n * Iterate over the navigation lists, transforming them into the initial\n * navigation with the current asset lineage open.\n *\n * @param {HTMLElement} navigation - The navigation container.\n * @param {string} rootClass - The class of the navigation element.\n */\nexport function prepareNavigation(navigation, rootClass) {\n    const controlsClassName = rootClass + '__controls';\n\n    Array.from(navigation.querySelectorAll('li')).forEach((navigationItem) => {\n        const link = navigationItem.querySelector('a'),\n            subNavigation = navigationItem.querySelector('ul'),\n            linkText = 'Visit ' + navigationItem.dataset.title,\n            textWrapper = document.createElement('span'),\n            controlsWrapper = document.createElement('div');\n\n        controlsWrapper.className = controlsClassName;\n        textWrapper.appendChild(link.firstChild.cloneNode(true));\n        link.replaceChild(textWrapper, link.firstChild);\n        link.title = linkText;\n        navigationItem.replaceChild(controlsWrapper, link);\n        controlsWrapper.appendChild(link);\n\n        subNavigation &&\n            subNavigation.firstElementChild &&\n            prepareSubNavigation(navigationItem, rootClass);\n    });\n}\n\n/**\n * Open/close the sub-menu when its button is clicked.\n *\n * @param {HTMLUListElement} subNavigation - Toggle the sub-navigation when its button is clicked.\n * @param {string} rootClass - The class of the navigation element.\n */\nexport function listenForNavigationToggles(subNavigation, rootClass) {\n    Array.from(subNavigation.querySelectorAll('button')).forEach((button) =>\n        button.addEventListener(\n            'click',\n            () => toggleSubNavigation(button, rootClass),\n            true\n        )\n    );\n}\n","/**\n * Global menu\n *\n * @module patterns/menu/menu\n * @author Web Development\n * @copyright City, University of London 2018-2020\n */\nimport createFocusTrap from 'focus-trap';\nimport { toBool, isVisible } from '../../util';\nimport aria from '../../aria-attributes';\nimport {\n    prepareNavigation,\n    listenForNavigationToggles,\n} from './menu-formatters';\n\nconst className = 'menu',\n    hierarchyClassName = className + '__hierarchy',\n    currentClassName = className + '__current',\n    veilClassName = className + '__veil',\n    contentClassName = className + '__content',\n    contentHeaderClassName = contentClassName + '__header',\n    currentPage = contentHeaderClassName + '--current',\n    controlsClassName = className + '__controls',\n    buttonDisplayClassName = className + '__display__button',\n    buttonClassName = className + '__button',\n    level1ClassName = className + '__level1',\n    buttonTextClassName = buttonClassName + '__text';\n\n/**\n * Creates a function for setting a menu to be open or closed.\n *\n * @param {HTMLElement} menu - The menu container.\n * @param {HTMLButtonElement} button - The button that toggles the menu.\n * @returns {Function} A function that will set the menu to be open/closed.\n */\nfunction menuSetter(menu, button) {\n    /**\n     * @param {boolean} open - Set the menu to be open?\n     */\n    const setMenu = (open) => {\n        const buttonText = button.querySelector(`.${buttonTextClassName}`);\n\n        menu.dataset.open = open;\n        buttonText.innerText = open ? 'Close' : 'Menu';\n        button.setAttribute(aria.expanded, open);\n    };\n\n    return setMenu;\n}\n\n/**\n * Opens or closes the menu, (de)activates the focus trap if provided, and\n * scrolls the sub-menus so that the current page lineage or open menus are in\n * view.\n *\n * @param {HTMLButtonElement} button - The button for toggling the menu.\n * @param {Function} setMenu - A function for setting menu attributes to be open/closed.\n * @param {object} trap - The focus trap object.\n * @param {HTMLElement} veil - The veiling element.\n */\nfunction toggleMenu(button, setMenu, trap, veil) {\n    const expanded = button.getAttribute(aria.expanded);\n    if (toBool(expanded)) {\n        trap.deactivate();\n        veil.dataset.on = 'false';\n        setMenu(false);\n    } else {\n        setMenu(true);\n        veil.dataset.on = 'true';\n        trap.activate();\n    }\n}\n\n/**\n * Turn the menu label into a button to toggle the menu open and closed.\n *\n * While the menu is open, a focus trap should limit tab indexing to the menu\n * and its button.\n *\n * @param {HTMLElement} label - The menu label.\n * @param {HTMLButtonElement} button - A button element.\n * @param {Function} setMenu - A function to open/close the menu.\n * @param {HTMLElement} veil - The veiling element.\n */\nfunction createMenuToggle(label, button, setMenu, veil) {\n    const buttonWrapper = document.createElement('div'),\n        menu = label.closest(`.${className}`);\n\n    button.className = 'menu__display__button__button';\n    buttonWrapper.className = 'menu__display__button__button__wrapper';\n    button.setAttribute('type', 'button');\n    button.setAttribute(aria.hasPopup, 'menu');\n    Array.from(label.childNodes).forEach((child) =>\n        buttonWrapper.appendChild(child)\n    );\n    button.appendChild(buttonWrapper);\n\n    const trap = createFocusTrap(menu, {\n        /**\n         * Initial focus should be whichever of: the current page; a menu item\n         * in the asset lineage or; the first item in the last column appears\n         * last in the DOM and is visible.\n         */\n        initialFocus: () => {\n            const open = Array.from(\n                menu.querySelectorAll(\n                    [\n                        `.${contentHeaderClassName} > span`,\n                        `.${currentClassName} > .${controlsClassName} > a`,\n                        `.${hierarchyClassName} > .${controlsClassName} > a`,\n                        `.${level1ClassName} > ul > li:first-of-type > .${controlsClassName} > a`,\n                        `.${currentPage} > a`,\n                    ].join(',')\n                )\n            ).filter((elem) => isVisible(elem));\n\n            return open[open.length - 1];\n        },\n        onDeactivate: () => toggleMenu(button, setMenu, trap, veil),\n        clickOutsideDeactivates: true,\n    });\n\n    button.addEventListener(\n        'click',\n        () => toggleMenu(button, setMenu, trap, veil),\n        true\n    );\n}\n\n/**\n * Transform the Matrix-generated menu lists into an interactive menu.\n *\n * @param {HTMLElement} menu - The menu element.\n */\nfunction launchMenu(menu) {\n    // During testing only: remove 'under construction' indicators globally\n    menu.innerHTML = menu.innerHTML.replace(/\\(\\( /g, '').replace(/ \\)\\)/g, '');\n\n    const label = menu.querySelector(`.${buttonDisplayClassName}`),\n        button = document.createElement('button'),\n        veil = document.createElement('div'),\n        setMenu = menuSetter(menu, button);\n\n    veil.className = veilClassName;\n    veil.setAttribute(aria.hidden, 'true');\n    document\n        .querySelector('body')\n        .insertBefore(veil, document.querySelector('main'));\n\n    createMenuToggle(label, button, setMenu, veil);\n    label.appendChild(button);\n    setMenu(false);\n\n    prepareNavigation(menu.querySelector(`.${level1ClassName}`), className);\n    listenForNavigationToggles(\n        menu.querySelector(`.${level1ClassName}`),\n        className\n    );\n}\n\nexport default {\n    launchFn: launchMenu,\n    launchQuery: `.${className}`,\n};\n","/**\n * modal\n *\n * @module patterns/pagination/pagination\n * @author Web Development\n * @copyright City, University of London 2018\n *\n */\n\nimport {\n    appendAll,\n    createHTMLElement,\n    reduceMotion,\n    toBool,\n    verticallyInWindow,\n} from '../../util';\n\nimport aria from '../../aria-attributes';\nimport createFocusTrap from 'focus-trap';\nimport scroll from 'zenscroll';\n\nconst className = 'modal',\n    bodyClassName = className + '__body',\n    keyCodeEscape = 27,\n    oneSecond = 1000,\n    scrollDuration = reduceMotion() ? 0 : oneSecond,\n    scrollTo = true;\n\nlet trap;\n\n/**\n * launch function\n *\n * @param {HTMLElement} modal - an HTML element with the modal class.\n */\nfunction launchModal(modal) {\n    let dialogArray = [];\n    const dialogTopic = modal.getAttribute('data-topic');\n\n    Array.from(modal.getElementsByTagName('li')).forEach((list, i) => {\n        if (\n            !list.dataset.modalcontent ||\n            list.dataset.modalcontent === 'true'\n        ) {\n            const wrapper = document.createElement('div'),\n                listButton = document.createElement('button'),\n                listButtonSpan = document.createElement('span'),\n                listBody = Array.from(list.childNodes),\n                listHeader = list.firstElementChild,\n                customHeader = list.getAttribute('data-header'),\n                format = list.getAttribute('data-keepformat'),\n                header = document.createElement('div');\n\n            let title,\n                keepFormat = toBool(format),\n                shortName = list.getAttribute('data-shortname');\n\n            listButton.classList.add('modal__button');\n            listButton.setAttribute('type', 'button');\n            listButton.setAttribute(aria.label, 'Open dialog');\n\n            listButtonSpan.classList.add('inline-text');\n            listButton.appendChild(listButtonSpan);\n\n            list.appendChild(wrapper);\n            appendAll(wrapper, listBody);\n\n            wrapper.classList.add(`${bodyClassName}`);\n\n            if (customHeader) {\n                title = customHeader;\n            } else {\n                title = listHeader.innerText;\n            }\n\n            if (shortName === null) {\n                shortName = listHeader.innerText;\n            }\n\n            if (keepFormat) {\n                list.insertBefore(listHeader, wrapper);\n\n                listHeader.addEventListener('click', function () {\n                    createDialog(modal, `${i}`, dialogArray);\n                });\n            } else {\n                listButtonSpan.textContent = listHeader.textContent;\n                header.appendChild(listHeader);\n                list.insertBefore(listButton, wrapper);\n\n                listButton.addEventListener('click', function () {\n                    createDialog(modal, `${i}`, dialogArray);\n                });\n            }\n\n            dialogArray.push({\n                title: title,\n                body: wrapper.innerHTML,\n                topic: dialogTopic,\n                shortname: shortName,\n            });\n        }\n    });\n}\n\n/**\n * function that creates a pop-up dialog, linked to click event in launchModal(modal)\n *\n * @param {HTMLElement} parent - an HTML element with the modal class.\n * @param {number} position - position of the <li> in the <ul>\n * @param {array} dialogArray - array of objects contaning title and body {title:title, body:body} to build dialog pager\n *\n */\nfunction createDialog(parent, position, dialogArray) {\n    const slider = toBool(parent.getAttribute('data-slider')),\n        type = parent.dataset.type;\n\n    const closeBtn = createHTMLElement('button', [\n        { label: 'class', val: 'dialog__close fas fa-times' },\n        { label: 'aria-label', val: 'Close modal' },\n    ]);\n\n    const dialog = createHTMLElement('div', [\n        { label: 'class', val: 'dialog' },\n        { label: 'data-position', val: `${position}` },\n        { label: 'data-type', val: `${type}` },\n    ]);\n\n    const bodyWrapper = createHTMLElement('div', [\n        { label: 'class', val: 'dialog__content' },\n    ]);\n\n    const wrapperWrapper = createHTMLElement('div', [\n        { label: 'class', val: 'dialog__inner' },\n        { label: 'role', val: 'role' },\n    ]);\n\n    const dialogStrapline = createHTMLElement('p', [\n        { label: 'class', val: 'dialog__strapline' },\n    ]);\n\n    const dialogTitle = createHTMLElement('p', [\n        { label: 'class', val: 'dialog__heading' },\n    ]);\n\n    const dialogBody = createHTMLElement('div', [\n        { label: 'class', val: 'dialog__body-copy' },\n    ]);\n\n    dialogTitle.innerText = dialogArray[position].title;\n    dialogBody.innerHTML = dialogArray[position].body;\n    dialogStrapline.innerHTML = dialogArray[position].topic;\n\n    bodyWrapper.appendChild(closeBtn);\n    bodyWrapper.appendChild(dialogStrapline);\n    bodyWrapper.appendChild(dialogTitle);\n    bodyWrapper.appendChild(dialogBody);\n    wrapperWrapper.appendChild(bodyWrapper);\n    dialog.appendChild(wrapperWrapper);\n\n    const main = document.querySelector('main');\n    main.appendChild(dialog);\n\n    dialog.addEventListener('keydown', (e) => {\n        if (e.keyCode === keyCodeEscape) {\n            e.preventDefault();\n            document.body.classList.remove('dialog-in', 'no-scroll');\n            trap.deactivate();\n            closeDialog(dialog, parent);\n        }\n    });\n\n    dialog.addEventListener('click', (e) => {\n        if (e.target.classList.contains('dialog')) {\n            e.preventDefault();\n            e.stopPropagation();\n            document.body.classList.remove('dialog-in', 'no-scroll');\n            trap.deactivate();\n            closeDialog(dialog, parent);\n        }\n    });\n\n    closeBtn.addEventListener('click', (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        closeDialog(dialog, parent);\n        document.body.classList.remove('dialog-in', 'no-scroll');\n        trap.deactivate();\n    });\n\n    trapFocus(dialog);\n    document.body.classList.add('dialog-in', 'no-scroll');\n\n    if (slider && dialogArray.length > 1) {\n        createControl(dialog, dialogArray);\n    }\n}\n\n/**\n * function that creates pager button on dialog box\n * this function is triggered by createDialog() if the HTML element with classname modal has data[slider] set to true\n *\n * @param {HTMLElement} dialog - an HTML element created by createDialog()\n * @param {array} dialogArray - array of objects contaning title and body {title:title, body:body} to build dialog pager\n *\n */\nfunction createControl(dialog, dialogArray) {\n    let position = parseInt(dialog.getAttribute('data-position'));\n\n    const buttonWrapper = createHTMLElement('div', [\n        { label: 'class', val: 'dialog__slider-control' },\n    ]);\n\n    let buttonPrev = controlButton(dialogArray, position, 'left');\n    let buttonNext = controlButton(dialogArray, position, 'right');\n\n    buttonNext.addEventListener('click', (e) => {\n        e.preventDefault();\n        let pos = buttonNext.getAttribute('data-nextState');\n        addDialogEvent(dialog, dialogArray, pos);\n    });\n\n    buttonPrev.addEventListener('click', (e) => {\n        e.preventDefault();\n        let pos = buttonPrev.getAttribute('data-nextState');\n        addDialogEvent(dialog, dialogArray, pos);\n    });\n\n    buttonWrapper.appendChild(buttonPrev);\n    buttonWrapper.appendChild(buttonNext);\n\n    const dialogContent = dialog.querySelector('.dialog__content');\n    dialogContent.appendChild(buttonWrapper);\n}\n\n/**\n * function attached to control button (created by function 'createControl()') click event\n * it rerenders title, body, button labels of dialog\n *\n * @param {HTMLElement} dialog - an HTML element created by createDialog()\n * @param {array} dialogArray - array of objects contaning title and body {title:title, body:body} to build dialog pager\n * @param {number} nextState - position of object in dialogArray that will be used to update dialog title, body, and button labels\n *\n */\nfunction addDialogEvent(dialog, dialogArray, nextState) {\n    nextState = parseInt(nextState);\n    dialog.querySelector('.dialog__heading').innerText =\n        dialogArray[nextState].title;\n    dialog.querySelector('.dialog__body-copy').innerHTML =\n        dialogArray[nextState].body;\n\n    if (nextState === 0) {\n        dialog\n            .querySelectorAll('button')[1]\n            .setAttribute('data-nextstate', `${dialogArray.length - 1}`);\n        dialog.querySelectorAll('.dialog__underline-transition')[0].innerText =\n            dialogArray[dialogArray.length - 1].shortname;\n\n        dialog.querySelectorAll('.dialog__underline-transition')[1].innerText =\n            dialogArray[nextState + 1].shortname;\n        dialog\n            .querySelectorAll('button')[2]\n            .setAttribute('data-nextstate', `${nextState + 1}`);\n    } else if (nextState === dialogArray.length - 1) {\n        dialog.querySelectorAll('.dialog__underline-transition')[0].innerText =\n            dialogArray[nextState - 1].shortname;\n        dialog\n            .querySelectorAll('button')[1]\n            .setAttribute('data-nextstate', `${nextState - 1}`);\n\n        dialog.querySelectorAll('.dialog__underline-transition')[1].innerText =\n            dialogArray[0].shortname;\n        dialog\n            .querySelectorAll('button')[2]\n            .setAttribute('data-nextstate', '0');\n    } else {\n        dialog.querySelectorAll('.dialog__underline-transition')[0].innerText =\n            dialogArray[nextState - 1].shortname;\n        dialog\n            .querySelectorAll('button')[1]\n            .setAttribute('data-nextstate', `${nextState - 1}`);\n\n        dialog.querySelectorAll('.dialog__underline-transition')[1].innerText =\n            dialogArray[nextState + 1].shortname;\n        dialog\n            .querySelectorAll('button')[2]\n            .setAttribute('data-nextstate', `${nextState + 1}`);\n    }\n}\n\n/**\n * function that creates HTML structure of dialog control buttons\n *\n * @param {array} dialogArray - array of objects contaning title and body {title:title, body:body} to build dialog pager\n * @param {number} position - position of the <li> in the <ul>, used to calculate nextState\n * @param {string} direction - either \"left\" or \"right\", this will determine the type of icon being attached to the button\n *\n */\nfunction controlButton(dialogArray, position, direction) {\n    const button = document.createElement('button');\n    const buttonLabel = document.createElement('span');\n    buttonLabel.classList.add('dialog__underline-transition');\n\n    let nextState = checkNextState(dialogArray, position, direction);\n\n    button.setAttribute('data-nextstate', `${nextState}`);\n\n    if (dialogArray[nextState].shortname) {\n        buttonLabel.innerText = dialogArray[nextState].shortname;\n    } else {\n        buttonLabel.innerText = dialogArray[nextState].title;\n    }\n\n    const buttonIcon = createHTMLElement('span', [\n        {\n            label: 'class',\n            val: `icon far fa-long-arrow-${direction}`,\n        },\n    ]);\n\n    if (direction === 'left') {\n        buttonIcon.setAttribute(aria.label, 'previous item');\n    } else {\n        buttonIcon.setAttribute(aria.label, 'next item');\n    }\n\n    const buttonLabelWrapper = document.createElement('div');\n    buttonLabelWrapper.appendChild(buttonLabel);\n\n    button.appendChild(buttonIcon);\n    button.appendChild(buttonLabelWrapper);\n\n    return button;\n}\n\n/**\n * function calculates and returns nextState\n * it will be used to create click event of control button\n *\n * @param {array} dialogArray - array of objects contaning title and body {title:title, body:body} to build dialog pager\n * @param {number} position - position of the <li> in the <ul>, used to calculate nextState\n * @param {string} direction - either \"left\" or \"right\"\n *\n */\nfunction checkNextState(dialogArray, position, direction) {\n    const pos = parseInt(`${position}`);\n    let nextState;\n\n    if (pos === 0) {\n        if (direction === 'left') {\n            nextState = dialogArray.length - 1;\n        } else {\n            nextState = pos + 1;\n        }\n    } else if (pos === dialogArray.length - 1) {\n        if (direction === 'left') {\n            nextState = pos - 1;\n        } else {\n            nextState = 0;\n        }\n    } else {\n        if (direction === 'left') {\n            nextState = pos - 1;\n        } else {\n            nextState = pos + 1;\n        }\n    }\n\n    return nextState;\n}\n\n/**\n * removes dialog from document\n *\n * @param {HTMLElement} dialog - HTML element created by created by function createDialog()\n * @param {HTMLElement} background - background of dialog\n *\n */\nfunction closeDialog(dialog, modal) {\n    const parent = dialog.parentNode;\n    parent.removeChild(dialog);\n\n    if (scrollTo && !verticallyInWindow(modal)) {\n        scroll.to(modal, scrollDuration);\n    }\n}\n\nfunction trapFocus(modal) {\n    let modalInner = modal.querySelector('.dialog__inner');\n\n    trap = createFocusTrap(modalInner, {\n        clickOutsideDeactivates: true,\n    });\n\n    trap.activate();\n}\n\nexport default {\n    launchFn: launchModal,\n    launchQuery: `.${className}`,\n};\n","/**\n * Secondary navigation\n *\n * @module patterns/navigation/navigation-primary\n * @author Web Development\n * @copyright City, University of London 2019\n */\nimport { toBool, appendAll } from '../../util';\nimport aria from '../../aria-attributes';\n\nconst className = 'navigation',\n    classNameSpecific = className + '--primary',\n    topLevelClassName = classNameSpecific + '__section-text',\n    buttonClassName = className + '__button',\n    openCloseTextClassName = buttonClassName + '__open-close',\n    navigationTextClassName = buttonClassName + '__navigation',\n    headerClassName = classNameSpecific + '__menu__header',\n    veilClassName = className + '__veil',\n    openText = 'Open',\n    closeText = 'Close',\n    navigationText = 'navigation section',\n    keyCodeTab = 9,\n    keyCodeEscape = 27;\n\n/**\n * Return a function to toggle everything closed.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n * @param {HTMLElement} veil - The veiling element.\n * @returns {function} - A function for toggling all the menus closed.\n */\nfunction createCloseAll(navigation, veil) {\n    return () => {\n        const buttons = Array.from(\n            navigation.querySelectorAll(\n                '.navigation--primary__level1 > .navigation__button'\n            )\n        );\n\n        buttons.forEach((button) => {\n            button.setAttribute(aria.expanded, 'false');\n            button\n                .querySelector(`.${openCloseTextClassName}`)\n                .replaceChild(\n                    document.createTextNode(openText),\n                    button.querySelector(`.${openCloseTextClassName}`)\n                        .firstChild\n                );\n        });\n        veil.dataset.on = 'false';\n    };\n}\n\n/**\n * Return a function to toggle whether a navigation section is open.\n * @param {HTMLElement} button - The button to toggle.\n * @param {function} closeAll - A function for closing all menus.\n * @param {HTMLElement} veil - The veiling element.\n * @returns {function} - A function for toggling a menu open or closed.\n */\nfunction createSectionToggle(button, closeAll, veil) {\n    return () => {\n        const open = !toBool(button.getAttribute(aria.expanded));\n\n        closeAll();\n\n        if (open) {\n            button.closest(`.${classNameSpecific}`).dataset.open = 'true';\n            veil.dataset.on = 'true';\n            button.setAttribute(aria.expanded, open);\n            button\n                .querySelector(`.${openCloseTextClassName}`)\n                .replaceChild(\n                    document.createTextNode(closeText),\n                    button.querySelector(`.${openCloseTextClassName}`)\n                        .firstChild\n                );\n        }\n    };\n}\n\n/**\n * Create toggle buttons from the top level anchors.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n * @param {HTMLElement} veil - The veiling element.\n * @param {function} closeAll - A function for closing all menus.\n */\nfunction prepareTopLevel(navigation, veil, closeAll) {\n    const topLevels = Array.from(\n        navigation.querySelectorAll(`.${topLevelClassName}`)\n    );\n\n    topLevels.forEach((el) => {\n        const listItem = el.parentNode,\n            button = document.createElement('button'),\n            buttonDiv = document.createElement('div'),\n            srOpenCloseSpan = document.createElement('span'),\n            srNavigationSpan = document.createElement('span'),\n            toggleSection = createSectionToggle(button, closeAll, veil);\n\n        // LIs have tabindex so they're accessible with no JS, remove it\n        el.removeAttribute('tabindex');\n\n        button.setAttribute(aria.expanded, 'false');\n        button.setAttribute(aria.owns, el.nextElementSibling.id);\n        button.setAttribute('type', 'button');\n        button.id = el.nextElementSibling.id + '-button';\n        button.className = buttonClassName;\n\n        srOpenCloseSpan.className = openCloseTextClassName;\n        srOpenCloseSpan.appendChild(document.createTextNode(openText));\n\n        srNavigationSpan.className = navigationTextClassName;\n        srNavigationSpan.appendChild(document.createTextNode(navigationText));\n\n        button.addEventListener('click', () => toggleSection(), true);\n\n        appendAll(buttonDiv, [\n            srOpenCloseSpan,\n            document.createTextNode(' '),\n            el,\n            document.createTextNode(' '),\n            srNavigationSpan,\n        ]);\n        button.append(buttonDiv);\n        listItem.prepend(button);\n    });\n}\n\n/**\n * Add event listeners to top level buttons enabling shift-tabbing into the previous\n * section.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n * @param {function} closeAll - A function for closing all menus.\n * @param {HTMLElement} veil - The veiling element.\n */\nfunction setupTabPrevious(navigation, closeAll, veil) {\n    const firstButton = navigation.querySelector(\n            '.navigation--primary__level1:first-of-type > .navigation__button'\n        ),\n        restButtons = Array.from(\n            navigation.querySelectorAll(\n                '.navigation--primary__level1:not(:first-of-type) > .navigation__button'\n            )\n        );\n\n    // If we tab out of the open, first menu into the other header content, close the menu.\n    firstButton.addEventListener('keydown', (e) => {\n        if (\n            toBool(firstButton.getAttribute(aria.expanded)) &&\n            keyCodeTab === e.keyCode &&\n            e.shiftKey\n        ) {\n            closeAll();\n        }\n    });\n\n    restButtons.forEach((thisSectionButton) => {\n        const previousSection =\n                thisSectionButton.parentElement.previousElementSibling,\n            previousSectionButton = previousSection.querySelector('button'),\n            lastNavigationAnchor = previousSection.querySelector(\n                '.navigation__level2 > li:last-of-type > a'\n            )\n                ? previousSection.querySelector(\n                      '.navigation__level2 > li:last-of-type > a'\n                  )\n                : previousSection\n                      .querySelector('.navigation__level2 > li:last-of-type')\n                      .previousElementSibling.querySelector('a'),\n            togglePreviousSection = createSectionToggle(\n                previousSectionButton,\n                closeAll,\n                veil\n            );\n\n        thisSectionButton.addEventListener(\n            'keydown',\n            (e) => {\n                if (\n                    toBool(thisSectionButton.getAttribute(aria.expanded)) &&\n                    keyCodeTab === e.keyCode &&\n                    e.shiftKey\n                ) {\n                    e.preventDefault();\n\n                    togglePreviousSection();\n                    lastNavigationAnchor.focus();\n                }\n            },\n            true\n        );\n    });\n}\n\n/**\n * Add event listeners to the final anchor in each section allowing tabbing into\n * the next navigation section.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n * @param {function} closeAll - A function to close the entire menu.\n * @param {HTMLElement} veil - The veiling element.\n */\nfunction setupTabNext(navigation, closeAll, veil) {\n    const closeButton = navigation.querySelector(\n            '.navigation--primary__level1:last-of-type .wrapper--navigation--primary__menu__close button'\n        ),\n        restSectionsCloseButtons = Array.from(\n            navigation.querySelectorAll(\n                '.navigation--primary__level1:not(:last-of-type) .wrapper--navigation--primary__menu__close button'\n            )\n        );\n\n    // If we tab out of the open, first menu into the other header content, close the menu.\n    closeButton.addEventListener('keydown', (e) => {\n        if (\n            toBool(\n                closeButton\n                    .closest('.navigation--primary__level1')\n                    .querySelector('button')\n                    .getAttribute(aria.expanded)\n            ) &&\n            keyCodeTab === e.keyCode &&\n            !e.shiftKey\n        ) {\n            closeAll();\n        }\n    });\n\n    restSectionsCloseButtons.forEach((closeButton) => {\n        const nextSectionButton = closeButton\n                .closest('.navigation--primary__level1')\n                .nextElementSibling.querySelector('button'),\n            toggleNextSection = createSectionToggle(\n                nextSectionButton,\n                closeAll,\n                veil\n            );\n\n        closeButton.addEventListener(\n            'keydown',\n            (e) => {\n                if (keyCodeTab === e.keyCode && !e.shiftKey) {\n                    e.preventDefault();\n\n                    toggleNextSection();\n                    nextSectionButton\n                        .closest('.navigation--primary__level1')\n                        .querySelector(`.${headerClassName} a`)\n                        .focus();\n                }\n            },\n            true\n        );\n    });\n}\n\n/**\n * Wrap anchor text in spans for styling.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n */\nfunction prepareLowerLevels(navigation) {\n    Array.from(navigation.querySelectorAll('.navigation__level2 li')).forEach(\n        (navigationItem) => {\n            const link = navigationItem.querySelector('a'),\n                textWrapper = document.createElement('span');\n\n            textWrapper.appendChild(link.firstChild.cloneNode(true));\n            link.replaceChild(textWrapper, link.firstChild);\n        }\n    );\n}\n\n/**\n * Wrap header text in spans for styling.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n */\nfunction prepareHeaders(navigation) {\n    Array.from(navigation.querySelectorAll(`.${headerClassName}`)).forEach(\n        (header) => {\n            const link = header.querySelector('a'),\n                textWrapper = document.createElement('span');\n\n            if (!link) {\n                const currentPageWrapper = document.createElement('span'),\n                    linkText = header.firstChild.wholeText.trim() + ' overview';\n\n                textWrapper.appendChild(document.createTextNode(linkText));\n                currentPageWrapper.appendChild(textWrapper);\n                header.replaceChild(currentPageWrapper, header.firstChild);\n            } else {\n                textWrapper.innerText = link.innerText + ' overview';\n                link.replaceChild(textWrapper, link.firstChild);\n            }\n        }\n    );\n}\n\n/**\n * Add close buttons to menu sections.\n *\n * @param {HTMLElement} navigation\n */\nfunction addCloseButtons(navigation, closeAll) {\n    Array.from(\n        navigation.querySelectorAll('.navigation--primary__menu__content')\n    ).forEach((menu) => {\n        const header = menu.querySelector(`.${headerClassName}`),\n            closeButtonWrapper = document.createElement('div'),\n            closeButton = document.createElement('button'),\n            closeButtonDiv = document.createElement('div'),\n            closeButtonText = document.createElement('span'),\n            closeButtonIcon = document.createElement('span'),\n            text = 'Close ' + header.innerText.trim() + ' menu';\n\n        closeButtonText.appendChild(document.createTextNode(text));\n        closeButtonText.className = 'navigation--primary__menu__close__text';\n\n        closeButtonIcon.setAttribute(aria.hidden, 'true');\n        closeButtonIcon.className =\n            'fas fa-fw fa-times navigation--primary__menu__close__icon';\n\n        closeButtonWrapper.className =\n            'wrapper--navigation--primary__menu__close';\n\n        closeButton.className = 'navigation--primary__menu__close';\n\n        appendAll(closeButtonDiv, [closeButtonText, closeButtonIcon]);\n        closeButton.appendChild(closeButtonDiv);\n        closeButton.setAttribute('type', 'button');\n        closeButton.title = text;\n        closeButton.addEventListener('click', () => closeAll(), true);\n\n        closeButtonWrapper.appendChild(closeButton);\n\n        menu.appendChild(closeButtonWrapper);\n    });\n}\n\n/**\n * Transform the Matrix-generated navigation lists into an interactive menu.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n */\nfunction launchPrimaryNavigation(navigation) {\n    // During testing only: remove 'under construction' indicators globally\n    navigation.innerHTML = navigation.innerHTML\n        .replace(/\\(\\( /g, '')\n        .replace(/ \\)\\)/g, '');\n\n    const veil = document.createElement('div'),\n        closeAll = createCloseAll(navigation, veil);\n\n    veil.className = veilClassName;\n    veil.setAttribute(aria.hidden, 'true');\n    document\n        .querySelector('body')\n        .insertBefore(veil, document.querySelector('main'));\n\n    prepareTopLevel(navigation, veil, closeAll);\n    prepareLowerLevels(navigation, veil);\n    prepareHeaders(navigation);\n    addCloseButtons(navigation, closeAll);\n\n    // Allow tabbing from one section to another,\n    // and close when tabbing out of the navigation\n    setupTabPrevious(navigation, closeAll, veil);\n    setupTabNext(navigation, closeAll, veil);\n\n    // If the navigation is open, close on escape.\n    navigation.addEventListener(\n        'keydown',\n        (e) => {\n            if (\n                navigation.querySelector(\n                    `.${buttonClassName}[aria-expanded='true']`\n                ) &&\n                keyCodeEscape === e.keyCode\n            ) {\n                e.preventDefault();\n                closeAll();\n            }\n        },\n        true\n    );\n\n    // If the navigation is open, close it on click outside it.\n    window.addEventListener(\n        'click',\n        (e) => {\n            if (\n                navigation.querySelector(\n                    `.${buttonClassName}[aria-expanded='true']`\n                ) &&\n                !e.target.closest(`.${classNameSpecific}`)\n            ) {\n                closeAll();\n            }\n        },\n        true\n    );\n}\n\nexport default {\n    launchFn: launchPrimaryNavigation,\n    launchQuery: `.${classNameSpecific}`,\n};\n","/**\n * Secondary navigation\n *\n * @module patterns/navigation/navigation-secondary\n * @author Web Development\n * @copyright City, University of London 2019\n */\nimport {\n    prepareNavigation,\n    listenForNavigationToggles,\n} from '../menu/menu-formatters';\n\nconst className = 'navigation',\n    classNameSpecific = className + '--secondary';\n\n/**\n * Transform the Matrix-generated navigation lists into an interactive menu.\n *\n * @param {HTMLElement} navigation - The secondary navigation element.\n */\nfunction launchSecondaryNavigation(navigation) {\n    // During testing only: remove 'under construction' indicators globally\n    navigation.innerHTML = navigation.innerHTML\n        .replace(/\\(\\( /g, '')\n        .replace(/ \\)\\)/g, '');\n\n    prepareNavigation(navigation, className);\n    listenForNavigationToggles(navigation, className);\n}\n\nexport default {\n    launchFn: launchSecondaryNavigation,\n    launchQuery: `.${classNameSpecific}`,\n};\n","/**\n * Paginated list\n *\n * @module patterns/paginated-list/paginated-list\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport { pageClassName, addPagination } from '../pagination/pagination.js';\nimport { removeClass } from '../../util';\nimport aria from '../../aria-attributes.js';\n\nconst className = 'paginated-list',\n    minimumPage = 1,\n    defaultPage = 8,\n    maximumPage = 12;\n\n/**\n * Ensure the page size is within the defined range.\n *\n * @param {number} pageSizeSetting - The user-requested page size.\n * @returns {number} The validated page size.\n */\nfunction setPageSize(pageSizeSetting) {\n    if (pageSizeSetting < minimumPage) {\n        return minimumPage;\n    } else if (pageSizeSetting > maximumPage) {\n        return maximumPage;\n    } else {\n        return pageSizeSetting;\n    }\n}\n\n/**\n * Transform an (un)ordered list into a paginated list, preserving the numbering\n * of the original if set.\n *\n * If the element is not a list or there are too few items to paginate, clean\n * up the DOM and return without paginating.\n *\n * @param {HTMLUListElement|HTMLOListElement} list - An (un)ordered list element with the paginated-list class.\n */\nfunction launchPaginatedList(list) {\n    if (!(list.tagName === 'UL' || list.tagName === 'OL')) {\n        /**\n         * not a list, remove the classname\n         * to avoid conflicting styles then bail\n         */\n        removeClass(list, className, false);\n        return;\n    }\n\n    const pageSizeSetting = Number.parseInt(list.dataset.pagesize)\n            ? Number.parseInt(list.dataset.pagesize)\n            : defaultPage,\n        listItems = Array.from(list.children),\n        pageSize = setPageSize(pageSizeSetting);\n\n    if (listItems.length <= pageSize) {\n        /**\n         * list too short, doesn’t need pagination.\n         * remove the classname to avoid conflicting\n         * styles then bail\n         */\n        removeClass(list, className, false);\n        return;\n    }\n\n    const pages = [],\n        /** ordered lists can be reversed.\n         * if the original was reversed,\n         * all our sub-lists must be too\n         */\n        reversed =\n            list.tagName === 'OL' && list.hasAttribute('reversed')\n                ? true\n                : false,\n        /**\n         * the start attribute may be set,\n         * if not the start is either 1\n         * or the list length (if reversed)\n         */\n        start =\n            list.tagName === 'OL' && list.hasAttribute('start')\n                ? Number.parseInt(list.hasAttribute('start'))\n                : reversed\n                ? listItems.length\n                : 1;\n\n    list.setAttribute('role', 'presentation');\n\n    let pageNumber = 0,\n        pageItems = listItems.slice(0, pageSize);\n\n    /* loop through items while we can still make a page */\n    while (pageItems.length > 0) {\n        const page = document.createElement('li'),\n            newList =\n                list.tagName === 'UL'\n                    ? document.createElement('ul')\n                    : document.createElement('ol');\n\n        /**\n         * set start attribute and keep reversed attribute\n         * on ordered lists\n         */\n        if (list.tagName === 'OL') {\n            if (!reversed) {\n                newList.setAttribute('start', pageSize * pageNumber + start);\n            } else {\n                newList.setAttribute('start', start - pageSize * pageNumber);\n                newList.setAttribute('reversed', 'true');\n            }\n        }\n\n        /* move this page of items into the page and inner list */\n        pageItems.forEach((listItem) => newList.appendChild(listItem));\n        page.appendChild(newList);\n        page.className = pageClassName;\n        page.setAttribute('tabindex', -1);\n        page.setAttribute(aria.label, `Page ${pageNumber + 1}`);\n        pages.push(page);\n\n        /* try to fetch another page */\n        ++pageNumber;\n        pageItems = listItems.slice(\n            pageSize * pageNumber,\n            pageSize * pageNumber + pageSize\n        );\n    }\n\n    /* add the pages to the original list in bulk */\n    pages.forEach((page) => list.appendChild(page));\n    addPagination(list, listItems.length);\n}\n\nexport default {\n    launchFn: launchPaginatedList,\n    launchQuery: `.${className}`,\n};\n","/**\n * Pagination\n *\n * @module patterns/pagination/pagination\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport scroll from 'zenscroll';\nimport { removeClass, reduceMotion } from '../../util';\nimport aria from '../../aria-attributes';\n\nconst className = 'pagination',\n    pageClassName = 'page',\n    wrapperClassName = className + '__wrapper',\n    controlsClassName = className + '__controls',\n    controlsElementClassName = controlsClassName + '__element',\n    ellipsisClassName = controlsClassName + '__ellipsis',\n    buttonClassName = controlsClassName + '__button',\n    summaryClassName = className + '__summary',\n    nextPrevRegEx = new RegExp(`${buttonClassName}--(next|prev)`),\n    maximumButtonsToDisplay = 6,\n    oneSecond = 1000,\n    scrollDuration = reduceMotion() ? 0 : oneSecond,\n    minimumPagesRequiringEllipsis = 2;\n\n/**\n * Creates a function for enabling/disabling the next/previous page buttons when\n * there's nothing for them to do.\n *\n * @param {HTMLButtonElement} next - The next page button.\n * @param {HTMLButtonElement} prev - The previous page button.\n * @param {number} pageCount - The total number of pages in this paginated element.\n * @returns {Function} A function that will disable the next/previous buttons when there is no next/previous page.\n */\nfunction createToggleNextPrev(next, prev, pageCount) {\n    /***\n     * Disables the next/previous page buttons if there is no next/previous page\n     * relative to this page.\n     *\n     * @param {number} pageNumber - The current page number.\n     */\n    const toggleNextPrev = (pageNumber) => {\n        pageCount === pageNumber\n            ? next.setAttribute('disabled', 'true')\n            : next.removeAttribute('disabled');\n\n        1 === pageNumber\n            ? prev.setAttribute('disabled', 'true')\n            : prev.removeAttribute('disabled');\n    };\n    return toggleNextPrev;\n}\n\n/**\n * Calculate proximity to current page, so we can hide extraneous buttons.\n *\n * @param {number} pageCount - The total number of pages in this paginated element.\n * @param {HTMLButtonElement[]} controls - An array of control buttons.\n * @param {number} pageNumber - The number of the current page.\n */\nfunction setProximity(pageCount, controls, pageNumber) {\n    if (pageCount > maximumButtonsToDisplay) {\n        controls.forEach(function (button) {\n            if (!button.className.match(nextPrevRegEx)) {\n                const buttonNumber = Number.parseInt(button.dataset.page);\n                button.dataset.proximity = buttonNumber - pageNumber;\n            }\n        });\n    }\n}\n\n/**\n * Set the attributes to make a page button (un)selected.\n *\n * @param {HTMLButtonElement} button - The button element.\n * @param {boolean} selected - Should the button indicated selection?\n */\nfunction toggleButton(button, selected) {\n    button.setAttribute(aria.expanded, selected);\n    selected\n        ? button.setAttribute('disabled', 'true')\n        : button.removeAttribute('disabled');\n    selected\n        ? button.setAttribute(aria.current, 'page')\n        : button.removeAttribute(aria.current);\n}\n\n/**\n * 'Close' all pages and mark all buttons as not selected.\n *\n * @param {HTMLElement[]} pages - An array of page elements.\n * @param {HTMLButtonElement[]} controls - An array of control buttons.\n */\nfunction closeAll(pages, controls) {\n    pages.forEach((page) => (page.dataset.open = false));\n    controls.forEach(function (button) {\n        if (!button.className.match(nextPrevRegEx)) {\n            toggleButton(button, false);\n        }\n    });\n}\n\n/**\n * Create a function that, given a page number, sets the page to be open and\n * optionally scrolls it into view.\n *\n * @param {HTMLElement[]} pages - The pages of this paginated element.\n * @param {HTMLElement} controls - The nav element containing the pagination control buttons.\n * @param {Function} toggleNextPrev - A function to enable/disable the next/previous page buttons when appropriate.\n * @returns {Function} A function for opening a given page number and optionally scrolling it into view.\n */\nfunction createOpenPage(pages, controls, toggleNextPrev) {\n    /**\n     * Open a given page number and optionally scroll it into view.\n     *\n     * @param {number} pageNumber - The number of the page to open.\n     * @param {boolean} [focus] - Focus the newly-opened page? Defaults to false.\n     * @param {boolean} [scrollTo] - Scroll to the top of the newly-opened page? Defaults to false.\n     */\n    const openPage = (pageNumber, focus, scrollTo) => {\n        const pagesArray = Array.from(\n                pages.querySelectorAll(`.${pageClassName}`)\n            ),\n            controlsArray = Array.from(controls.querySelectorAll('button'));\n        closeAll(pagesArray, controlsArray);\n        const page = pages.querySelector(\n                `.${pageClassName}:nth-of-type(${pageNumber})`\n            ),\n            button = controls.querySelector(`[data-page=\"${pageNumber}\"]`);\n        setProximity(pagesArray.length, controlsArray, pageNumber);\n        toggleNextPrev(pageNumber);\n        page.dataset.open = true;\n        toggleButton(button, true);\n        focus && page.focus();\n        scrollTo && scroll.to(page, scrollDuration);\n    };\n    return openPage;\n}\n\n/**\n * Create a function that will respond to a next or previous button click.\n *\n * @param {HTMLElement} controls - The controls container.\n * @param {Function} newPageFn - A function that, given the current page number, returns the page number to open.\n * @param {Function} openPage - A function that, given a page number, opens the page and optionally scrolls it into view.\n * @returns {Function} A function to respond to next/previous button clicks.\n */\nfunction createNextPrevOpenPage(controls, newPageFn, openPage) {\n    /**\n     * Returns a function that responds to next/previous button clicks.\n     */\n    const nextPrevOpenPage = () => {\n        const currentPage = Number.parseInt(\n            controls.querySelector(`[${aria.expanded}=\"true\"]`).dataset.page\n        );\n        openPage(newPageFn(currentPage), true, false);\n    };\n    return nextPrevOpenPage;\n}\n\n/**\n * Create and set summary text for a paginated element.\n *\n * @param {HTMLParagraphElement} summary - The element to transform into a summary.\n * @param {number} pageCount - The number of pages in the paginated element.\n * @param {number} [itemCount] - Optionally, the total number of items across all pages.\n */\nfunction setSummaryText(summary, pageCount, itemCount) {\n    let summaryText = `${pageCount} pages)`;\n    if (itemCount && Number.parseInt(itemCount)) {\n        summaryText = `(${itemCount} items on ` + summaryText;\n    } else {\n        summaryText = '(' + summaryText;\n    }\n    summary.appendChild(document.createTextNode(summaryText));\n}\n\n/**\n * Sets attributes and adds listeners to the next/previous page buttons.\n *\n * @param {HTMLButtonElement} next - The next page button element.\n * @param {HTMLButtonElement} prev - The previous page button element.\n * @param {HTMLElement} controls - The controls container element.\n * @param {number} pageCount - The total number of pages in the paginated element.\n * @param {Function} openPage - A function that, given a page number, opens the page and optionally scrolls it into view.\n */\nfunction prepareNextPrev(next, prev, controls, pageCount, openPage) {\n    [\n        {\n            button: next,\n            class: buttonClassName + '--next',\n            text: 'Next page',\n            newPageFn: (pageNumber) => pageNumber < pageCount && pageNumber + 1,\n        },\n        {\n            button: prev,\n            class: buttonClassName + '--prev',\n            text: 'Previous page',\n            newPageFn: (pageNumber) => pageNumber > 1 && pageNumber - 1,\n        },\n    ].forEach((button) => {\n        const btn = button.button,\n            btnSpan = document.createElement('span');\n\n        btn.className = button.class;\n        btn.setAttribute('type', 'button');\n        btnSpan.appendChild(document.createTextNode(button.text));\n        btn.appendChild(btnSpan);\n        btn.addEventListener(\n            'click',\n            createNextPrevOpenPage(controls, button.newPageFn, openPage),\n            true\n        );\n    });\n}\n\n/**\n * Create a new page select button.\n *\n * @param {number} pageNumber - The page that this button is for.\n * @param {number} totalPages - The total number of pages in the paginated element.\n * @returns {HTMLButtonElement} A new button element.\n */\nfunction createPageButton(pageNumber, totalPages) {\n    const button = document.createElement('button'),\n        buttonSpan = document.createElement('span');\n    buttonSpan.appendChild(document.createTextNode(pageNumber));\n    button.dataset.page = pageNumber;\n    button.setAttribute('type', 'button');\n    button.setAttribute(aria.label, `Open page ${pageNumber}`);\n\n    if (totalPages - pageNumber === 1) {\n        button.className = `${controlsElementClassName} ${buttonClassName} ${buttonClassName}--penultimate`;\n    } else if (totalPages === pageNumber) {\n        button.className = `${controlsElementClassName} ${buttonClassName} ${buttonClassName}--last`;\n    } else {\n        button.className = `${controlsElementClassName} ${buttonClassName}`;\n    }\n\n    button.appendChild(buttonSpan);\n    return button;\n}\n\n/**\n * Adds pagination controls to an element containing two or more page elements.\n *\n * e.g.\n *\n * <div class=\"pagination\">\n * <div class=\"page\">Page 1 content</div>\n * <div class=\"page\">Page 2 content</div>\n * </div>\n *\n * @param {HTMLElement} elem - The element to paginate.\n * @param {number} [itemCount] - Optionally, the total number of items on all pages combined.\n */\nfunction addPagination(elem, itemCount) {\n    const wrapper = document.createElement('div'),\n        pages = Array.from(elem.querySelectorAll(`.${pageClassName}`)),\n        controls = document.createElement('nav'),\n        next = document.createElement('button'),\n        prev = document.createElement('button'),\n        pageButtons = [],\n        summary = document.createElement('p'),\n        toggleNextPrev = createToggleNextPrev(next, prev, pages.length),\n        openPage = createOpenPage(elem, controls, toggleNextPrev),\n        ellipsisFirst = document.createElement('span'),\n        ellipsisFirstInner = document.createElement('span'),\n        ellipsisLast = document.createElement('span'),\n        ellipsisLastInner = document.createElement('span');\n\n    if (!pages.length > 1) {\n        /**\n         * too few pages, doesn’t need pagination.\n         * remove the classname to avoid conflicting\n         * styles then bail\n         */\n        removeClass(elem, className, false);\n        return;\n    }\n\n    ellipsisFirst.className = `${controlsElementClassName} ${ellipsisClassName} ${ellipsisClassName}--first`;\n    ellipsisFirstInner.innerText = '…';\n    ellipsisFirst.appendChild(ellipsisFirstInner);\n    ellipsisLast.className = `${controlsElementClassName} ${ellipsisClassName} ${ellipsisClassName}--last`;\n    ellipsisLastInner.innerText = '…';\n    ellipsisLast.appendChild(ellipsisLastInner);\n\n    prepareNextPrev(next, prev, controls, pages.length, openPage);\n\n    pageButtons.push(prev);\n    for (let pageNumber = 1; pageNumber <= pages.length; pageNumber++) {\n        const pageButton = createPageButton(pageNumber, pages.length);\n        pageButton.addEventListener('click', () =>\n            openPage(pageNumber, true, false)\n        );\n\n        if (\n            pages.length > minimumPagesRequiringEllipsis &&\n            pageNumber === pages.length\n        ) {\n            pageButtons.push(ellipsisLast);\n        }\n\n        pageButtons.push(pageButton);\n\n        if (pages.length > minimumPagesRequiringEllipsis && pageNumber === 1) {\n            pageButtons.push(ellipsisFirst);\n        }\n    }\n    pageButtons.push(next);\n\n    wrapper.className = wrapperClassName;\n    controls.className = controlsClassName;\n    controls.dataset.pagecount = pages.length;\n    controls.setAttribute(aria.label, 'Pagination');\n    summary.className = summaryClassName;\n    setSummaryText(summary, pages.length, itemCount);\n\n    elem.parentNode.replaceChild(wrapper, elem);\n    wrapper.appendChild(elem);\n    pageButtons.forEach((pageButton) => controls.appendChild(pageButton));\n    openPage(1, false, false);\n\n    wrapper.appendChild(controls);\n    wrapper.appendChild(summary);\n}\n\nexport { addPagination, pageClassName };\n\nexport default {\n    launchFn: addPagination,\n    launchQuery: `.${className}`,\n};\n","/**\n * Show-more\n *\n * @module patterns/show-more/show-more\n * @author Web Development\n * @copyright City, University of London 2018-2019\n */\nimport scroll from 'zenscroll';\nimport aria from '../../aria-attributes';\nimport { reduceMotion, toBool, verticallyInWindow } from '../../util';\n\nconst className = 'show-more',\n    oneSecond = 1000,\n    scrollDuration = reduceMotion() ? 0 : oneSecond,\n    scrollTo = true;\n\n/**\n * Open or close the show-more element.\n *\n * @param {object} showMore - The show-more element\n */\nfunction toggleShowMore(showMore) {\n    const firstHeadingElement = showMore.querySelector(\n            '.show-more__heading, h2, h3, h4, h5, h6'\n        ),\n        contentElement = showMore.querySelector('.show-more__text'),\n        showMoreAnchorLinkText = showMore.querySelector(\n            '.show-more__link-text'\n        ),\n        hiddenElement = toBool(contentElement.dataset.hidden);\n\n    if (hiddenElement) {\n        showMore.dataset.open = true;\n        contentElement.dataset.hidden = false;\n        showMoreAnchorLinkText.textContent = 'Show less';\n    } else {\n        showMore.dataset.open = false;\n        contentElement.dataset.hidden = true;\n        showMoreAnchorLinkText.textContent = 'Show more';\n    }\n\n    if (firstHeadingElement && !verticallyInWindow(firstHeadingElement)) {\n        scrollTo && scroll.to(firstHeadingElement, scrollDuration);\n    }\n}\n\n/**\n * create 'show-more' button in the following HTML structure then append it to '.show-more' HTML element\n * <div class=\"show-more__button__container\">\n *  <span class=\"show-more__button\">\n *    <a href=\"\">\n *      <span class=\"icon fal fa-plus-circle\" aria-hidden=\"true\"></span>\n *      <span class=\"icon fal fa-minus-circle\" aria-hidden=\"true\"></span>\n *      <span class=\"show-more__link-text\">Show more</span>\n *      <span class=\"sr-only\"> about the {[data]=title} </span>\n *    </a>\n *  </span>\n * </div>\n *\n * @param {HTMLElement} showMoreElement - HTML parent element with classname 'show-more'\n */\nfunction createShowMoreButton(showMoreElement) {\n    const showMoreButtonDiv = document.createElement('div'),\n        showMoreButtonSpan = document.createElement('span'),\n        showMoreButton = document.createElement('button'),\n        icon = document.createElement('span'),\n        showMoreText = document.createElement('span'),\n        dataTitle = showMoreElement.getAttribute('data-title'),\n        srTextElement = document.createElement('span');\n\n    showMoreButtonDiv.classList.add('show-more__button__container');\n    showMoreButtonSpan.classList.add('show-more__button');\n    showMoreButtonDiv.appendChild(showMoreButtonSpan);\n\n    showMoreButton.setAttribute('type', 'button');\n    showMoreButton.addEventListener('click', () =>\n        toggleShowMore(showMoreElement)\n    );\n\n    showMoreButtonSpan.appendChild(showMoreButton);\n\n    icon.classList.add('icon');\n    icon.classList.add('fal');\n    icon.setAttribute(aria.hidden, true);\n\n    showMoreText.classList.add('show-more__link-text');\n    showMoreText.appendChild(document.createTextNode('Show more'));\n\n    srTextElement.appendChild(document.createTextNode('about ' + dataTitle));\n    srTextElement.classList.add('sr-only');\n\n    showMoreButton.appendChild(icon);\n    showMoreButton.appendChild(showMoreText);\n    showMoreButton.appendChild(srTextElement);\n\n    showMoreElement.appendChild(showMoreButtonDiv);\n}\n\n/**\n * Initial function on page load; it hides text container of 'show-more' DOM\n * element, and creates the controlling button.\n *\n * @param {HTMLElement} showMoreElement - HTML parent element with classname 'show-more'\n */\nfunction showMore(showMoreElement) {\n    const showMoreTextElements = showMoreElement.querySelectorAll(\n        '.show-more__text'\n    );\n\n    showMoreTextElements.forEach((element) => {\n        element.dataset.hidden = true;\n    });\n\n    createShowMoreButton(showMoreElement);\n}\n\nexport default {\n    launchFn: showMore,\n    launchQuery: `.${className}`,\n};\n","/**\n * Responsive Slider\n *\n * @module patterns/slider-responsive/slider-responsive\n * @author Mark Skinsley <mark.skinsley@city.ac.uk>\n * @copyright City, University of London 2019\n */\n\nimport { removeClass, createHTMLElement } from '../../util';\nconst className = 'slider-responsive';\nlet sliderChildren, sliderChildrenLength, updatedPosition;\n\n/**\n * The number of items to display on each slide.\n *\n * @param {Number} sliderIncrement - Amount to increase/decrease visible listing index number.\n * @param {Number} currentPosition - Index number of first item to be visible.\n * @param {String} sliderDirection - Increase or decrease visible index number.\n * @param {Element} slider - The slider.\n */\nfunction itemsDisplay(\n    sliderIncrement,\n    currentPosition,\n    sliderDirection,\n    slider\n) {\n    // Show next, or previous, group of listings based on button's slider direction\n    sliderDirection === 'forward'\n        ? (updatedPosition = parseInt(currentPosition + sliderIncrement))\n        : (updatedPosition = parseInt(currentPosition - sliderIncrement));\n\n    // Prevent updated index position dropping below 1\n    updatedPosition < 1 ? (updatedPosition = 1) : null;\n\n    let items = slider.querySelectorAll('li');\n\n    /**\n     * Loop through all slides, adding data-device attributes to items based on their\n     * position within the list. The CSS will target what to show/hide at different breakpoints.\n     * You will end up with HTML similar to the following:\n     *\n     * <li data-device=\"mobile\"></li>\n     * <li data-device=\"tablet\"></li>\n     * <li data-device=\"desktop\"></li>\n     */\n    for (let i = 0; i < items.length; i++) {\n        // Check item exists before adding data attribute to prevent errors\n        items[i].getAttribute('data-device')\n            ? items[i].removeAttribute('data-device')\n            : null;\n        items[updatedPosition - 1]\n            ? items[updatedPosition - 1].setAttribute('data-device', 'mobile')\n            : null;\n        items[updatedPosition]\n            ? items[updatedPosition].setAttribute('data-device', 'tablet')\n            : null;\n        items[updatedPosition + 1]\n            ? items[updatedPosition + 1].setAttribute('data-device', 'desktop')\n            : null;\n    }\n}\n\n/**\n * Determines controller's behaviour, i.e. what slide the user is currently at within the\n * items list. Depending on the slider increment and the total number of items, the total\n * slides number adjusts too.\n *\n * For example, by default a grouping with 5 items will show as '1/2' on desktop, as this\n * viewport has an increment of 3 and there are effectively 2 slides at this point. However,\n * if user is at position 2, this will update to read '2/3'.\n *\n * This function updates all 3 controllers concurrently, updating their values indepenently.\n *\n * @param {Number} sliderIncrement - Amount to increase/decrease visible listing index number.\n * @param {Number} currentPosition - Index number of first item to be visible.\n * @param {String} sliderDirection - Increase or decrease visible index number.\n * @param {Element} slider - The slider.\n */\nfunction progressUpdate(\n    sliderIncrement,\n    currentPosition,\n    sliderDirection,\n    slider\n) {\n    let controlWraps = slider.querySelectorAll('.slider__controls__wrap');\n    for (const controlWrap of controlWraps) {\n        // Increase/decrease progrees indicator based on button click.\n        if (sliderDirection === 'forward') {\n            updatedPosition = currentPosition + sliderIncrement;\n        }\n        if (\n            sliderDirection === 'back' &&\n            currentPosition - sliderIncrement >= 1\n        ) {\n            updatedPosition = currentPosition - sliderIncrement;\n        }\n        if (\n            sliderDirection === 'back' &&\n            currentPosition - sliderIncrement < 1\n        ) {\n            updatedPosition = 1;\n        }\n        controlWrap.setAttribute('data-currentposition', updatedPosition);\n    }\n\n    // Update properties on all controls, not just the active control\n    for (const control of controlWraps) {\n        control.setAttribute('data-currentposition', updatedPosition);\n        sliderIncrement = control.getAttribute('data-increment');\n        let currentGroup = updatedPosition / sliderIncrement;\n        let progressIndicator = control.querySelector(\n            '.slide__controls__progress__active'\n        );\n\n        let totalSlides = parseInt(control.getAttribute('data-slides'));\n        let totalSlidesDisplay = control.querySelector(\n            '.slide__controls__progress__total'\n        );\n\n        /**\n         * Check if there is a remainder when dividing the current listing position by it's controller's\n         * increment. If there is, increase progress indicator and total slides by 1.\n         */\n        let firstInGroup = false;\n        if ((updatedPosition - 1) % sliderIncrement === 0) {\n            firstInGroup = true;\n        }\n\n        // If index position not first in group\n        if (!firstInGroup) {\n            // Increase group position by 1 to account for extra slide\n            currentGroup += 1;\n            // Not within final group of items and has a remainder -> add slide\n            if (\n                sliderChildrenLength - updatedPosition >= sliderIncrement &&\n                updatedPosition < sliderChildrenLength &&\n                (sliderChildrenLength - 1) % sliderIncrement !== 0\n            ) {\n                totalSlides += 1;\n                totalSlidesDisplay.textContent = totalSlides;\n                // Not within final group of items and has no remainder -> don't add slide\n            } else if (\n                sliderChildrenLength - updatedPosition >= sliderIncrement &&\n                updatedPosition < sliderChildrenLength &&\n                (sliderChildrenLength - 1) % sliderIncrement === 0\n            ) {\n                totalSlidesDisplay.textContent = totalSlides;\n                // Within final group and only one slide in group -> add slide\n            } else if (\n                sliderChildrenLength - updatedPosition < sliderIncrement &&\n                totalSlides === 1\n            ) {\n                totalSlides += 1;\n                totalSlidesDisplay.textContent = totalSlides;\n                currentGroup = totalSlides;\n            }\n            // First in group and ndex position is 1 -> don't add slide\n        } else if (\n            sliderChildrenLength === sliderIncrement &&\n            updatedPosition === 1\n        ) {\n            totalSlidesDisplay.textContent = totalSlides;\n        }\n\n        /**\n         * If increment increase exceeds total slides' length, limit the current\n         * position value to the total slides' length. This can happen when\n         * clicking on desktop viewport and reducing screen size to tablet or\n         * mobile.\n         */\n        if (currentGroup > totalSlides) {\n            control.setAttribute('data-currentposition', totalSlides);\n        } else {\n            progressIndicator.textContent = Math.ceil(currentGroup);\n        }\n\n        // Disable control buttons if at start or end of items in slider.\n        if (Math.ceil(currentGroup) >= totalSlides) {\n            control\n                .querySelector('.slider__controls__buttons__next')\n                .setAttribute('disabled', true);\n        } else {\n            control\n                .querySelector('.slider__controls__buttons__next')\n                .removeAttribute('disabled');\n        }\n        if (Math.ceil(currentGroup) <= 1) {\n            control\n                .querySelector('.slider__controls__buttons__prev')\n                .setAttribute('disabled', true);\n        } else {\n            control\n                .querySelector('.slider__controls__buttons__prev')\n                .removeAttribute('disabled');\n        }\n    }\n}\n\n/**\n * Turn a group of list items into a responsive slider where, depending on viewport, the number of visible items\n * at any one time, varies. This pattern is designed to accommodate up to three items per slide.\n *\n * @param {HTMLElement} slider - The slider.\n */\nfunction launchResponsiveSlider(slider) {\n    // Slider items count\n    sliderChildren = [...slider.children];\n    sliderChildrenLength = sliderChildren.length;\n\n    // Disable responsive slider if less than 2 items exists\n    if (sliderChildrenLength < 2) {\n        removeClass(slider, className, false);\n        return;\n    }\n\n    for (const sliderChild of sliderChildren.entries()) {\n        sliderChild[1].classList.add('slider__slide');\n        let items = slider.querySelectorAll('li');\n\n        /**\n         * Add data attribute to first three listings. This will control what is visible on load,\n         * depending on device type.\n         **/\n        for (let i = 0; i <= 2 || i < sliderChildrenLength; i++) {\n            items[0] ? items[0].setAttribute('data-device', 'mobile') : null;\n            items[1] ? items[1].setAttribute('data-device', 'tablet') : null;\n            items[2] ? items[2].setAttribute('data-device', 'desktop') : null;\n        }\n    }\n\n    /**\n     * Builds slider controls.\n     * @param {String} deviceType\n     * @param {Number} increment\n     * @param {Number} currentPosition\n     */\n    function buildControls(deviceType, increment, currentPosition) {\n        let slides = Math.ceil(sliderChildrenLength / increment);\n        let sliderControlsWrap = createHTMLElement('div', [\n            { label: 'class', val: 'slider__controls__wrap' },\n            { label: 'data-device', val: deviceType },\n            { label: 'data-increment', val: increment },\n            { label: 'data-currentPosition', val: currentPosition },\n            { label: 'data-length', val: sliderChildrenLength },\n            { label: 'data-slides', val: slides },\n        ]);\n        let sliderControls = createHTMLElement('div', [\n            { label: 'class', val: 'slider__controls' },\n        ]);\n        let sliderProgress = createHTMLElement('div', [\n            { label: 'class', val: 'slider__controls__progress' },\n        ]);\n        let sliderButtons = createHTMLElement('div', [\n            { label: 'class', val: 'slider__controls__buttons' },\n        ]);\n        // Slider progress\n        sliderProgress.appendChild(\n            createHTMLElement('span', [\n                { label: 'content', val: '1' },\n                { label: 'class', val: 'slide__controls__progress__active' },\n            ])\n        );\n        sliderProgress.appendChild(\n            createHTMLElement('span', [\n                { label: 'content', val: '/' },\n                { label: 'class', val: 'slide__controls__progress__separator' },\n            ])\n        );\n        // Total slides display\n        sliderProgress.appendChild(\n            createHTMLElement('span', [\n                {\n                    label: 'content',\n                    val: Math.ceil(sliderChildrenLength / increment),\n                },\n                { label: 'class', val: 'slide__controls__progress__total' },\n            ])\n        );\n        // Next / previous buttons\n        sliderButtons.appendChild(\n            createHTMLElement('button', [\n                { label: 'aria-label', val: 'Previous item' },\n                { label: 'disabled', val: true },\n                {\n                    label: 'class',\n                    val:\n                        'fas fa-arrow-left slider__controls__buttons__prev swiper-slider-arrow arrow-left--btn-prev',\n                },\n            ])\n        );\n\n        // If slider children items is equal to slider increment, disable next button by default.\n        if (sliderChildrenLength === increment) {\n            sliderButtons.appendChild(\n                createHTMLElement('button', [\n                    { label: 'aria-label', val: 'Next item' },\n                    {\n                        label: 'class',\n                        val:\n                            'fas fa-arrow-right slider__controls__buttons__next swiper-slider-arrow arrow-left--btn-next',\n                    },\n                    { label: 'disabled', val: true },\n                ])\n            );\n        } else {\n            sliderButtons.appendChild(\n                createHTMLElement('button', [\n                    { label: 'aria-label', val: 'Next item' },\n                    {\n                        label: 'class',\n                        val:\n                            'fas fa-arrow-right slider__controls__buttons__next swiper-slider-arrow arrow-left--btn-next',\n                    },\n                ])\n            );\n        }\n\n        sliderControlsWrap\n            .appendChild(sliderControls)\n            .appendChild(sliderProgress);\n        slider.appendChild(sliderControlsWrap);\n        sliderControls.appendChild(sliderButtons);\n        slider\n            .querySelectorAll('.slider__controls__buttons__prev')[0]\n            .classList.add('slider__controls__buttons__disabled');\n    }\n\n    // Build each type of controller (mobile, tablet, desktop)\n    sliderChildrenLength > 1 ? buildControls('mobile', 1, 1, false) : null;\n    sliderChildrenLength >= 2 ? buildControls('tablet', 2, 1, false) : null;\n    sliderChildrenLength >= 3 ? buildControls('desktop', 3, 1, false) : null;\n\n    let controlWraps = slider.querySelectorAll('.slider__controls__wrap');\n    /**\n     * For each instance of the controls, update the current position data attribute when next previous/buttons\n     * are selected. This means if the viewport changes, the correct value is passed to each control.\n     */\n    for (const controlWrap of controlWraps) {\n        let nextBtn = controlWrap.querySelector(\n            '.slider__controls__buttons__next'\n        );\n\n        /**\n         * Slide content display. Isolate event listener to specific controller clicked. This is needed\n         * to apply data attributes to the correct listings regardless of which controller is clicked.\n         */\n        nextBtn.addEventListener('click', () => {\n            //Get data attribute values from specific controller clicked.\n            let parentWrapper = nextBtn.closest('.slider__controls__wrap');\n            let sliderIncrement = parseInt(\n                parentWrapper.getAttribute('data-increment')\n            );\n            let currentPosition = parseInt(\n                parentWrapper.getAttribute('data-currentposition')\n            );\n            let sliderDirection = 'forward';\n            itemsDisplay(\n                sliderIncrement,\n                currentPosition,\n                sliderDirection,\n                slider\n            );\n        });\n\n        // Controller display. When user clicks, update each slider's progress indicator.\n        controlWrap\n            .querySelector('.slider__controls__buttons__next')\n            .addEventListener('click', () => {\n                let currentPosition = parseInt(\n                    controlWrap.getAttribute('data-currentposition')\n                );\n                let sliderIncrement = parseInt(\n                    controlWrap.getAttribute('data-increment')\n                );\n                progressUpdate(\n                    sliderIncrement,\n                    currentPosition,\n                    'forward',\n                    slider\n                );\n            });\n\n        let prevBtn = controlWrap.querySelector(\n            '.slider__controls__buttons__prev'\n        );\n\n        /**\n         * Slide content display. Isolate event listener to specific controller clicked. This is needed\n         * to apply data attributes to the correct listings regardless of which controller is clicked.\n         */\n        prevBtn.addEventListener('click', () => {\n            //Get data attribute values from specific controller clicked.\n            let parentWrapper = prevBtn.closest('.slider__controls__wrap');\n            let sliderIncrement = parseInt(\n                parentWrapper.getAttribute('data-increment')\n            );\n            let currentPosition = parseInt(\n                parentWrapper.getAttribute('data-currentposition')\n            );\n            let sliderDirection = 'back';\n            itemsDisplay(\n                sliderIncrement,\n                currentPosition,\n                sliderDirection,\n                slider\n            );\n        });\n\n        // Update all controllers' values accordingly\n        controlWrap\n            .querySelector('.slider__controls__buttons__prev')\n            .addEventListener('click', () => {\n                let currentPosition = parseInt(\n                    controlWrap.getAttribute('data-currentposition')\n                );\n                let sliderIncrement = parseInt(\n                    controlWrap.getAttribute('data-increment')\n                );\n                progressUpdate(\n                    sliderIncrement,\n                    currentPosition,\n                    'back',\n                    slider\n                );\n            });\n    }\n}\n\nexport default {\n    launchFn: launchResponsiveSlider,\n    launchQuery: `.${className}`,\n};\n","/**\n * 'dot' style counter customisation for global slider\n *\n * @module patterns/slider/slider/custom_counter\n * @author Web Development\n * @copyright City, University of London 2020\n */\n\nimport { createHTMLElement } from '../../../util';\nimport aria from '../../../aria-attributes';\n\n/**\n * Creates HTML elements for the control buttons (called only if type = 'dot')\n *\n * @param {HTMLElement} slider - an HTML element with the slider class\n * @param {string} sliderType - type of slider - determines how many elements need to be visible on page load\n * @param {HTMLElement} wrapper - parent-wrapper HTML of buttons\n * @param {object} sliderObject - holds values for each slider type to be able to set slider behaviour\n */\nexport function createSliderDot(slider, sliderType, wrapper, sliderObject) {\n    let slidesTotal = sliderObject[sliderType].totalPages;\n    wrapper.classList.add('slider-block__control__buttons--dot');\n\n    for (let i = 0; i < slidesTotal; i++) {\n        let dot = createHTMLElement('button', [\n            { label: 'data-page', val: i },\n            { label: 'aria-label', val: `Open slide ${i + 1}` },\n            { label: 'type', val: 'button' },\n        ]);\n\n        if (i === 0) {\n            dot.setAttribute(aria.current, 'slide');\n            dot.setAttribute(aria.expanded, 'true');\n            dot.setAttribute('disabled', 'true');\n        } else {\n            dot.setAttribute(aria.expanded, 'false');\n        }\n\n        dot.addEventListener('click', function () {\n            dotEvent(this, slider, wrapper);\n        });\n\n        wrapper.appendChild(dot);\n    }\n}\n\n/**\n * Event listener added to control buttons (if control type is 'dot')\n *\n * @param {HTMLElement} dot - HTML element the event listener is attached to\n * @param {HTMLElement} slider - an HTML element with the slider class\n * @param {HTMLElement} parent - parent-wrapper HTML element of buttons (dots)\n */\nexport function dotEvent(dot, slider, parent) {\n    let dots = parent.querySelectorAll('button'),\n        slides = [...slider.children],\n        active = dot.getAttribute('data-page');\n\n    dots.forEach((el) => {\n        el.removeAttribute('disabled');\n        el.removeAttribute(aria.expanded, 'false');\n        el.removeAttribute(aria.current, 'slide');\n    });\n\n    dot.setAttribute('disabled', true);\n    dot.setAttribute(aria.current, 'slide');\n    dot.setAttribute(aria.expanded, 'true');\n\n    slides.forEach((el) => {\n        el.setAttribute('data-visible', false);\n        if (active === el.getAttribute('data-page')) {\n            el.setAttribute('data-visible', true);\n            el.focus();\n        }\n    });\n}\n","/**\n * Global slider\n *\n * @module patterns/slider/slider\n * @author Web Development\n * @copyright City, University of London 2020\n */\n\nimport { arraySlicer, createHTMLElement, removeClass } from '../../util';\nimport { createSliderDot, dotEvent } from './custom_counter/slider_dot_counter';\n\nimport aria from '../../aria-attributes';\nimport { swipeCal } from '../image-carousel/swipe';\n\nconst className = 'slider';\n\n/**\n * initial function that creates an object called sliderObject, this object will hold the necessary parameters to create the right\n * behaviour for each slider customisation types\n * it also calls 3 further functions: setVisibility() createProgressTracker() createSliderButton()\n *\n * @param {HTMLElement} slider - an HTML element with the slider class.\n *\n */\nfunction launchSlider(slider) {\n    const sliderChildren = [...slider.children],\n        totalItems = sliderChildren.length,\n        perPageTablet = 2, // if this needs to be customisable in the future then it could come from a data attribute with set default values\n        perPageDesk = 3,\n        maxTablet = Math.ceil(totalItems / perPageTablet),\n        maxDesk = Math.ceil(totalItems / perPageDesk);\n\n    const sliderObject = {\n        default: {\n            totalPages: totalItems,\n            endPosition: totalItems - 1,\n            maxItem: 1,\n            pageAttr: 'data-page',\n            visAttr: 'data-visible',\n            counterAttr: 'data-currentdefault',\n            tabIndex: 'tabindex',\n            ariaLabel: 'aria-label',\n        },\n        mobile: {\n            totalPages: totalItems,\n            endPosition: totalItems - 1,\n            maxItem: 1,\n            pageAttr: 'data-page',\n            visAttr: 'data-visible',\n            counterAttr: 'data-currentdefault',\n            tabIndex: 'tabindex',\n            ariaLabel: 'aria-label',\n        },\n        tablet: {\n            totalPages: maxTablet,\n            endPosition: maxTablet - 1,\n            maxItem: perPageTablet,\n            pageAttr: 'data-pagetablet',\n            visAttr: 'data-visibletablet',\n            counterAttr: 'data-currenttablet',\n            tabIndex: 'tabindex',\n            ariaLabel: 'aria-label',\n        },\n        desk: {\n            totalPages: maxDesk,\n            endPosition: maxDesk - 1,\n            maxItem: perPageDesk,\n            pageAttr: 'data-pagedesk',\n            visAttr: 'data-visibledesk',\n            counterAttr: 'data-currentdesk',\n            tabIndex: 'tabindex',\n            ariaLabel: 'aria-label',\n        },\n    };\n\n    if (totalItems < 2) {\n        removeClass(slider, className, false);\n        return true;\n    }\n\n    let sliderType = slider.getAttribute('data-type'),\n        sliderControl = slider.getAttribute('data-control'),\n        sliderProgress = slider.getAttribute('data-progress');\n\n    if (!sliderType) {\n        sliderType = 'default';\n    }\n\n    if (!sliderControl) {\n        sliderControl = 'default';\n    }\n\n    if (!sliderProgress) {\n        sliderProgress = 'default';\n    }\n\n    let wrapper = createHTMLElement('div', [\n        { label: 'class', val: `slider-block slider-block--${sliderType}` },\n    ]);\n\n    slider.parentNode.insertBefore(wrapper, slider);\n    wrapper.appendChild(slider);\n\n    if (sliderProgress !== 'off' || sliderControl !== 'off') {\n        let controlWrapper = createHTMLElement('div', [\n            { label: 'class', val: 'slider-block__control' },\n        ]);\n        wrapper.appendChild(controlWrapper);\n    }\n\n    setVisibility(slider, sliderType, sliderObject);\n\n    if (sliderProgress !== 'off') {\n        createProgressTracker(slider, sliderType, sliderObject);\n    }\n\n    if (sliderControl !== 'off') {\n        createSliderButton(slider, sliderControl, sliderType, sliderObject);\n    }\n\n    setSwipe(slider, sliderType, sliderObject, sliderControl);\n}\n\n/**\n * setup swipe listeners\n * this function add events listener to calculate touch direction\n *\n * @param {HTMLElement} slider - an HTML element with the slider class.\n * @param {string} sliderType - type of slider - determines how many elements need to be visible on page load\n * @param {object} sliderObject - holds values for each slider type to be able to set slider behaviour\n * @param {string} sliderControl - type of control- determines is the control is dot\n */\n\nfunction setSwipe(slider, sliderType, sliderObject, sliderControl) {\n    let t = null;\n\n    slider.addEventListener('mousedown', swipeDown, false);\n    slider.addEventListener('touchstart', swipeDown, false);\n    slider.addEventListener('mouseup', swipeUp, false);\n    slider.addEventListener('touchend', swipeUp, false);\n\n    function swipeDown(e) {\n        e.preventDefault();\n        t = swipeCal(e);\n    }\n\n    function swipeUp(e) {\n        e.preventDefault();\n        let swipe = Math.sign(t(e));\n        if (sliderControl === 'dot') {\n            let btnWrap = slider.nextSibling,\n                curBtn = btnWrap.querySelector('[aria-expanded=\"true\"]'),\n                actionBtn = null;\n            if (curBtn.nextSibling && curBtn.previousSibling) {\n                actionBtn =\n                    swipe === -1\n                        ? curBtn.previousSibling\n                        : swipe === 1\n                        ? curBtn.nextSibling\n                        : null;\n                actionBtn && dotEvent(actionBtn, slider, btnWrap.firstChild);\n            } else if (!curBtn.nextSibling) {\n                actionBtn =\n                    swipe === -1\n                        ? curBtn.previousSibling\n                        : swipe === 1\n                        ? curBtn.parentElement.childNodes[0]\n                        : null;\n                actionBtn && dotEvent(actionBtn, slider, btnWrap.firstChild);\n            } else {\n                let btnLength = btnWrap.firstChild.childNodes.length;\n                actionBtn =\n                    swipe === -1\n                        ? curBtn.parentElement.childNodes[btnLength - 1]\n                        : swipe === 1\n                        ? curBtn.nextSibling\n                        : null;\n                actionBtn && dotEvent(actionBtn, slider, btnWrap.firstChild);\n            }\n        } else {\n            let e = slider.nextSibling.querySelectorAll(\n                    '.slider-block__control__progress'\n                ),\n                convert = Array.from(e),\n                elType = convert.filter((e) => {\n                    let s = window\n                        .getComputedStyle(e)\n                        .getPropertyValue('display');\n                    if (s === 'block') {\n                        return e;\n                    }\n                });\n            let sliderType = elType[0].classList.contains(\n                'slider-block__control__progress--tablet'\n            )\n                ? 'tablet'\n                : 'default';\n            let btn =\n                swipe === -1\n                    ? slider.nextSibling.lastChild.querySelector(\n                          `.prev--${sliderType}`\n                      )\n                    : swipe === 1\n                    ? slider.nextSibling.lastChild.querySelector(\n                          `.next--${sliderType}`\n                      )\n                    : null;\n\n            if (btn && !btn.disabled) {\n                defaultEvent(btn, slider, sliderType, sliderObject);\n            }\n        }\n    }\n}\n\n/**\n * setting visibility\n * this function sets adds data attributes to <li> elements within slider, this attribute will be used by CSS to determine\n * if slides are visible or not on page load. This data attribute will be used to turn visibility on/off with the slider buttons'\n * event listener\n *\n * @param {HTMLElement} slider - an HTML element with the slider class.\n * @param {string} sliderType - type of slider - determines how many elements need to be visible on page load\n * @param {object} sliderObject - holds values for each slider type to be able to set slider behaviour\n *\n */\nfunction setVisibility(slider, sliderType, sliderObject) {\n    Array.from(slider.getElementsByTagName('li')).forEach((el, i) => {\n        el.setAttribute(sliderObject.default.pageAttr, `${i}`);\n        el.setAttribute(sliderObject.default.tabIndex, '-1');\n        el.setAttribute(sliderObject.default.ariaLabel, `Slide ${i + 1}`);\n        if (i === 0) {\n            el.setAttribute(sliderObject.default.visAttr, true);\n        } else {\n            el.setAttribute(sliderObject.default.visAttr, false);\n        }\n    });\n\n    if (sliderType === 'responsive') {\n        const el = [...slider.children];\n\n        let tabletSlides = arraySlicer(el, sliderObject.tablet.maxItem);\n        let deskSlides = arraySlicer(el, sliderObject.desk.maxItem);\n\n        slicedArrayIterator(\n            tabletSlides,\n            sliderObject.tablet.pageAttr,\n            sliderObject.tablet.visAttr\n        );\n        slicedArrayIterator(\n            deskSlides,\n            sliderObject.desk.pageAttr,\n            sliderObject.desk.visAttr\n        );\n    }\n}\n\n/**\n * array iterator to set the same visibility attribute for groups of slides\n * this is necessary when you want to have different number of slides visible on different screen sizes\n *\n * @param {array} arr - array that will be iterated\n * @param {string} sliderType - type of slider - determines how many elements need to be visible on page load\n * @param {object} sliderObject - holds values for each slider type to be able to set slider behaviour\n */\n\nfunction slicedArrayIterator(arr, pageAttr, visibilityAttr) {\n    for (let i = 0; i < arr.length; i++) {\n        let subArray = arr[i];\n\n        for (let j = 0; j < subArray.length; j++) {\n            subArray[j].setAttribute(pageAttr, `${i}`);\n\n            if (i === 0) {\n                subArray[j].setAttribute(visibilityAttr, 'true');\n            } else {\n                subArray[j].setAttribute(visibilityAttr, 'false');\n            }\n        }\n    }\n}\n\n/**\n * Called by the initial launch function. It adds a progress bar/ page counter to the slider\n *\n * @param {HTMLElement} slider - an HTML element with the slider class.\n * @param {string} sliderType - type of slider - determines how many elements need to be visible on page load\n * @param {object} sliderObject - holds values for each slider type to be able to set slider behaviour\n */\nfunction createProgressTracker(slider, sliderType, sliderObject) {\n    const wrapper = slider.parentNode.querySelector('.slider-block__control');\n    createProgressElements(wrapper, 'default', sliderObject);\n\n    if (sliderType === 'responsive') {\n        if (\n            sliderObject.default.totalPages > `${sliderObject.tablet.maxItem}`\n        ) {\n            createProgressElements(wrapper, 'tablet', sliderObject);\n        }\n\n        if (sliderObject.default.totalPages > `${sliderObject.desk.maxItem}`) {\n            createProgressElements(wrapper, 'desk', sliderObject);\n        }\n    }\n}\n\n/**\n * Called by the createProgressTracker() function. It generates the HTML elements for the progress bar\n *\n * @param {HTMLElement} wrapper - an HTML element with the slider-block__control class.\n * @param {string} type - it tells you which key to use from the sliderObject\n * @param {object} sliderObject - holds values for each slider type to be able to set slider behaviour\n */\nfunction createProgressElements(wrapper, type, sliderObject) {\n    let progress = createHTMLElement('div', [\n        {\n            label: 'class',\n            val: `slider-block__control__progress slider-block__control__progress--${type}`,\n        },\n    ]);\n\n    wrapper.appendChild(progress);\n\n    let firstPage = createHTMLElement('span', [\n        { label: `${sliderObject[type].counterAttr}`, val: true },\n    ]);\n    firstPage.innerText = '1';\n\n    let separator = document.createElement('span');\n    separator.innerText = '/';\n\n    let lastPage = document.createElement('span');\n    lastPage.innerText = `${sliderObject[type].totalPages}`;\n\n    progress.appendChild(firstPage);\n    progress.appendChild(separator);\n    progress.appendChild(lastPage);\n}\n\n/**\n * Called by the innitial launch function. It adds control buttons to the slider\n *\n * @param {HTMLElement} slider - an HTML element with the slider class.\n * @param {string} sliderControl - determines what type of buttons to add to the slider\n * @param {string} sliderType - type of slider - determines how many elements need to be visible on page load\n * @param {object} sliderObject - holds values for each slider type to be able to set slider behaviour\n */\nfunction createSliderButton(slider, sliderControl, sliderType, sliderObject) {\n    const buttonWrapper = createHTMLElement('div', [\n        { label: 'class', val: 'slider-block__control__buttons' },\n    ]);\n\n    const controlWrapper = slider.parentNode.querySelector(\n        '.slider-block__control'\n    );\n    controlWrapper.appendChild(buttonWrapper);\n    controlWrapper.setAttribute('data-control-type', sliderControl);\n\n    if (sliderControl === 'default') {\n        let buttonPrev = createButtonElement(\n            'fas fa-arrow-left prev--default',\n            'default',\n            sliderObject\n        );\n        let buttonNext = createButtonElement(\n            'fas fa-arrow-right next--default',\n            'default',\n            sliderObject\n        );\n\n        buttonNext.setAttribute(aria.label, 'next item');\n\n        buttonNext.addEventListener('click', function () {\n            defaultEvent(this, slider, 'default', sliderObject);\n        });\n\n        buttonPrev.addEventListener('click', function () {\n            defaultEvent(this, slider, 'default', sliderObject);\n        });\n\n        buttonWrapper.appendChild(buttonPrev);\n        buttonWrapper.appendChild(buttonNext);\n        buttonWrapper.classList.add('slider-block__control__buttons--default');\n\n        if (sliderType === 'responsive') {\n            if (\n                sliderObject.default.totalPages >\n                `${sliderObject.tablet.maxItem}`\n            ) {\n                let buttonPrevTablet = createButtonElement(\n                        'fas fa-arrow-left prev--tablet',\n                        'tablet',\n                        sliderObject\n                    ),\n                    buttonNextTablet = createButtonElement(\n                        'fas fa-arrow-right next--tablet',\n                        'tablet',\n                        sliderObject\n                    );\n                buttonPrevTablet.addEventListener('click', function () {\n                    defaultEvent(this, slider, 'tablet', sliderObject);\n                });\n\n                buttonNextTablet.addEventListener('click', function () {\n                    defaultEvent(this, slider, 'tablet', sliderObject);\n                });\n                buttonWrapper.appendChild(buttonPrevTablet);\n                buttonWrapper.appendChild(buttonNextTablet);\n            }\n\n            if (\n                sliderObject.default.totalPages > `${sliderObject.desk.maxItem}`\n            ) {\n                let buttonPrevDesk = createButtonElement(\n                        'fas fa-arrow-left prev--desk',\n                        'desk',\n                        sliderObject\n                    ),\n                    buttonNextDesk = createButtonElement(\n                        'fas fa-arrow-right next--desk',\n                        'desk',\n                        sliderObject\n                    );\n                buttonPrevDesk.addEventListener('click', function () {\n                    defaultEvent(this, slider, 'desk', sliderObject);\n                });\n\n                buttonNextDesk.addEventListener('click', function () {\n                    defaultEvent(this, slider, 'desk', sliderObject);\n                });\n                buttonWrapper.appendChild(buttonPrevDesk);\n                buttonWrapper.appendChild(buttonNextDesk);\n            }\n        }\n    }\n\n    if (sliderControl === 'dot') {\n        createSliderDot(slider, sliderType, buttonWrapper, sliderObject);\n    }\n}\n\n/**\n * Creates HTML elements for the control buttons\n *\n * @param {string} classname - classname to be added to the button being generated\n * @param {string} type - it tells you which key to use from the sliderObject\n * @param {object} sliderObject - holds values for each slider type to be able to set slider behaviour\n */\nfunction createButtonElement(classname, type, sliderObject) {\n    let value;\n\n    if (classname.indexOf('prev') !== -1) {\n        value = -1;\n    } else {\n        value = 1;\n    }\n\n    let button = createHTMLElement('button', [\n        { label: 'class', val: classname },\n        { label: 'type', val: 'button' },\n        { label: 'data-next', val: value },\n        { label: `${sliderObject[type].visAttr}`, val: true },\n    ]);\n\n    if (classname.indexOf('prev') !== -1) {\n        button.setAttribute(aria.label, 'previous item');\n        button.setAttribute('disabled', true);\n    } else {\n        button.setAttribute(aria.label, 'next item');\n    }\n\n    return button;\n}\n\n/**\n * Event listener attached to default buttons\n *\n * @param {HTMLElement} slider - an HTML element with the slider class\n * @param {string} sliderType - type of slider - determines how many elements need to be visible on page load\n * @param {HTMLElement} wrapper - parent-wrapper HTML of buttons\n * @param {object} sliderObject - holds values for each slider type to be able to set slider behaviour\n *\n */\nfunction defaultEvent(button, slider, type, sliderObject) {\n    const currentSlide = Array.from(\n            slider.querySelectorAll(`[${sliderObject[type].visAttr} = 'true']`)\n        ),\n        nextPage = button.getAttribute('data-next'),\n        nextSlide = Array.from(\n            slider.querySelectorAll(\n                '[' + sliderObject[type].pageAttr + '= \"' + nextPage + '\"]'\n            )\n        ),\n        prevButton = button.parentNode.querySelector(`.prev--${type}`),\n        nextButton = button.parentNode.querySelector(`.next--${type}`),\n        counterEl = slider.parentNode.querySelector(\n            `span[${sliderObject[type].counterAttr}]`\n        );\n\n    let counterValue = parseInt(counterEl.innerText);\n\n    currentSlide.forEach((el) => {\n        el.setAttribute(`${sliderObject[type].visAttr}`, false);\n    });\n\n    nextSlide.forEach((el) => {\n        el.setAttribute(`${sliderObject[type].visAttr}`, true);\n    });\n\n    if (button.classList.contains(`next--${type}`)) {\n        let nextAttr = parseInt(button.getAttribute('data-next'));\n        if (nextAttr === sliderObject[type].endPosition) {\n            button.setAttribute('disabled', true);\n        }\n        nextAttr++;\n        button.setAttribute('data-next', nextAttr);\n\n        let prevAttr = parseInt(prevButton.getAttribute('data-next'));\n        prevAttr++;\n        prevButton.setAttribute('data-next', prevAttr);\n        prevButton.removeAttribute('disabled');\n\n        counterValue++;\n        counterEl.innerText = counterValue;\n    } else {\n        let prevAttr = parseInt(button.getAttribute('data-next'));\n        if (prevAttr === 0) {\n            button.setAttribute('disabled', true);\n        }\n        prevAttr--;\n        button.setAttribute('data-next', prevAttr);\n\n        let nextAttr = parseInt(nextButton.getAttribute('data-next'));\n        nextAttr--;\n        nextButton.setAttribute('data-next', nextAttr);\n        nextButton.removeAttribute('disabled');\n\n        counterValue--;\n        counterEl.innerText = counterValue;\n    }\n}\n\nexport default {\n    launchFn: launchSlider,\n    launchQuery: `.${className}`,\n};\n","/**\n * prepareAccordionTabs\n *\n * @module patterns/tabs/prepareAccordionTabs\n * @author Web Development\n * @copyright City, University of London 2019\n */\nimport aria from '../../aria-attributes';\nimport { appendAll } from '../../util';\n\nconst className = 'tabs',\n    panelClassName = className + '__panel',\n    linksClassName = className + '__links';\n\n/**\n * Add accordion functionality for mobile.\n *\n * @param {HTMLElement} tabs - An element transformed into a tabbed section\n */\nfunction accordionize(tabs) {\n    const wrapper = document.createElement('div'),\n        accordion = document.createElement('div');\n\n    wrapper.className = 'tabs--accordion';\n    accordion.className = 'accordion';\n    accordion.id = `accordion${tabs.dataset.assetid}`;\n    accordion.dataset.allowsingle = 'false';\n    accordion.dataset.defaultopen = 'true';\n    accordion.dataset.level = tabs.dataset.level;\n    accordion.dataset.tabs = tabs.dataset.tabs;\n    accordion.dataset.toggleopen = 'true';\n\n    Array.from(\n        tabs.parentNode.querySelectorAll(`#${tabs.id} > .${panelClassName}`)\n    ).forEach((panel) => {\n        const heading = panel.querySelector(`.${panelClassName}__heading`),\n            body = panel.querySelector(`.${panelClassName}__body`),\n            accordionHeading = document.createElement(\n                `h${accordion.dataset.level}`\n            ),\n            accordionSection = document.createElement('div'),\n            accordionWrapper = document.createElement('div');\n\n        accordionHeading.className = 'accordion__heading';\n        accordionHeading.id = `accordion${tabs.dataset.assetid}-header${panel.dataset.assetid}`;\n        accordionHeading.dataset.tabid = panel.getAttribute(aria.labelledBy);\n        accordionHeading.innerText = heading.innerText.trim();\n\n        accordionSection.className = 'accordion__body';\n        accordionSection.id = `accordion${tabs.dataset.assetid}-body${panel.dataset.assetid}`;\n        accordionWrapper.className = 'wrapper--accordion__body__content';\n        accordionWrapper.innerHTML = body.innerHTML;\n        accordionSection.appendChild(accordionWrapper);\n\n        appendAll(accordion, [accordionHeading, accordionSection]);\n    });\n\n    tabs.parentNode.insertBefore(wrapper, tabs);\n    wrapper.appendChild(tabs);\n    wrapper.appendChild(accordion);\n\n    return accordion;\n}\n\nfunction prepareAccordionTabs(tabs) {\n    const controls = tabs.querySelector(`.${linksClassName}`),\n        linkItems = Array.from(controls.querySelectorAll('li')),\n        numberOfTabs = Number.parseInt(tabs.dataset.mobiletabs);\n\n    if (\n        linkItems.length > numberOfTabs &&\n        (!tabs.dataset.neveraccordion ||\n            !tabs.dataset.neveraccordion === 'true')\n    ) {\n        return accordionize(tabs);\n    } else {\n        return null;\n    }\n}\n\nexport default prepareAccordionTabs;\n","/**\n * Tabs\n *\n * @module patterns/tabs/tabs\n * @author Web Development\n * @copyright City, University of London 2018-2019\n */\nimport scroll from 'zenscroll';\nimport { reduceMotion, removeClass } from '../../util';\nimport aria from '../../aria-attributes';\n\nconst className = 'tabs',\n    panelClassName = className + '__panel',\n    contentClassName = panelClassName + '__content',\n    linksClassName = className + '__links',\n    endKey = 35,\n    homeKey = 36,\n    arrowLeft = 37,\n    arrowUp = 38,\n    arrowRight = 39,\n    arrowDown = 40,\n    oneSecond = 1000,\n    scrollDuration = reduceMotion() ? 0 : oneSecond,\n    scrollTo = false;\n\n/**\n * Set the attributes of a tab to be selected or not selected.\n *\n * Unselected tabs are removed from the tab order.\n *\n * @param {HTMLButtonElement} button - The anchor element to toggle.\n * @param {boolean} selected - Set the element to be selected?\n */\nfunction toggleButton(button, selected) {\n    button.setAttribute(aria.selected, selected);\n\n    if (selected) {\n        button.setAttribute(aria.current, true);\n    } else {\n        button.removeAttribute(aria.current);\n    }\n}\n\n/**\n * Change the selection to the requested tab.\n *\n * @param {HTMLAnchorElement} newTab - The selected tab.\n */\nfunction selectTab(newTab) {\n    const tabs = newTab.closest(`.${className}`),\n        controls = tabs.querySelector(`.${linksClassName}`),\n        linkItems = Array.from(controls.querySelectorAll('li')),\n        panels = Array.from(tabs.childNodes).filter(\n            (node) => node.className && node.className === panelClassName\n        );\n\n    /**\n     * Unselect every tab and related panel.\n     */\n    linkItems.forEach((linkItem) => {\n        toggleButton(linkItem.firstElementChild, false);\n    });\n    panels.forEach((panel) => panel.setAttribute('hidden', 'true'));\n\n    /**\n     * Select the requested tab.\n     */\n    toggleButton(newTab, true);\n    tabs.querySelector(newTab.dataset.hash).removeAttribute('hidden');\n\n    /**\n     * Move focus to the section and optionally scroll it into view.\n     */\n    newTab.focus();\n    scrollTo && scroll.to(tabs, scrollDuration);\n}\n\n/**\n * Respond to event changing tab selection.\n *\n * @param {Event} e - The initiating event.\n * @param {HTMLAnchorElement} newTab - The selected tab.\n */\nfunction selectTabEvent(e, newTab) {\n    e.preventDefault();\n    selectTab(newTab);\n}\n\n/**\n * Respond to cursor key events inside the tabbed section.\n *\n * @param {Event} e - The initiating keydown event.\n * @param {HTMLElement} tabs - The controls for the tabbed section.\n */\nfunction keyEvents(e, tabs) {\n    const currentTab = tabs.querySelector(`[${aria.selected}=\"true\"]`),\n        currentTabLI = currentTab.parentNode;\n    let newTab = null;\n    if (arrowLeft === e.which) {\n        /**\n         * Previous tab has been requested - if we're already at the beginning,\n         * we need to wrap around to the last tab.\n         */\n        currentTabLI.previousElementSibling\n            ? (newTab = currentTabLI.previousElementSibling.firstElementChild)\n            : (newTab = tabs.querySelector('li:last-of-type a'));\n    } else if (arrowRight === e.which) {\n        /**\n         * Next tab has been requested - if we're already at the end, we need\n         * to wrap around to the first tab.\n         */\n        currentTabLI.nextElementSibling\n            ? (newTab = currentTabLI.nextElementSibling.firstElementChild)\n            : (newTab = tabs.querySelector('li:first-of-type a'));\n    } else if (arrowDown === e.which) {\n        /**\n         * Move focus into the tab content.\n         */\n        tabs.querySelector(currentTab.dataset.hash).focus();\n    } else if (arrowUp === e.which) {\n        /**\n         * Move focus to the currently selected tab control.\n         */\n        currentTab.focus();\n    } else if (homeKey === e.which) {\n        /**\n         * First tab\n         */\n        newTab = tabs.querySelector('li:first-of-type a');\n    } else if (endKey === e.which) {\n        /**\n         * Last tab\n         */\n        newTab = tabs.querySelector('li:last-of-type a');\n    }\n    newTab && selectTabEvent(e, newTab);\n}\n/**\n * Set attributes and listeners for the tabbed section controls.\n *\n * @param {HTMLLIElement[]} linkItems - An array of list items containing the tab anchors.\n */\nfunction prepareLinks(linkItems) {\n    linkItems.forEach((linkItem) => {\n        const link = linkItem.firstElementChild,\n            button = document.createElement('button');\n\n        linkItem.setAttribute('role', 'presentation');\n\n        button.setAttribute('role', 'tab');\n        button.appendChild(link.firstElementChild);\n        button.dataset.hash = link.hash;\n        button.id = link.id;\n\n        linkItem.replaceChild(button, link);\n\n        toggleButton(button, false);\n\n        button.addEventListener(\n            'click',\n            (e) => selectTabEvent(e, button),\n            true\n        );\n    });\n}\n\n/**\n * Set attributes for the tabbed section panels.\n *\n * @param {HTMLElement[]} panels - An array of tab panels.\n */\nfunction preparePanels(panels) {\n    panels.forEach((panel) => {\n        const wrapper = document.createElement('div'),\n            panelElements = Array.from(panel.children);\n        wrapper.className = contentClassName;\n        panelElements.forEach((element) => wrapper.appendChild(element));\n        panel.appendChild(wrapper);\n        panel.setAttribute('role', 'tabpanel');\n        panel.setAttribute('tabindex', -1);\n        panel.setAttribute('hidden', 'true');\n    });\n}\n\n/**\n * Transform an element with the tabs class name into a tabbed section.\n *\n * A tabbed section is expected to contain a list of anchors pointing to each\n * section, followed by the sections themselves.\n *\n * e.g.\n *\n * <div class=\"tabs\">\n * <ul class=\"tabs__links\">\n * <li><a href=\"#tab1\">Tab 1</a></li>\n * <li><a href=\"#tab2\">Tab 2</a></li>\n * </ul>\n * <section class=\"tabs__panel\" id=\"tab1\">Content 1</section>\n * <section class=\"tabs__panel\" id=\"tab2\">Content 2</section>\n * </div>\n *\n * @param {HTMLElement} tabs - An element with the tabs class\n */\nfunction launchTabs(tabs) {\n    const controls = tabs.querySelector(`.${linksClassName}`),\n        linkItems = Array.from(controls.querySelectorAll('li')),\n        panels = Array.from(tabs.childNodes).filter(\n            (node) => node.className && node.className === panelClassName\n        );\n\n    if (linkItems.length === 1) {\n        /**\n         * don't make one tab into a tabbed section, makes no sense\n         */\n        removeClass(tabs, className, false);\n        return;\n    }\n\n    controls.setAttribute('role', 'tablist');\n    preparePanels(panels);\n    prepareLinks(linkItems);\n\n    toggleButton(linkItems[0].firstElementChild, true);\n    panels[0].removeAttribute('hidden');\n\n    /**\n     * Enable keyboard access to tabs with the cursor keys.\n     */\n    tabs.addEventListener('keydown', (e) => keyEvents(e, tabs), true);\n}\n\nexport default {\n    launchFn: launchTabs,\n    launchQuery: `.${className}`,\n};\n","/**\n * Image accreditation tooltip\n *\n * @module patterns/tooltip/image-credit\n * @author Web Development\n * @copyright City, University of London\n */\n\nimport { createHTMLElement } from '../../../util';\n\nconst className = 'hero-image';\nlet authorElement, sourceElement;\n\n/**\n * Respond to button clicks - open if closed, close if opened.\n *\n * @param {event} e - The information icon click event.\n */\nfunction showCredit(e) {\n    let tooltipWrapper = e.target.closest('.wrapper--tooltip__label');\n    tooltipWrapper.getAttribute('data-selected') === 'false'\n        ? tooltipWrapper.setAttribute('data-selected', 'true')\n        : tooltipWrapper.setAttribute('data-selected', 'false');\n}\n\n/**\n * Create label(s) to go alongside the information icon.\n *\n * @param {string} el - Blank variable that is returned as an HTML element after function is complete.\n * @param {string} elText - Label's link or link text value.\n * @param {url} elUrl - Label's link value.\n */\nfunction createLabel(el, elText, elUrl) {\n    if (elText) {\n        const elTextNode = document.createTextNode(elText);\n        if (elUrl) {\n            el = createHTMLElement('a', []);\n            el.href = elUrl;\n            el.appendChild(elTextNode);\n        } else {\n            el = createHTMLElement('span', []);\n            el.appendChild(elTextNode);\n        }\n        return el;\n    }\n}\n\n/**\n * Create an accreditation tooltip from the data attributes of a banner image.\n *\n * @param {HTMLElement} banner - A banner image.\n */\nfunction launchBannerTooltip(banner) {\n    const tooltipDisplay = banner.getAttribute('data-tooltip-display'),\n        authorText = banner.getAttribute('data-author-name'),\n        authorUrl = banner.getAttribute('data-author-url'),\n        sourceText = banner.getAttribute('data-source-name'),\n        sourceUrl = banner.getAttribute('data-source-url');\n\n    if (tooltipDisplay === 'true') {\n        const tooltipWrapper = createHTMLElement('div', [\n            { label: 'class', val: 'wrapper--tooltip__label' },\n            { label: 'data-selected', val: false },\n        ]);\n        const iconBtn = createHTMLElement('button', [\n            { label: 'class', val: 'tooltip tooltip--image-credit' },\n            { label: 'aria-label', val: 'Show image credit' },\n        ]);\n        const iconSpan = createHTMLElement('span', [\n            { label: 'class', val: 'tooltip__icon icon fas fa-info-circle' },\n            { label: 'aria-label', val: 'Information icon' },\n        ]);\n        const labelSpan = createHTMLElement('div', [\n            { label: 'class', val: 'tooltip__label' },\n        ]);\n\n        // Build labels\n        let author = createLabel(authorElement, authorText, authorUrl);\n        let source = createLabel(sourceElement, sourceText, sourceUrl);\n\n        // Append tooltip elements to banner\n        iconBtn.appendChild(iconSpan);\n        authorText && !sourceText ? labelSpan.appendChild(author) : null;\n        sourceText && !authorText ? labelSpan.appendChild(source) : null;\n\n        // Add divider if author and source text values exist\n        if (authorText && sourceText) {\n            labelSpan.appendChild(author);\n            const dividerText = document.createTextNode(' / ');\n            labelSpan.appendChild(dividerText);\n            labelSpan.appendChild(source);\n        }\n\n        tooltipWrapper.appendChild(labelSpan);\n        tooltipWrapper.appendChild(iconBtn);\n\n        // Only append tooltip if at least one name is supplied (author or source)\n        authorText || sourceText ? banner.appendChild(tooltipWrapper) : null;\n\n        // Show/hide icon label(s) on click\n        iconBtn.addEventListener('click', (e) => {\n            showCredit(e);\n        });\n    }\n}\n\nexport default {\n    launchFn: launchBannerTooltip,\n    launchQuery: `.${className}`,\n};\n","const className = 'fa-link';\n\nfunction copyIconToClipboard(elem) {\n    const copy = elem;\n    copy.parentNode.parentNode.style.position = 'relative';\n    copy.addEventListener('mouseover', (e) => {\n        let t = document.createElement('div');\n        let link = document.createElement('span');\n        let url = window.location.href;\n        t.className = 'tooltip';\n        link.className = 'link-copy';\n        let textlink = document.createTextNode(url);\n        let textnode = document.createTextNode('Copy link');\n        t.appendChild(textnode);\n        link.appendChild(textlink);\n        t.appendChild(link);\n        e.target.parentElement.parentElement.appendChild(t);\n        e.target.parentElement.parentElement.classList.add('copyLink');\n    });\n\n    copy.addEventListener('click', (e) => {\n        e.preventDefault();\n        let text = e.target.parentElement.parentElement.querySelector(\n            '.link-copy'\n        );\n        let range = document.createRange();\n        range.selectNode(text);\n        window.getSelection().addRange(range);\n        try {\n            // Now that we've selected the anchor text, execute the copy command\n            let successful = document.execCommand('copy');\n            let msg = successful ? 'successful' : 'unsuccessful';\n            e.target.parentElement.parentElement.querySelector(\n                '.tooltip'\n            ).textContent = 'Link Copied';\n            e.target.parentElement.parentElement\n                .querySelector('.tooltip')\n                .classList.add(msg);\n        } catch (err) {\n            throw new Error(e);\n        }\n\n        // Remove the selections - NOTE: Should use\n        // removeRange(range) when it is supported\n        window.getSelection().removeAllRanges();\n    });\n\n    copy.addEventListener('mouseout', (e) => {\n        //remove element from mouseover\n        e.target.parentElement.parentElement.querySelector('.tooltip').remove();\n    });\n}\n\nexport default {\n    launchFn: copyIconToClipboard,\n    launchQuery: `.${className}`,\n};\n","/**\n * Loop autoplayed video a defined number of times.\n *\n * @module patterns/video/video\n * @author Web Development\n * @copyright City, University of London\n */\n\nimport { createHTMLElement } from '../../util';\n\nconst className = 'embedded-video--autoplay';\n\n/**\n * Loop video as et number of times\n *\n * @param {element} video - A video with the 'embedded-video--autoplay' class.\n * @param {number} maxPlays - Maximum number of times video should play.\n */\nfunction loopVideo(video, maxPlays) {\n    let playInstance = 0;\n\n    video.onended = () => {\n        playInstance += 1;\n        playInstance === maxPlays ? video.pause() : null;\n    };\n}\n\n/**\n * Create video play/pause button.\n *\n * @param {element} video - A video with the 'embedded-video--autoplay' class.\n */\nfunction createController(video) {\n    let controllerBtn;\n\n    const controllerIcon = createHTMLElement('span', [\n        {\n            label: 'class',\n            val: 'embedded-video--autoplay__controller-btn__icon',\n        },\n    ]);\n\n    let statusPaused = video.querySelector('.embedded-video--autoplay__video')\n        .paused;\n\n    if (statusPaused) {\n        controllerBtn = createHTMLElement('button', [\n            { label: 'class', val: 'embedded-video--autoplay__controller-btn' },\n            { label: 'data-status', val: 'play' },\n            { label: 'aria-label', val: 'Play video' },\n        ]);\n    } else {\n        controllerBtn = createHTMLElement('button', [\n            { label: 'class', val: 'embedded-video--autoplay__controller-btn' },\n            { label: 'data-status', val: 'pause' },\n            { label: 'aria-label', val: 'Pause video' },\n        ]);\n    }\n\n    controllerBtn.append(controllerIcon);\n    video.append(controllerBtn);\n}\n\nfunction toggleController(video) {\n    const videoEl = video.querySelector('.embedded-video--autoplay__video'),\n        controllerBtn = video.querySelector(\n            '.embedded-video--autoplay__controller-btn'\n        ),\n        statusPaused = video.querySelector('.embedded-video--autoplay__video')\n            .paused;\n\n    if (statusPaused) {\n        controllerBtn.dataset.status = 'pause';\n        controllerBtn.setAttribute('aria-label', 'Pause video');\n        videoEl.play();\n    } else {\n        controllerBtn.dataset.status = 'play';\n        controllerBtn.setAttribute('aria-label', 'Play video');\n        videoEl.pause();\n    }\n}\n\nfunction launchAutoplayVideo(video) {\n    const videoEl = video.querySelector('.embedded-video--autoplay__video'),\n        plays = parseInt(videoEl.dataset.maxPlays);\n\n    loopVideo(video, plays);\n    createController(video);\n\n    const controllerBtn = video.querySelector(\n        '.embedded-video--autoplay__controller-btn'\n    );\n\n    controllerBtn.addEventListener('click', () => {\n        toggleController(video);\n    });\n\n    // When video finishes autoplaying, switch controller from pause to play\n    videoEl.addEventListener('ended', () => {\n        controllerBtn.dataset.status = 'play';\n        controllerBtn.setAttribute('aria-label', 'Play video');\n    });\n}\n\nexport default {\n    launchFn: launchAutoplayVideo,\n    launchQuery: `.${className}`,\n};\n","/**\n * Useful utility functions\n *\n * @module util\n * @author Web Development\n * @copyright City, University of London 2018-2020\n */\n\nimport axios from 'axios';\nimport React from 'react';\n\n/**\n * Turns string boolean into real boolean.\n *\n * @param {string} s - A string that may be 'true'.\n * @returns {boolean} True if 'true'.\n */\nexport function toBool(s) {\n    return s === 'true' ? true : false;\n}\n\nconst partialMatchFn = m => s => s.indexOf(m) < 0,\n    fullMatchFn = m => s => s !== m;\n\n/**\n * Remove a class name from an HTML element.\n *\n * @param {HTMLElement} elem - An HTML element.\n * @param {string} className - A string representing the class to remove.\n * @param {boolean} [removePartials] - If true, remove partially matching classes.\n */\nexport function removeClass(elem, className, removePartials) {\n    const matchFn = removePartials\n        ? partialMatchFn(className)\n        : fullMatchFn(className);\n    elem.className = elem.className\n        .split(/\\s+/)\n        .filter(s => matchFn(s))\n        .join(' ');\n}\n\n/**\n * Detect whether reduced motion is enabled.\n *\n * If it is, you should shortcut animations, disable autoplay elements, avoid\n * smooth scrolling in favour of jump scrolling, etc.\n *\n * Currently unsupported by Chrome, but works in Safari and Firefox.\n *\n * @returns {boolean} Boolean indicating that the reduce motion media query matches.\n */\nexport function reduceMotion() {\n    const reducedMotionQuery = window.matchMedia(\n        '(prefers-reduced-motion: reduce)'\n    );\n    return reducedMotionQuery.matches ? true : false;\n}\n\n/**\n * Predicate testing whether an element is currently visible, as opposed to\n * displayed: none; or similar. Doesn't necessarily mean it's visible in the\n * window.\n *\n * @param {HTMLElement} elem - An HTML element.\n * @returns {boolean} - Is it visible?\n */\nexport function isVisible(elem) {\n    return elem.offsetHeight !== 0 && elem.offsetWidth !== 0 ? true : false;\n}\n\n/**\n * Predicate testing whether an element is positioned in the window.\n *\n *\n * @param {HTMLElement} elem - An HTML element.\n * @returns {boolean} - Is it onscreen?\n */\nexport function verticallyInWindow(elem) {\n    return elem.getBoundingClientRect().top >= 0 &&\n        elem.getBoundingClientRect().top <= window.innerHeight\n        ? true\n        : false;\n}\n\n/**\n * Turn a query string into an object.\n *\n * @param {string} parameterString - An HTML query string.\n * @returns {object} An object containing the parameters.\n */\nexport function parametersToObject(parameterString) {\n    const parameters = {};\n    parameterString\n        .substr(1)\n        .split('&')\n        .forEach(parameter => {\n            const [k, v] = parameter.split('=');\n            parameters[k] = v;\n        });\n    return parameters;\n}\n\n/**\n * Turn an object into a query string.\n *\n * @param {object} parameterObj - An object containing the parameters and their values.\n * @returns {string} A string of the parameters.\n */\nexport function objectToParameters(parameterObj) {\n    if (Object.keys(parameterObj).length > 0) {\n        let parameters = '?';\n        for (const key in parameterObj) {\n            parameters.length !== 1 && (parameters += '&');\n            parameters += key + '=' + parameterObj[key];\n        }\n        return parameters;\n    } else {\n        return '';\n    }\n}\n\n/**\n * Track a Google Analytics event.\n *\n * @param {string} event - The event key for Tag Manager.\n * @param {string} eventCategory - The event category.\n * @param {string} eventAction - The event action.\n * @param {string} [eventLabel] - The event label.\n * @param {number} [eventValue] - The event value.\n * @param {boolean} [nonInteractionHit] - Does this count as interacting with the page?\n */\nexport function gaEvent(\n    event,\n    eventCategory,\n    eventAction,\n    eventLabel,\n    eventValue,\n    nonInteractionHit\n) {\n    window.dataLayer = window.dataLayer || [];\n    window.dataLayer.push({\n        event: event,\n        eventCategory: eventCategory,\n        eventAction: eventAction,\n        eventLabel: eventLabel,\n        eventValue: eventValue,\n        nonInteractionHit: nonInteractionHit,\n    });\n}\n\n/**\n * Append an array of elements to an element.\n *\n * @param {HTMLElement} elem - The parent element.\n * @param {HTMLElement[]} children - An array of elements to append to it.\n */\nexport function appendAll(elem, children) {\n    children.forEach(child => elem.appendChild(child));\n}\n\n/**\n * Extract number from string, e.g. return '123' from string 'a1b2c3'.\n *\n * @param {string} string - String\n */\nexport function numberFromString(string) {\n    let number = string.replace(/\\D/g, '');\n    return number;\n}\n\n/**\n * Calculates viewport width to determinte if using mobile\n * @param {number} number - width of screen, with default value = 432.\n *\n */\nexport function isMobile(screen = 432) {\n    const viewPortWidth = window.innerWidth;\n    const mobileScreen = screen;\n\n    if (viewPortWidth < mobileScreen) {\n        return true;\n    }\n}\n\n/**\n *\n * Turn DOM elements to array e.g return [li, li, li] from DOM element selecting 'li' <ul><li></li><li></li><li></li></ul>\n *\n * @param {object} object - Object\n */\n\nexport function toArray(obj) {\n    let array = [];\n    // iterate backwards ensuring that length is an UInt32\n    for (let i = obj.length >>> 0; i--; ) {\n        array[i] = obj[i];\n    }\n    return array;\n}\n\n/**\n * Check browser user agent is IE or edge and return version number\n */\nexport function detectIE() {\n    const ua = window.navigator.userAgent,\n        versionLength = 10,\n        msie = ua.indexOf('MSIE '),\n        msieVersionOffset = 5;\n\n    if (msie > 0) {\n        // IE 10 or older => return version number\n        return parseInt(\n            ua.substring(msie + msieVersionOffset, ua.indexOf('.', msie)),\n            versionLength\n        );\n    }\n\n    const trident = ua.indexOf('Trident/'),\n        tridentVersionOffset = 3;\n\n    if (trident > 0) {\n        // IE 11 => return version number\n        let rv = ua.indexOf('rv:');\n        return parseInt(\n            ua.substring(rv + tridentVersionOffset, ua.indexOf('.', rv)),\n            versionLength\n        );\n    }\n\n    const edge = ua.indexOf('Edge/'),\n        edgeVersionOffset = 5;\n\n    if (edge > 0) {\n        // Edge (IE 12+) => return version number\n        return parseInt(\n            ua.substring(edge + edgeVersionOffset, ua.indexOf('.', edge)),\n            versionLength\n        );\n    }\n\n    // other browser\n    return false;\n}\n\n/**\n * Check if browser supports IntersectionObserver API\n *\n * @returns {Boolean} -\n */\nexport function checkIntersectionObserver() {\n    if (\n        'IntersectionObserver' in window &&\n        'IntersectionObserverEntry' in window &&\n        'intersectionRatio' in window.IntersectionObserverEntry.prototype\n    ) {\n        return true;\n    } else {\n        return false;\n    }\n}\n\n/**\n * Create elements containing classes, content and any other attributes\n *\n * @param {string} type - Type of element to create, e.g. \"div\", \"button\".\n * @param {array} attributes - Array of objects specifying which attributes to assign to the element i.e. {label : \"class\", val : \"container\"}\n */\nexport function createHTMLElement(type, attributes) {\n    let el = document.createElement(type);\n    attributes.map(function(att) {\n        att.label === 'content'\n            ? el.appendChild(document.createTextNode(att.val))\n            : el.setAttribute(att.label, att.val);\n    });\n    return el;\n}\n\nexport function uppercaseFirstLetterLowercaseRest(s) {\n    return s.charAt(0).toUpperCase() + s.slice(1).toLowerCase();\n}\n\n/**\n * Asynchronous request to Funnelback web service.\n *\n * @param {object} config An axios configuration object.\n * @return {Promise} - A promise of a Funnelback response.\n */\nexport function axiosRequest(config) {\n    const httpOK = 200;\n\n    return axios(config)\n        .then(response => {\n            if (httpOK === response.status) {\n                return response.data;\n            } else {\n                throw `Bad response: ${response.status}`;\n            }\n        })\n        .catch(e => {\n            if (!axios.isCancel(e)) {\n                gaEvent(\n                    'jsError',\n                    'JavaScript error',\n                    `Line ${e.lineNumber} – ${e.message}`,\n                    `axiosRequest ${e.fileName} (${window.location})`,\n                    true\n                );\n            }\n        });\n}\n\n/**\n * Returns the correct English suffix for a number.\n *\n * @param  {number} day - The day of the month.\n * @returns {string} The correct suffix.\n */\nfunction daySuffix(day) {\n    const eleventh = 11,\n        thirteenth = 13,\n        lastDigit = day.toString().slice(-1);\n\n    return day >= eleventh || day <= thirteenth\n        ? 'th'\n        : lastDigit === '1'\n        ? 'st'\n        : lastDigit === '2'\n        ? 'nd'\n        : lastDigit === '3'\n        ? 'rd'\n        : 'th';\n}\n\n/**\n * Format a date for React.\n *\n * @param {Date} date - A date object.\n * @returns {ReactFragment} The formatted date.\n */\nexport function formatReactDate(date) {\n    const months = [\n            'January',\n            'February',\n            'March',\n            'April',\n            'May',\n            'June',\n            'July',\n            'August',\n            'September',\n            'October',\n            'November',\n            'December',\n        ],\n        days = [\n            'Sunday',\n            'Monday',\n            'Tuesday',\n            'Wednesday',\n            'Thursday',\n            'Friday',\n            'Saturday',\n        ];\n\n    return (\n        <time dateTime={date.toISOString().split('T')[0]}>\n            {days[date.getUTCDay()]}, {date.getUTCDate()}\n            <sup>{daySuffix(date.getUTCDate())}</sup>{' '}\n            {months[date.getUTCMonth()]} {date.getUTCFullYear()}\n        </time>\n    );\n}\n\n/**\n * Array slicer\n *\n * @param {array} arr - array to be split up into subarrays\n * @param {number} len - max number items that goes into each subarray\n */\nexport function arraySlicer(arr, len) {\n    let newArray = [],\n        i = 0,\n        n = arr.length;\n\n    while (i < n) {\n        newArray.push(arr.slice(i, (i += len)));\n    }\n    return newArray;\n}\n"],"sourceRoot":""}
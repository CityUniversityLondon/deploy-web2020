{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/react-is/cjs/react-is.development.js","webpack:///./node_modules/react-is/index.js","webpack:///./src/action-on-scroll.js","webpack:///./src/aria-attributes.js","webpack:///./src/main.js","webpack:///./src/patterns.js","webpack:///./src/patterns/accordion/accordion.js","webpack:///./src/patterns/animation/content-fade-in/content-fade-in.js","webpack:///./src/patterns/animation/content-separator/content-separator.js","webpack:///./src/patterns/animation/content-slide-up/content-slide-up.js","webpack:///./src/patterns/animation/image-expand/image-expand.js","webpack:///./src/patterns/animation/number-animation/number-animation.js","webpack:///./src/patterns/animation/svg-path-animation/svg-path-animation.js","webpack:///./src/patterns/back-to-top/back-to-top.js","webpack:///./src/patterns/cms-editor-warning/cms-editor-warning.js","webpack:///./src/patterns/cookie-notice/cookie-notice.js","webpack:///./src/patterns/devcorate/devcorate.js","webpack:///./src/patterns/dropdown-filter/dropdown-filter.js","webpack:///./src/patterns/feedback/feedback.js","webpack:///./src/patterns/finder/components/cards/finder__results__bestbet.js","webpack:///./src/patterns/finder/components/cards/finder__results__card.js","webpack:///./src/patterns/finder/components/cards/finder__results__course.js","webpack:///./src/patterns/finder/components/cards/finder__results__profile.js","webpack:///./src/patterns/finder/components/filters/finder__filters.js","webpack:///./src/patterns/finder/components/filters/finder__mobilefilters.js","webpack:///./src/patterns/finder/components/filters/finder__select.js","webpack:///./src/patterns/finder/components/filters/finder__toggle.js","webpack:///./src/patterns/finder/components/query/finder__clear.js","webpack:///./src/patterns/finder/components/query/finder__query--mini.js","webpack:///./src/patterns/finder/components/query/finder__query.js","webpack:///./src/patterns/finder/components/results/finder__didyoumean.js","webpack:///./src/patterns/finder/components/results/finder__pagination.js","webpack:///./src/patterns/finder/components/results/finder__results.js","webpack:///./src/patterns/finder/components/results/finder__results__highlight__query.js","webpack:///./src/patterns/finder/components/results/finder__results__summary.js","webpack:///./src/patterns/finder/finder-mini.js","webpack:///./src/patterns/finder/finder.js","webpack:///./src/patterns/finder/funnelback.js","webpack:///./src/patterns/image-carousel/default-carousel/default-carousel.js","webpack:///./src/patterns/image-carousel/image-carousel.js","webpack:///./src/patterns/key-info-box/key-info-slider.js","webpack:///./src/patterns/link-finder/link-finder.js","webpack:///./src/patterns/load-more/load-more.js","webpack:///./src/patterns/menu/menu-formatters.js","webpack:///./src/patterns/menu/menu.js","webpack:///./src/patterns/modal/modal.js","webpack:///./src/patterns/navigation/navigation-primary.js","webpack:///./src/patterns/navigation/navigation-secondary.js","webpack:///./src/patterns/paginated-list/paginated-list.js","webpack:///./src/patterns/pagination/pagination.js","webpack:///./src/patterns/show-more/show-more.js","webpack:///./src/patterns/slider-responsive/slider-responsive.js","webpack:///./src/patterns/slider/slider.js","webpack:///./src/patterns/social-icon/social-icon.js","webpack:///./src/patterns/tabs/prepareAccordionTabs.js","webpack:///./src/patterns/tabs/tabs.js","webpack:///./src/util.js","webpack:///util (ignored)","webpack:///util (ignored)?67c7"],"names":["actionOnScroll","element","action","repeat","options","threshold","actionOnScrollAction","entries","forEach","entry","isIntersecting","classList","add","observer","unobserve","IntersectionObserver","observe","aria","activeDescendant","atomic","autoComplete","busy","checked","colCount","colIndex","colSpan","controls","current","describedBy","details","disabled","dropEffect","errorMessage","expanded","flowTo","grabbed","hasPopup","hidden","invalid","keyShortcuts","label","labelledBy","level","live","modal","multiLine","multiSelectable","orientation","owns","placeholder","posInset","pressed","readOnly","relevant","required","roleDescription","rowCount","rowIndex","rowSpan","selected","setSize","sort","valueMax","valueMin","valueNow","valueText","Object","freeze","tryCatch","f","e","gaEvent","lineNumber","message","fileName","window","location","launchPattern","pattern","launchQuery","launchFn","Array","from","document","querySelectorAll","filter","elem","className","indexOf","accordionizeTabs","root","potential","prepareAccordionTabs","addEventListener","test","navigator","userAgent","getElementsByTagName","html","ie","detectIE","removeClass","trim","patterns","parameters","parametersToObject","search","devcorate","querySelector","accordion","cmsEditorWarning","cookieNotice","feedback","finder","finderMini","keyInfoSlider","loadMore","menu","primaryNavigation","secondaryNavigation","paginatedList","pagination","tabs","linkFinder","contentSeparator","imageExpand","contentFadeIn","contentSlideUp","socialIcon","slider","sliderResponsive","carousel","numberAnimation","showMore","gallery","svgPathAnimation","backToTop","dropdownFilter","headingClassName","headingTextClassName","headingIconClassName","bodyClassName","scrollDuration","reduceMotion","scrollTo","setSection","heading","open","dataset","firstElementChild","setAttribute","calculateAccordionBodyHeight","section","nextElementSibling","closed","height","offsetHeight","setupTransition","initialHeight","style","cleanupTransition","toBool","previousElementSibling","buttonClick","button","headings","toggleOpen","parentNode","accordionSection","capture","once","getAttribute","setTimeout","history","pushState","pathname","sectionHeight","hash","replaceState","id","sections","parentElement","verticallyInWindow","scroll","to","buttonFromHeading","createElement","wrapper","textSpan","iconSpan","appendChild","createTextNode","textContent","appendAll","launchAccordion","locationHash","substr","toggleopen","defaultOpen","defaultopen","allowSingle","allowsingle","idLinked","length","content","replaceChild","firstChild","contentFadein","viewPortHeight","innerHeight","isMobile","elemOffset","offsetTop","screenPos","pageYOffset","includes","contentSeparatorContainer","el","insertElement","prepend","contentSlideup","elemOffsetTop","parentElemHeight","parseInt","getComputedStyle","getPropertyValue","image","DURATION","findNumberContainer","widget","nested","initNumberAnimation","startStr","animationNumberStart","start","parseFloat","numberContainer","numberStr","innerHTML","replace","match","animationNumberValue","animationNumberFloat","runNumberAnimation","isFloat","value","first","startTime","startValue","lastValue","timestamp","t","finish","k","Math","pow","v","round","toLocaleString","requestAnimationFrame","init","elm","lazyNumbers","slice","call","checkIntersectionObserver","lazyUnit","initSvgPathAnimation","animateSvg","paths","path","getTotalLength","strokeDashoffset","strokeDasharray","contains","pageHeight","scrollPos","initBacktoTop","backToTopAnchor","documentHeight","body","clientHeight","backToTopDock","deadZone","updateProgress","showAnchor","docked","positionOnScreen","removeAttribute","progressPath","pathLength","documentElement","scrollHeight","progress","warningClass","buttonClass","wrapperClass","createButton","launchRemover","warnings","w","removeChild","insertBefore","cookieName","cookieOptions","expires","samesite","secure","dismissCookieNotice","now","Date","notice","closest","cookies","set","toISOString","launchCookieNotice","agreeButton","agreeButtonSpan","agreeButtonText","display","param","anchor","origin","href","objectToParameters","prepareDropdown","listItems","hideListItems","selectFilter","selectChange","items","item","dataGroup","target","srcElement","selectedIndex","targetListItem","feedbackPage","sendFeedback","toString","handleNo","container","messagePrefix","linkText","link","messageSuffix","childNodes","handleYes","messageText","launchFeedback","questionText","directFeedbackWrapper","directFeedbackForm","directFeedbackFieldset","questionLegend","buttonWrapper","yesButton","noButton","finder__results__bestbet","props","clickTrackingUrl","title","description","propTypes","PropTypes","object","finder__results__course","type","query","string","courseCode","metaData","code","award","qualification","split","join","duration","method","facets","school","clearing","formatLabel","c","finder__results__profile","E","D","headshot","K","J","dependencyMet","facet","facetMap","setFacets","keys","dependency","finder__filters","clearFilters","clear","config","summariseAs","plural","facetLabels","map","meta","response","funnelbackFacet","name","funnelbackName","update","candidate","func","mobile","bool","finder__mobilefilters","setDisplay","useState","focusTrap","setFocusTrap","filters","getFilters","useEffect","activate","createFocusTrap","onDeactivate","clickOutsideDeactivates","disableBodyScroll","deactivate","enableBodyScroll","totalMatching","summary","result","singular","totalMatchingMessage","currEnd","currStart","numRanks","filtersCount","mobilefilters","updating","finder__select","randomNumber","random","currentValue","allFacets","values","reduce","acc","data","responseFacets","responseFacet","categories","hiddenFacets","setFacet","newQuery","newValue","dependencies","startRank","results","updateState","noSelection","i","responseFacetDetails","responseFacetValue","count","arrayOf","finder__toggle","idString","finder__clear","maximumSuggestions","keyCodeEscape","keyCodeUp","keyCodeDown","highlightQueryTerm","suggestion","partialQuery","toLowerCase","finder__query","setPartialQuery","suggestions","setSuggestions","setCall","cancel","inputId","collection","showSuggestions","setShowSuggestions","textInput","focusInput","focus","clearQuery","sortBy","submitForm","submitSuggestion","s","suggestionsList","Set","keyCode","preventDefault","input","suggestionsPromise","newCall","suggest","then","catch","keyCodeEnd","keyCodeHome","activeSuggestionID","setActiveSuggestionID","lastChild","finder__didyoumean","presentableText","text","finder__pagination","numberOfPages","ceil","currentPage","pages","changePage","pageNumber","newStartRank","push","page","abs","number","finder__results","didYouMean","spell","resultsContent","bestBets","card","docNum","prev","concat","finder__results__summary","searchHints","getFacetParams","params","get","facetParams","assign","replaceHistory","currQuery","currStartRank","currFacets","URLSearchParams","delete","hasParams","Finder","initialQuery","fixedFacets","sortDirection","setQuery","setUpdating","setUpdate","request","requestToken","find","updater","newUpdate","initialResponse","funnelbackResponse","setResponse","resultCard","baseUrl","findRootUrl","suggestRootUrl","httpOK","timeout","axiosRequest","axios","status","isCancel","numRank","fixedFacetParams","facetKeys","key","CancelToken","source","baseURL","cancelToken","token","httpsAgent","https","Agent","keepAlive","url","num_ranks","start_rank","partial_query","finderConfig","carouselGallery","defaultCarousel","hidNumInd","thumbnails","rootMargin","edge","edgeThumbnailsObserver","intersectionRatio","thumbnailsObserver","onClickThunbnail","translateThumbnails","x0","locked","sliderTranslateCoOr","lazyImages","IntersectionObserverEntry","prototype","lazyImageObserver","remove","lazyImage","nextSibling","src","a","_C","numInd","numIndActiveSl","numIndSeparator","numbIndSlLength","buttonsWrap","prevBtnWrap","nextBtnWrap","nextBtn","prevBtn","next","previous","innerText","children","sliderLength","setProperty","lock","drag","move","stopDrag","toggle","activeSlider","numIndicator","index","sliders","toArray","tabIndex","toogleNextBtn","checkEventType","tooglePrevBtn","moveSlide","sl","tagName","sliderWidthIndex","totalSliderWidth","sliderWidth","activeThumbnail","unify","changedTouches","clientX","dx","sign","tx","p","animateSlider","stopPropagation","totalWidth","currentStyle","offsetWidth","marginRight","lr","thumbnail","thumbindex","currentThumbnailSpan","listThumbnail","li","thumbnailLi","thumbnailLength","translate","galleria","width","listings","batchQuantity","contentToggles","contentSliders","browserWidth","scrollWidth","getElementById","listingDates","listingsVisible","defaultDuration","edgeOffset","setup","dateTabIndex","listingDate","calculateVisibleListings","defaultListingsDisplay","listElements","launchKeyInfo","digit","counter","listingDisplay","listing","navBtnState","contentToggle","preExpandListingsVisible","targetListing","listingsVisibleLength","listingsLength","remainingItems","promise","Promise","resolve","contentSlider","launchKeyInfoSlider","prependIcon","node","findExternalLink","findDocumentLinks","fileTypes","pdf","docx","doc","xlsx","xls","anchorText","toUpperCase","findLinks","anchors","hashedUrl","loadMoreId","itemsDisplay","visibleItems","loadMoreBtn","scrollToItem","itemsIncrement","targetItem","pushUrlState","parentType","childrenType","wrapperId","targetListingUrlParam","replaceUrlState","launchLoadMore","increment","hashedUrlParts","activeItem","numberFromString","onpopstate","loadMoreIdElement","updatedUrlParts","currentItem","relatedItems","setNavigationItemButtonDetails","rootClass","navigationItem","sectionText","buttonClassName","buttonTextClassName","toggleSubNavigation","scrollList","createScroller","intoView","prepareSubNavigation","navigationItemBtn","controlsClassName","buttonIconClassName","currentClassName","hierarchyClassName","controlsWrapper","prepareNavigation","navigation","subNavigation","textWrapper","currentPageWrapper","cloneNode","listenForNavigationToggles","veilClassName","contentClassName","contentHeaderClassName","buttonDisplayClassName","level1ClassName","menuSetter","setMenu","buttonText","toggleMenu","trap","veil","on","createMenuToggle","child","initialFocus","isVisible","launchMenu","modalBackground","launchModal","modalCustomClass","linkElement","modalCloseElement","addEventListeners","setTabIndexes","openModal","closeModal","addBackgroundFade","trapFocus","removeTabIndex","elements","modalInner","classNameSpecific","topLevelClassName","openCloseTextClassName","navigationTextClassName","openText","closeText","navigationText","keyCodeTab","createCloseAll","buttons","createSectionToggle","closeAll","prepareTopLevel","topLevels","listItem","buttonDiv","srOpenCloseSpan","srNavigationSpan","toggleSection","append","setupTabPrevious","firstButton","restButtons","shiftKey","thisSectionButton","previousSection","previousSectionButton","lastNavigationAnchor","togglePreviousSection","setupTabNext","closeButton","restSectionsCloseButtons","nextSectionButton","toggleNextSection","prepareLowerLevels","wholeText","prepareHeaders","header","addCloseButtons","closeButtonWrapper","closeButtonDiv","closeButtonText","closeButtonIcon","launchPrimaryNavigation","launchSecondaryNavigation","minimumPage","defaultPage","maximumPage","setPageSize","pageSizeSetting","launchPaginatedList","list","Number","pagesize","pageSize","reversed","hasAttribute","pageItems","newList","pageClassName","addPagination","wrapperClassName","controlsElementClassName","ellipsisClassName","summaryClassName","nextPrevRegEx","maximumButtonsToDisplay","createToggleNextPrev","pageCount","toggleNextPrev","setProximity","buttonNumber","proximity","toggleButton","createOpenPage","openPage","pagesArray","controlsArray","createNextPrevOpenPage","newPageFn","nextPrevOpenPage","setSummaryText","itemCount","summaryText","prepareNextPrev","class","btn","btnSpan","createPageButton","totalPages","buttonSpan","pageButtons","ellipsisFirst","ellipsisFirstInner","ellipsisLast","ellipsisLastInner","pageButton","pagecount","showMoreTextElements","createShowMoreButton","handleShowMoreClick","parent","currentTarget","showMoreText","showMoreAnchorLinkText","hiddenElement","maxHeight","headingElement","scrollIntoView","showMoreButtonDiv","showMoreButton","showMoreAnchor","plusIcon","minusIcon","dataTitle","srTextElement","sliderChildren","sliderChildrenLength","updatedPosition","sliderIncrement","currentPosition","sliderDirection","progressUpdate","controlWraps","controlWrap","control","currentGroup","progressIndicator","totalSlides","totalSlidesDisplay","firstInGroup","launchResponsiveSlider","sliderChild","buildControls","deviceType","slides","sliderControlsWrap","createHTMLElement","val","sliderControls","sliderProgress","sliderButtons","parentWrapper","initSlider","handleSlideChange","direction","activeSlide","newSlide","copyIconToClipboard","copy","position","textlink","textnode","range","createRange","selectNode","getSelection","addRange","successful","execCommand","msg","err","Error","removeAllRanges","panelClassName","linksClassName","accordionize","assetid","panel","accordionHeading","accordionWrapper","tabid","linkItems","numberOfTabs","mobiletabs","neveraccordion","endKey","homeKey","arrowLeft","arrowUp","arrowRight","arrowDown","toggleLink","selectTab","newTab","panels","linkItem","selectTabEvent","keyEvents","currentTab","currentTabLI","which","prepareLinks","preparePanels","panelElements","launchTabs","selectedTab","partialMatchFn","m","fullMatchFn","removePartials","matchFn","reducedMotionQuery","matchMedia","matches","getBoundingClientRect","top","parameterString","parameter","parameterObj","event","eventCategory","eventAction","eventLabel","eventValue","nonInteractionHit","dataLayer","pxToRem","pxValue","fontBase","remValue","screen","viewPortWidth","innerWidth","mobileScreen","obj","array","ua","msie","substring","trident","rv","attributes","att"],"mappings":";QAAA;QACA;QACA;QACA;QACA;;QAEA;QACA;QACA;QACA,QAAQ,oBAAoB;QAC5B;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA,iBAAiB,4BAA4B;QAC7C;QACA;QACA,kBAAkB,2BAA2B;QAC7C;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;;QAEA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;QAEA;QACA;QACA;QACA;QACA,gBAAgB,uBAAuB;QACvC;;;QAGA;QACA;QACA;QACA;;;;;;;;;;;;;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;;;AAIb,IAAI,IAAqC;AACzC;AACA;;AAEA,8CAA8C,cAAc;;AAE5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E;AAC1E;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0FAA0F,aAAa;AACvG;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA,gGAAgG,eAAe;AAC/G;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;;AAEhD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;;AC3Oa;;AAEb,IAAI,KAAqC,EAAE,EAE1C;AACD,mBAAmB,mBAAO,CAAC,0FAA+B;AAC1D;;;;;;;;;;;;;;;;;;;;;ACNA;;;;;;;;;AASO,SAASA,cAAT,CACHC,OADG,EAEHC,MAFG,EAKL;AAAA,MAFEC,MAEF,uEAFW,KAEX;AAAA,MADEC,OACF,uEADY;AAAEC,aAAS,EAAE,CAAC,CAAD,EAAI,GAAJ,EAAS,CAAT;AAAb,GACZ;;AACE,MAAIJ,OAAO,IAAI,OAAOA,OAAP,IAAkB,WAA7B,IAA4CA,OAAO,IAAI,IAA3D,EAAiE;AAC7D,QAAIK,oBAAoB,GAAG,SAAvBA,oBAAuB,CAASC,OAAT,EAAkB;AAC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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"main\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"vendor\",\"react\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/** @license React v16.12.0\n * react-is.development.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n\n\nif (process.env.NODE_ENV !== \"production\") {\n  (function() {\n'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n// The Symbol used to tag the ReactElement-like types. If there is no native Symbol\n// nor polyfill, then a plain number is used for performance.\nvar hasSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = hasSymbol ? Symbol.for('react.element') : 0xeac7;\nvar REACT_PORTAL_TYPE = hasSymbol ? Symbol.for('react.portal') : 0xeaca;\nvar REACT_FRAGMENT_TYPE = hasSymbol ? Symbol.for('react.fragment') : 0xeacb;\nvar REACT_STRICT_MODE_TYPE = hasSymbol ? Symbol.for('react.strict_mode') : 0xeacc;\nvar REACT_PROFILER_TYPE = hasSymbol ? Symbol.for('react.profiler') : 0xead2;\nvar REACT_PROVIDER_TYPE = hasSymbol ? Symbol.for('react.provider') : 0xeacd;\nvar REACT_CONTEXT_TYPE = hasSymbol ? Symbol.for('react.context') : 0xeace; // TODO: We don't use AsyncMode or ConcurrentMode anymore. They were temporary\n// (unstable) APIs that have been removed. Can we remove the symbols?\n\nvar REACT_ASYNC_MODE_TYPE = hasSymbol ? Symbol.for('react.async_mode') : 0xeacf;\nvar REACT_CONCURRENT_MODE_TYPE = hasSymbol ? Symbol.for('react.concurrent_mode') : 0xeacf;\nvar REACT_FORWARD_REF_TYPE = hasSymbol ? Symbol.for('react.forward_ref') : 0xead0;\nvar REACT_SUSPENSE_TYPE = hasSymbol ? Symbol.for('react.suspense') : 0xead1;\nvar REACT_SUSPENSE_LIST_TYPE = hasSymbol ? Symbol.for('react.suspense_list') : 0xead8;\nvar REACT_MEMO_TYPE = hasSymbol ? Symbol.for('react.memo') : 0xead3;\nvar REACT_LAZY_TYPE = hasSymbol ? Symbol.for('react.lazy') : 0xead4;\nvar REACT_FUNDAMENTAL_TYPE = hasSymbol ? Symbol.for('react.fundamental') : 0xead5;\nvar REACT_RESPONDER_TYPE = hasSymbol ? Symbol.for('react.responder') : 0xead6;\nvar REACT_SCOPE_TYPE = hasSymbol ? Symbol.for('react.scope') : 0xead7;\n\nfunction isValidElementType(type) {\n  return typeof type === 'string' || typeof type === 'function' || // Note: its typeof might be other than 'symbol' or 'number' if it's a polyfill.\n  type === REACT_FRAGMENT_TYPE || type === REACT_CONCURRENT_MODE_TYPE || type === REACT_PROFILER_TYPE || type === REACT_STRICT_MODE_TYPE || type === REACT_SUSPENSE_TYPE || type === REACT_SUSPENSE_LIST_TYPE || typeof type === 'object' && type !== null && (type.$$typeof === REACT_LAZY_TYPE || type.$$typeof === REACT_MEMO_TYPE || type.$$typeof === REACT_PROVIDER_TYPE || type.$$typeof === REACT_CONTEXT_TYPE || type.$$typeof === REACT_FORWARD_REF_TYPE || type.$$typeof === REACT_FUNDAMENTAL_TYPE || type.$$typeof === REACT_RESPONDER_TYPE || type.$$typeof === REACT_SCOPE_TYPE);\n}\n\n/**\n * Forked from fbjs/warning:\n * https://github.com/facebook/fbjs/blob/e66ba20ad5be433eb54423f2b097d829324d9de6/packages/fbjs/src/__forks__/warning.js\n *\n * Only change is we use console.warn instead of console.error,\n * and do nothing when 'console' is not supported.\n * This really simplifies the code.\n * ---\n * Similar to invariant but only logs a warning if the condition is not met.\n * This can be used to log issues in development environments in critical\n * paths. Removing the logging code for production environments will keep the\n * same logic and follow the same code paths.\n */\nvar lowPriorityWarningWithoutStack = function () {};\n\n{\n  var printWarning = function (format) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    var argIndex = 0;\n    var message = 'Warning: ' + format.replace(/%s/g, function () {\n      return args[argIndex++];\n    });\n\n    if (typeof console !== 'undefined') {\n      console.warn(message);\n    }\n\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) {}\n  };\n\n  lowPriorityWarningWithoutStack = function (condition, format) {\n    if (format === undefined) {\n      throw new Error('`lowPriorityWarningWithoutStack(condition, format, ...args)` requires a warning ' + 'message argument');\n    }\n\n    if (!condition) {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n        args[_key2 - 2] = arguments[_key2];\n      }\n\n      printWarning.apply(void 0, [format].concat(args));\n    }\n  };\n}\n\nvar lowPriorityWarningWithoutStack$1 = lowPriorityWarningWithoutStack;\n\nfunction typeOf(object) {\n  if (typeof object === 'object' && object !== null) {\n    var $$typeof = object.$$typeof;\n\n    switch ($$typeof) {\n      case REACT_ELEMENT_TYPE:\n        var type = object.type;\n\n        switch (type) {\n          case REACT_ASYNC_MODE_TYPE:\n          case REACT_CONCURRENT_MODE_TYPE:\n          case REACT_FRAGMENT_TYPE:\n          case REACT_PROFILER_TYPE:\n          case REACT_STRICT_MODE_TYPE:\n          case REACT_SUSPENSE_TYPE:\n            return type;\n\n          default:\n            var $$typeofType = type && type.$$typeof;\n\n            switch ($$typeofType) {\n              case REACT_CONTEXT_TYPE:\n              case REACT_FORWARD_REF_TYPE:\n              case REACT_LAZY_TYPE:\n              case REACT_MEMO_TYPE:\n              case REACT_PROVIDER_TYPE:\n                return $$typeofType;\n\n              default:\n                return $$typeof;\n            }\n\n        }\n\n      case REACT_PORTAL_TYPE:\n        return $$typeof;\n    }\n  }\n\n  return undefined;\n} // AsyncMode is deprecated along with isAsyncMode\n\nvar AsyncMode = REACT_ASYNC_MODE_TYPE;\nvar ConcurrentMode = REACT_CONCURRENT_MODE_TYPE;\nvar ContextConsumer = REACT_CONTEXT_TYPE;\nvar ContextProvider = REACT_PROVIDER_TYPE;\nvar Element = REACT_ELEMENT_TYPE;\nvar ForwardRef = REACT_FORWARD_REF_TYPE;\nvar Fragment = REACT_FRAGMENT_TYPE;\nvar Lazy = REACT_LAZY_TYPE;\nvar Memo = REACT_MEMO_TYPE;\nvar Portal = REACT_PORTAL_TYPE;\nvar Profiler = REACT_PROFILER_TYPE;\nvar StrictMode = REACT_STRICT_MODE_TYPE;\nvar Suspense = REACT_SUSPENSE_TYPE;\nvar hasWarnedAboutDeprecatedIsAsyncMode = false; // AsyncMode should be deprecated\n\nfunction isAsyncMode(object) {\n  {\n    if (!hasWarnedAboutDeprecatedIsAsyncMode) {\n      hasWarnedAboutDeprecatedIsAsyncMode = true;\n      lowPriorityWarningWithoutStack$1(false, 'The ReactIs.isAsyncMode() alias has been deprecated, ' + 'and will be removed in React 17+. Update your code to use ' + 'ReactIs.isConcurrentMode() instead. It has the exact same API.');\n    }\n  }\n\n  return isConcurrentMode(object) || typeOf(object) === REACT_ASYNC_MODE_TYPE;\n}\nfunction isConcurrentMode(object) {\n  return typeOf(object) === REACT_CONCURRENT_MODE_TYPE;\n}\nfunction isContextConsumer(object) {\n  return typeOf(object) === REACT_CONTEXT_TYPE;\n}\nfunction isContextProvider(object) {\n  return typeOf(object) === REACT_PROVIDER_TYPE;\n}\nfunction isElement(object) {\n  return typeof object === 'object' && object !== null && object.$$typeof === REACT_ELEMENT_TYPE;\n}\nfunction isForwardRef(object) {\n  return typeOf(object) === REACT_FORWARD_REF_TYPE;\n}\nfunction isFragment(object) {\n  return typeOf(object) === REACT_FRAGMENT_TYPE;\n}\nfunction isLazy(object) {\n  return typeOf(object) === REACT_LAZY_TYPE;\n}\nfunction isMemo(object) {\n  return typeOf(object) === REACT_MEMO_TYPE;\n}\nfunction isPortal(object) {\n  return typeOf(object) === REACT_PORTAL_TYPE;\n}\nfunction isProfiler(object) {\n  return typeOf(object) === REACT_PROFILER_TYPE;\n}\nfunction isStrictMode(object) {\n  return typeOf(object) === REACT_STRICT_MODE_TYPE;\n}\nfunction isSuspense(object) {\n  return typeOf(object) === REACT_SUSPENSE_TYPE;\n}\n\nexports.typeOf = typeOf;\nexports.AsyncMode = AsyncMode;\nexports.ConcurrentMode = ConcurrentMode;\nexports.ContextConsumer = ContextConsumer;\nexports.ContextProvider = ContextProvider;\nexports.Element = Element;\nexports.ForwardRef = ForwardRef;\nexports.Fragment = Fragment;\nexports.Lazy = Lazy;\nexports.Memo = Memo;\nexports.Portal = Portal;\nexports.Profiler = Profiler;\nexports.StrictMode = StrictMode;\nexports.Suspense = Suspense;\nexports.isValidElementType = isValidElementType;\nexports.isAsyncMode = isAsyncMode;\nexports.isConcurrentMode = isConcurrentMode;\nexports.isContextConsumer = isContextConsumer;\nexports.isContextProvider = isContextProvider;\nexports.isElement = isElement;\nexports.isForwardRef = isForwardRef;\nexports.isFragment = isFragment;\nexports.isLazy = isLazy;\nexports.isMemo = isMemo;\nexports.isPortal = isPortal;\nexports.isProfiler = isProfiler;\nexports.isStrictMode = isStrictMode;\nexports.isSuspense = isSuspense;\n  })();\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-is.production.min.js');\n} else {\n  module.exports = require('./cjs/react-is.development.js');\n}\n","/**\n *\n * actionOnScroll use the IntersectionObserver API to check if element is intersceting\n *\n * @param {HTMLElement} element - element to observer\n * @param {Action} Function/String - To either excute provided function on element or add the string as a class name\n * @param {Boolean} defualt false - pass true if you want the function to run every time element is Intersecting\n * @param {Object} Object - Pass options to customise IntersectionObserver see docs\n */\nexport function actionOnScroll(\n    element,\n    action,\n    repeat = false,\n    options = { threshold: [0, 0.1, 1] }\n) {\n    if (element && typeof element != 'undefined' && element != null) {\n        let actionOnScrollAction = function(entries) {\n            entries.forEach(entry => {\n                //what to do with element depending on action type\n                if (entry.isIntersecting) {\n                    if (typeof action === 'string') {\n                        element.classList.add(action);\n                    } else if (typeof action === 'function') {\n                        action(element);\n                    }\n                    // stop observing if repeat === false\n                    if (repeat === false) {\n                        observer.unobserve(element);\n                    }\n                }\n            });\n        };\n        //intialise observer and observer element\n        let observer = new IntersectionObserver(actionOnScrollAction, options);\n        observer.observe(element);\n    }\n}\n","/**\n * WAI-ARIA attributes\n *\n * Quicker to type, intellisensible, documents what they're for, and saves a\n * tiny amount of code by replacing the string 'aria-' with a minifiable\n * variable and dot notation.\n *\n * @module aria-attributes\n * @author Web Development\n * @copyright City, University of London 2018\n */\n\n/**\n * @readonly\n * @enum {string}\n */\nconst aria = {\n    /** Identifies the currently active element when DOM focus is on a composite widget, textbox, group, or application. */\n    activeDescendant: 'aria-activedescendant',\n    /** Indicates whether assistive technologies will present all, or only parts of, the changed region based on the change notifications defined by the aria-relevant attribute. */\n    atomic: 'aria-atomic',\n    /** Indicates whether inputting text could trigger display of one or more predictions of the user's intended value for an input and specifies how predictions would be presented if they are made. */\n    autoComplete: 'aria-autocomplete',\n    /** Indicates an element is being modified and that assistive technologies MAY want to wait until the modifications are complete before exposing them to the user. */\n    busy: 'aria-busy',\n    /** Indicates the current \"checked\" state of checkboxes, radio buttons, and other widgets. */\n    checked: 'aria-checked',\n    /** Defines the total number of columns in a table, grid, or treegrid. */\n    colCount: 'aria-colcount',\n    /** Defines an element's column index or position with respect to the total number of columns within a table, grid, or treegrid. */\n    colIndex: 'aria-colindex',\n    /** Defines the number of columns spanned by a cell or gridcell within a table, grid, or treegrid. */\n    colSpan: 'aria-colspan',\n    /** Identifies the element (or elements) whose contents or presence are controlled by the current element. */\n    controls: 'aria-controls',\n    /** Indicates the element that represents the current item within a container or set of related elements. */\n    current: 'aria-current',\n    /** Identifies the element (or elements) that describes the object. */\n    describedBy: 'aria-describedby',\n    /** Identifies the element that provides a detailed, extended description for the object. */\n    details: 'aria-details',\n    /** Indicates that the element is perceivable but disabled, so it is not editable or otherwise operable. */\n    disabled: 'aria-disabled',\n    /** [Deprecated in ARIA 1.1] Indicates what functions can be performed when a dragged object is released on the drop target. */\n    dropEffect: 'aria-dropeffect',\n    /** Identifies the element that provides an error message for the object. */\n    errorMessage: 'aria-errormessage',\n    /** Indicates whether the element, or another grouping element it controls, is currently expanded or collapsed. */\n    expanded: 'aria-expanded',\n    /** Identifies the next element (or elements) in an alternate reading order of content which, at the user's discretion, allows assistive technology to override the general default of reading in document source order. */\n    flowTo: 'aria-flowto',\n    /** [Deprecated in ARIA 1.1] Indicates an element's \"grabbed\" state in a drag-and-drop operation. */\n    grabbed: 'aria-grabbed',\n    /** Indicates the availability and type of interactive popup element, such as menu or dialog, that can be triggered by an element. */\n    hasPopup: 'aria-haspopup',\n    /** Indicates whether the element is exposed to an accessibility API. */\n    hidden: 'aria-hidden',\n    /** Indicates the entered value does not conform to the format expected by the application. */\n    invalid: 'aria-invalid',\n    /** Indicates keyboard shortcuts that an author has implemented to activate or give focus to an element. */\n    keyShortcuts: 'aria-keyshortcuts',\n    /** Defines a string value that labels the current element. */\n    label: 'aria-label',\n    /** Identifies the element (or elements) that labels the current element. */\n    labelledBy: 'aria-labelledby',\n    /** Defines the hierarchical level of an element within a structure. */\n    level: 'aria-level',\n    /** Indicates that an element will be updated, and describes the types of updates the user agents, assistive technologies, and user can expect from the live region. */\n    live: 'aria-live',\n    /** Indicates whether an element is modal when displayed. */\n    modal: 'aria-modal',\n    /** Indicates whether a text box accepts multiple lines of input or only a single line. */\n    multiLine: 'aria-multiline',\n    /** Indicates that the user may select more than one item from the current selectable descendants. */\n    multiSelectable: 'aria-multiselectable',\n    /** Indicates whether the element's orientation is horizontal, vertical, or unknown/ambiguous. */\n    orientation: 'aria-orientation',\n    /** Identifies an element (or elements) in order to define a visual, functional, or contextual parent/child relationship between DOM elements where the DOM hierarchy cannot be used to represent the relationship. */\n    owns: 'aria-owns',\n    /** Defines a short hint (a word or short phrase) intended to aid the user with data entry when the control has no value. A hint could be a sample value or a brief description of the expected format. */\n    placeholder: 'aria-placeholder',\n    /** Defines an element's number or position in the current set of listitems or treeitems. Not required if all elements in the set are present in the DOM. */\n    posInset: 'aria-posinset',\n    /** Indicates the current \"pressed\" state of toggle buttons. */\n    pressed: 'aria-pressed',\n    /** Indicates that the element is not editable, but is otherwise operable. */\n    readOnly: 'aria-readonly',\n    /** Indicates what notifications the user agent will trigger when the accessibility tree within a live region is modified. */\n    relevant: 'aria-relevant',\n    /** Indicates that user input is required on the element before a form may be submitted. */\n    required: 'aria-required',\n    /** Defines a human-readable, author-localized description for the role of an element. */\n    roleDescription: 'aria-roledescription',\n    /** Defines the total number of rows in a table, grid, or treegrid. */\n    rowCount: 'aria-rowcount',\n    /** Defines an element's row index or position with respect to the total number of rows within a table, grid, or treegrid. */\n    rowIndex: 'aria-rowindex',\n    /** Defines the number of rows spanned by a cell or gridcell within a table, grid, or treegrid. */\n    rowSpan: 'aria-rowspan',\n    /** Indicates the current \"selected\" state of various widgets. */\n    selected: 'aria-selected',\n    /** Defines the number of items in the current set of listitems or treeitems. Not required if all elements in the set are present in the DOM. */\n    setSize: 'aria-setsize',\n    /** Indicates if items in a table or grid are sorted in ascending or descending order. */\n    sort: 'aria-sort',\n    /** Defines the maximum allowed value for a range widget. */\n    valueMax: 'aria-valuemax',\n    /** Defines the minimum allowed value for a range widget. */\n    valueMin: 'aria-valuemin',\n    /** Defines the current value for a range widget. */\n    valueNow: 'aria-valuenow',\n    /** Defines the human readable text alternative of aria-valuenow for a range widget. */\n    valueText: 'aria-valuetext',\n};\n\nexport default Object.freeze(aria);\n","/**\n * Main entry\n *\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport patterns from './patterns';\nimport { removeClass, parametersToObject, gaEvent, detectIE } from './util';\nimport { devcorate } from './patterns/devcorate/devcorate';\nimport prepareAccordionTabs from './patterns/tabs/prepareAccordionTabs';\n\n/**\n * try a function, log the error if it throws an exception.\n *\n * @param {Function} f - The function to call.\n */\nexport function tryCatch(f) {\n    try {\n        return f();\n    } catch (e) {\n        // console.log(e);\n        gaEvent(\n            'jsError',\n            'JavaScript error',\n            `Line ${e.lineNumber}  ${e.message}`,\n            `Pattern launch ${e.fileName} (${window.location})`,\n            true\n        );\n    }\n}\n\n/**\n * Runs the function for each pattern against every element that has the\n * matching class, unless the element also has that class with a '-no-js' suffix\n * (for cases where you want to use the CSS for a pattern, but not the\n * functionality).\n *\n * @param {object} pattern - An object containing the class name to trigger the pattern and the launch function to run for those elements.\n */\nfunction launchPattern(pattern) {\n    if (typeof pattern === 'function') {\n        tryCatch(pattern);\n    } else if (pattern.launchQuery) {\n        const { launchFn, launchQuery } = pattern;\n        Array.from(document.querySelectorAll(launchQuery))\n            .filter(elem => elem.className.indexOf(`${launchQuery}-no-js`))\n            .forEach(elem => tryCatch(() => launchFn(elem)));\n    }\n}\n\n/**\n * Recursively generate accordion--tabs HTML for tabs.\n *\n * @param {HTMLElement} root\n */\nfunction accordionizeTabs(root) {\n    Array.from(root.querySelectorAll('.tabs'))\n        .filter(elem => elem.className.indexOf('.tabs-no-js'))\n        .forEach(elem => {\n            const potential = tryCatch(() => prepareAccordionTabs(elem));\n            potential && accordionizeTabs(potential);\n        });\n}\n\ndocument.addEventListener(\n    'DOMContentLoaded',\n    () => {\n        if (/(Trident|MSIE)/.test(navigator.userAgent)) {\n            return;\n        } else {\n            // disable for now\n            // if ('serviceWorker' in navigator) {\n            //     window.addEventListener('load', function() {\n            //         navigator.serviceWorker\n            //             .register('sw.js')\n            //             .then(function() {}, function() {});\n            //     }, false);\n            // }\n            Array.from(document.getElementsByTagName('html')).forEach(html => {\n                let ie = detectIE();\n                removeClass(html, 'no-js', false);\n                if (ie >= 12) {\n                    html.className = (html.className + ' js ' + 'edge').trim();\n                } else {\n                    html.className = (html.className + ' js').trim();\n                }\n            });\n\n            accordionizeTabs(document);\n            patterns.forEach(launchPattern);\n\n            const parameters = parametersToObject(location.search);\n            parameters['dev'] &&\n                devcorate(\n                    document.querySelector('body'),\n                    'dev',\n                    parameters['dev']\n                );\n            parameters['rel'] &&\n                devcorate(\n                    document.querySelector('body'),\n                    'rel',\n                    parameters['rel']\n                );\n        }\n    },\n    false\n);\n","/**\n * Pattern library\n *\n * Exports an array of patterns to execute on startup.\n *\n * @module patterns\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport accordion from './patterns/accordion/accordion';\nimport backToTop from './patterns/back-to-top/back-to-top';\nimport carousel from './patterns/image-carousel/image-carousel';\nimport cmsEditorWarning from './patterns/cms-editor-warning/cms-editor-warning';\nimport contentFadeIn from './patterns/animation/content-fade-in/content-fade-in';\nimport contentSeparator from './patterns/animation/content-separator/content-separator';\nimport contentSlideUp from './patterns/animation/content-slide-up/content-slide-up';\nimport svgPathAnimation from './patterns/animation/svg-path-animation/svg-path-animation';\nimport cookieNotice from './patterns/cookie-notice/cookie-notice';\nimport feedback from './patterns/feedback/feedback';\nimport finder from './patterns/finder/finder';\nimport finderMini from './patterns/finder/finder-mini';\n\nimport gallery from './patterns/image-carousel/default-carousel/default-carousel';\nimport imageExpand from './patterns/animation/image-expand/image-expand';\nimport keyInfoSlider from './patterns/key-info-box/key-info-slider';\nimport linkFinder from './patterns/link-finder/link-finder';\nimport loadMore from './patterns/load-more/load-more';\nimport menu from './patterns/menu/menu';\nimport modal from './patterns/modal/modal';\nimport numberAnimation from './patterns/animation/number-animation/number-animation';\nimport paginatedList from './patterns/paginated-list/paginated-list';\nimport pagination from './patterns/pagination/pagination';\nimport primaryNavigation from './patterns/navigation/navigation-primary';\nimport secondaryNavigation from './patterns/navigation/navigation-secondary';\nimport showMore from './patterns/show-more/show-more';\nimport slider from './patterns/slider/slider';\nimport sliderResponsive from './patterns/slider-responsive/slider-responsive';\nimport socialIcon from './patterns/social-icon/social-icon';\nimport tabs from './patterns/tabs/tabs';\nimport dropdownFilter from './patterns/dropdown-filter/dropdown-filter';\n\nexport default [\n    accordion,\n    cmsEditorWarning,\n    cookieNotice,\n    feedback,\n    finder,\n    finderMini,\n    keyInfoSlider,\n    loadMore,\n    menu,\n    primaryNavigation,\n    secondaryNavigation,\n    paginatedList,\n    pagination,\n    tabs,\n    linkFinder,\n    contentSeparator,\n    imageExpand,\n    contentFadeIn,\n    contentSlideUp,\n    modal,\n    socialIcon,\n    slider,\n    sliderResponsive,\n    carousel,\n    numberAnimation,\n    showMore,\n    gallery,\n    svgPathAnimation,\n    backToTop,\n    dropdownFilter,\n];\n","/**\n * Accordion\n *\n * @module patterns/accordion/accordion\n * @author Web Development\n * @copyright City, University of London 2018-2019\n */\nimport scroll from 'zenscroll';\nimport aria from '../../aria-attributes';\nimport {\n    appendAll,\n    reduceMotion,\n    removeClass,\n    toBool,\n    verticallyInWindow,\n} from '../../util';\n\nconst className = 'accordion',\n    headingClassName = className + '__heading',\n    headingTextClassName = headingClassName + '__text',\n    headingIconClassName = headingClassName + '__indicator fal',\n    bodyClassName = className + '__body',\n    scrollDuration = reduceMotion() ? 0 : 999,\n    scrollTo = true;\n\n/**\n * Sets a heading and the button nested within to be open or closed.\n *\n * @param {HTMLHeadingElement} heading - An accordion heading.\n * @param {boolean} open - Set this section to be open?\n */\nfunction setSection(heading, open) {\n    heading.dataset.open = open;\n    heading.firstElementChild.setAttribute(aria.expanded, open);\n}\n\n/**\n * Open a section, calculate its height, then close it again.\n *\n * With no transition, this is essentially invisible to the user.\n *\n * @param {HTMLHeadingElement} heading - An accordion heading.\n * @return {string} The pixel height of the section when open.\n */\nfunction calculateAccordionBodyHeight(heading) {\n    const section = heading.nextElementSibling;\n\n    setSection(heading, true);\n    section.dataset.closed = 'false';\n    const height = section.offsetHeight + 'px';\n\n    setSection(heading, false);\n    section.dataset.closed = 'true';\n\n    return height;\n}\n\n/**\n * Set style properties for transition.\n *\n * @param {HTMLElement} element - The section to transition.\n * @param {string} initialHeight - The initial height from which to transition.\n */\nfunction setupTransition(element, initialHeight) {\n    element.style.height = initialHeight;\n    element.dataset.closed = 'false';\n    return true;\n}\n\n/**\n * Cleanup after transition.\n *\n * @param {HTMLElement} accordionSection - The section that transitioned.\n */\nfunction cleanupTransition(section) {\n    const open = toBool(section.previousElementSibling.dataset.open);\n    section.style.height = null;\n    section.dataset.closed = open ? 'false' : 'true';\n}\n\n/**\n * Respond to button clicks - open if closed, close if open.\n *\n * If opening, will also push the heading ID into the history, so C+Ping the URL\n * will open the most recently viewed section. Closing a section removes any\n * hash.\n *\n * @param {HTMLButtonElement} button - The button that was clicked.\n * @param {HTMLElement[]} headings - All headings in this accordion.\n * @param {boolean} [toggleOpen] - Should other accordion sections close? Default to false.\n */\nfunction buttonClick(button, headings, toggleOpen) {\n    const heading = button.parentNode,\n        accordionSection = heading.nextElementSibling;\n\n    /**\n     * After we've transitioned the opening/closing, we want to revert to\n     * letting the CSS size the element. Add a listener to do this that will\n     * self-destruct after running.\n     */\n    accordionSection.addEventListener(\n        'transitionend',\n        () => cleanupTransition(accordionSection),\n        { capture: true, once: true }\n    );\n\n    if (toBool(button.getAttribute(aria.expanded))) {\n        // Starting height is the current height\n        setupTransition(accordionSection, accordionSection.offsetHeight + 'px');\n        // setTimeout lets the DOM recalculate before we continue, so the transition will fire\n        setTimeout(() => {\n            accordionSection.style.height = '0px';\n        }, 0);\n\n        history.pushState(\n            null,\n            null,\n            `${window.location.pathname}${window.location.search}`\n        );\n\n        setSection(heading, false);\n    } else {\n        // Calclulate and save how big we're transitioning to\n        const sectionHeight = calculateAccordionBodyHeight(heading);\n        // Starting height is 0\n        setupTransition(accordionSection, '0px');\n        // setTimeout lets the DOM recalculate before we continue, so the transition will fire\n        setTimeout(() => {\n            accordionSection.style.height = sectionHeight;\n        }, 0);\n\n        // If we already have history, replace it rather than adding to it.\n        if (window.location.hash) {\n            history.replaceState(null, null, '#' + heading.id);\n        } else {\n            history.pushState(null, null, '#' + heading.id);\n        }\n\n        if (toggleOpen) {\n            const sections = Array.from(\n                heading.parentNode.parentNode.querySelectorAll(\n                    `#${heading.parentElement.id} > .${bodyClassName}`\n                )\n            );\n            headings.forEach(heading => setSection(heading, false));\n            sections\n                .filter(section => section.id !== accordionSection.id)\n                .forEach(section => {\n                    section.dataset.closed = 'true';\n                });\n        }\n        setSection(heading, true);\n\n        if (\n            scrollTo &&\n            !(\n                verticallyInWindow(heading) &&\n                verticallyInWindow(accordionSection)\n            )\n        ) {\n            scroll.to(heading, scrollDuration);\n        }\n    }\n}\n\n/**\n * Create a button from the text content of a heading.\n *\n * @param {HTMLElement} heading - An accordion heading.\n * @returns {HTMLButtonElement} An accordion section button.\n */\nfunction buttonFromHeading(heading) {\n    const button = document.createElement('button'),\n        // Chrome can't apply grid layout to buttons, need to wrap contents\n        wrapper = document.createElement('div'),\n        textSpan = document.createElement('span'),\n        iconSpan = document.createElement('span');\n\n    textSpan.className = headingTextClassName;\n    iconSpan.className = headingIconClassName;\n    iconSpan.setAttribute(aria.hidden, true);\n    button.setAttribute('type', 'button');\n\n    textSpan.appendChild(document.createTextNode(heading.textContent));\n    appendAll(wrapper, [textSpan, iconSpan]);\n    button.appendChild(wrapper);\n\n    return button;\n}\n\n/**\n * Transform an element with the accordion class into an accordion.\n *\n * accordions should contain an even number of children, alternating headings\n * and content elements. The element type is unimportant - headings should have\n * the headingClassName - but headings should contain only text, no other\n * children.\n *\n * e.g.\n *\n * <div class=\"accordion\">\n * <h2 class=\"accordion__heading\">Heading 1</h2>\n * <div>Content 1</div>\n * <h2 class=\"accordion__heading\">Heading 2</h2>\n * <div>Content 2</div>\n * </div>\n *\n * @param {HTMLElement} accordion - An HTML element with the accordion class.\n */\nfunction launchAccordion(accordion) {\n    const locationHash = window.location.hash.substr(1),\n        toggleOpen = toBool(accordion.dataset.toggleopen),\n        defaultOpen = toBool(accordion.dataset.defaultopen),\n        allowSingle = toBool(accordion.dataset.allowsingle),\n        headings = Array.from(\n            accordion.parentNode.querySelectorAll(\n                `#${accordion.id} > .${headingClassName}`\n            )\n        );\n\n    let idLinked = false;\n\n    if (!(allowSingle || headings.length > 1)) {\n        /**\n         * not enough content to accordion\n         */\n        removeClass(accordion, className, false);\n        return;\n    }\n\n    headings.forEach(heading => {\n        const content = heading.nextElementSibling,\n            button = buttonFromHeading(heading);\n\n        content.setAttribute(aria.labelledBy, heading.id);\n        content.setAttribute('role', 'region');\n        heading.replaceChild(button, heading.firstChild);\n\n        /**\n         * if the location hash matches the heading's ID, we'll open that\n         * instead of the first section, or instead of leaving everything\n         * closed.\n         */\n        if (locationHash === heading.id) {\n            idLinked = true;\n            setSection(heading, true);\n        } else {\n            setSection(heading, false);\n            heading.nextElementSibling.dataset.closed = 'true';\n        }\n\n        button.addEventListener(\n            'click',\n            () => buttonClick(button, headings, toggleOpen),\n            true\n        );\n    });\n\n    /* Show first item of accordion, if accordion is set to default open,\n           and we haven't linked to a specific section */\n    if (defaultOpen && !idLinked) {\n        setSection(headings[0], true);\n        headings[0].nextElementSibling.dataset.closed = 'false';\n    }\n}\n\nexport default {\n    launchFn: launchAccordion,\n    launchQuery: `.${className}`,\n};\n","/**\n *  Animates content section to fade in and upwards on down scroll\n *\n * @module paint-layouts/case-study-transition-effects/content-section\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019!\n */\n\nimport { isMobile } from '../../../util';\n\nconst className = 'content-fade-in';\n\nfunction contentFadeIn(contentFadein) {\n    const viewPortHeight = window.innerHeight; // calculates viewport height\n\n    if (!isMobile()) {\n        contentFadein.classList.add('content-fade-in--start');\n\n        window.addEventListener('scroll', function() {\n            const elemOffset = contentFadein.offsetTop;\n            const screenPos = window.pageYOffset; // calculates scroll position\n\n            if (\n                screenPos > elemOffset - viewPortHeight + 10 &&\n                !contentFadein.className.includes('content-fade-in--complete')\n            ) {\n                contentFadein.classList.add('content-fade-in--complete');\n            }\n        });\n    }\n}\n\nexport default {\n    launchFn: contentFadeIn,\n    launchQuery: `.${className}`,\n};\n","/**\n * Leading separator transition\n *\n * @module paint-layouts/case-study-transition-effects/leading-separator\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019!\n */\n\nimport { isMobile } from '../../../util';\n\nconst className = 'content-separator-container';\n\n/**\n *\n * @param {HTMLElement} contentSeparatorContainer: the separator is the\n * first child of this container\n *\n */\nfunction contentSeparator(contentSeparatorContainer) {\n    const viewPortHeight = window.innerHeight; // calculates viewport height\n\n    let el = insertElement(contentSeparatorContainer);\n\n    if (!isMobile()) {\n        el.classList.add('content-separator--transition-start');\n        window.addEventListener('scroll', function() {\n            const elemOffset = el.offsetTop;\n            const screenPos = window.pageYOffset; // calculates scroll position\n\n            if (\n                screenPos > elemOffset - viewPortHeight + 20 &&\n                !el.className.includes('content-separator--transition-complete')\n            ) {\n                el.classList.add('content-separator--transition-complete');\n            }\n        });\n    }\n}\n\n/**\n *\n * @param {HTMLElement} contentSeparatorContainer: the separator is the\n * first child of this container\n *\n * @returns {HTMLElement} el: the element that has the transition\n *\n */\nfunction insertElement(contentSeparatorContainer) {\n    let el = document.createElement('div');\n    el.setAttribute('class', 'content-separator');\n    contentSeparatorContainer.prepend(el);\n\n    return el;\n}\n\nexport default {\n    launchFn: contentSeparator,\n    launchQuery: `.${className}`,\n};\n","/**\n * Background slideup transition, Animates content to slide up on down scroll\n *\n * @module paint-layouts/case-study-transition-effects/content-slideup\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019!\n */\n\nimport { isMobile } from '../../../util';\n\nconst className = 'content-slide-up';\n\nfunction contentSlideUp(contentSlideup) {\n    const viewPortHeight = window.innerHeight; // calculates viewport height\n\n    if (!isMobile()) {\n        contentSlideup.classList.add('content-slideup--start');\n        window.addEventListener('scroll', function() {\n            const screenPos = window.pageYOffset; // calculates scroll position\n            const elemOffsetTop = contentSlideup.offsetTop; // calculates element offset from top to the page\n            const parentElemHeight =\n                contentSlideup.parentElement.offsetHeight -\n                parseInt(\n                    window\n                        .getComputedStyle(contentSlideup.parentElement, null)\n                        .getPropertyValue('padding-bottom')\n                ) -\n                parseInt(\n                    window\n                        .getComputedStyle(contentSlideup.parentElement, null)\n                        .getPropertyValue('padding-top')\n                );\n\n            if (\n                screenPos >\n                    elemOffsetTop -\n                        viewPortHeight -\n                        (parentElemHeight * 70) / 100 &&\n                !contentSlideup.className.includes('content-slideup--end')\n            ) {\n                contentSlideup.classList.add('content-slideup--end');\n            }\n        });\n    }\n}\n\nexport default {\n    launchFn: contentSlideUp,\n    launchQuery: `.${className}`,\n};\n","/**\n * Image transition\n *\n * @module paint-layouts/case-study-transition-effects/banner-image\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019!\n */\n\nimport { isMobile } from '../../../util';\n\nconst className = 'image-expand';\n\nfunction imageExpand(image) {\n    if (!isMobile()) {\n        const viewPortHeight = window.innerHeight; // calculates viewport height\n\n        image.classList.add('image-expand--start');\n\n        window.addEventListener('scroll', function() {\n            const elemOffset = image.offsetTop;\n            const screenPos = window.pageYOffset; // calculates scroll position\n\n            if (\n                screenPos > elemOffset - viewPortHeight + 100 &&\n                !image.className.includes('image-expand--complete')\n            ) {\n                image.classList.add('image-expand--complete');\n            }\n        });\n    }\n}\n\nexport default {\n    launchFn: imageExpand,\n    launchQuery: `.${className}`,\n};\n","import { actionOnScroll } from '../../../action-on-scroll';\nimport { checkIntersectionObserver } from '../../../util';\n\nconst className = 'animate-number';\nconst DURATION = 1500; // set duration variable 1500 ms increase if want longer animation\n\n/**\n *\n * find container containing the number\n *\n * @param {HTMLElement} element - html element to be animated\n * @return {HTMLElement} element - if element to be animated is found return it else return original element\n */\n\nfunction findNumberContainer(widget) {\n    const nested = widget.querySelector('.animate--number__number');\n    return typeof nested != 'undefined' && nested != null ? nested : widget;\n}\n\n/**\n *\n * Intial setup\n * add data attr : data-animation-number-value - number to animate\n * add data attr : data-animation-number-float - boolean value if number is float\n * add data attr : data-animation-numner-start - number value of where to start animation from\n * add class name - animate--number--init\n *\n * @param {HTMLElement} element - The section that need to be animated\n * @return {boolean} - if number animation is setup?\n */\n\nfunction initNumberAnimation(widget) {\n    const startStr = widget.dataset.animationNumberStart || '0';\n    const start = parseFloat(startStr);\n    const numberContainer = findNumberContainer(widget);\n    const numberStr = numberContainer.innerHTML.trim().replace(/,/g, '');\n    if (numberStr.match(/^-?[0-9,]+(\\.[0-9,]+])?/)) {\n        widget.dataset.animationNumberValue = parseFloat(numberStr);\n        widget.dataset.animationNumberFloat = !!numberStr.match(/\\./);\n        widget.dataset.animationNumberStart = start;\n        numberContainer.innerHTML = startStr;\n        widget.classList.add('animate--number--init');\n        return true;\n    } else {\n        return false;\n    }\n}\n\n/**\n *\n * run animation function\n *\n * @param {HTMLElement} element - element to be animated\n */\n\nfunction runNumberAnimation(widget) {\n    const numberContainer = findNumberContainer(widget);\n\n    const isFloat = widget.dataset.animationNumberFloat;\n    const value = parseInt(widget.dataset.animationNumberValue);\n\n    if (value !== 0) {\n        let first = true;\n        let startTime = 0;\n        let startValue = parseInt(widget.dataset.animationNumberStart);\n        let lastValue = 0;\n\n        /**\n         * function to run animation\n         *\n         * @param {timestamp} time stamp - time stamp from requestAnimationFrame API\n         */\n\n        const f = timestamp => {\n            if (first) {\n                startTime = timestamp;\n                first = false;\n            }\n            const t = (timestamp - startTime) / DURATION;\n            // difference in time between two discrete points in time divied by duration\n\n            const finish = t >= 1;\n\n            let k = finish ? 1 : 1 - Math.pow(1 - t, 4);\n\n            let v = k * (value - startValue) + startValue;\n\n            if (isFloat) {\n                v = Math.round(v);\n            }\n\n            if (lastValue !== v) {\n                lastValue = v;\n                numberContainer.innerHTML = v.toLocaleString('en-GB'); // append and format to GB\n            }\n\n            if (finish) {\n                //end of animation\n                widget.classList.add('animate--number--complete');\n            } else {\n                //repeat call requestAnimationFrame until finish is true\n                window.requestAnimationFrame(f);\n            }\n        };\n        /**\n         * run requestAnimationFrame to repaint animation to screen\n         */\n\n        window.requestAnimationFrame(f);\n    }\n}\n\n/**\n *\n * Intial setup\n *\n * number animation should contain a wrapper with a class name 'animate-number'\n * there should be at least one child element with a class name 'animate--number__heading'\n * and a span element with a class name 'animate--number__number' containing the number\n *\n * e.g.\n *\n * <div class=\"animate-number\">\n *  <h2 class=\"animate animate--number__heading\">\n *      <span class=\"animate--number__number\">10,000</span>\n *  </h2>\n * </div>\n *\n * @param {HTMLElement} elm - An HTML element with the 'animate-number' class.\n *\n */\n\nfunction init(elm) {\n    const lazyNumbers = [].slice.call(elm.querySelectorAll('.animate--number'));\n    /**\n     * check if browser support IntersectionObserver api\n     */\n\n    if (checkIntersectionObserver()) {\n        lazyNumbers.forEach(function(lazyUnit) {\n            initNumberAnimation(lazyUnit);\n            /**\n             * pass the element and function to actionOnScroll\n             * to animate when element is intersecting\n             */\n            actionOnScroll(lazyUnit, runNumberAnimation);\n        });\n    }\n}\n\nexport default {\n    launchFn: init,\n    launchQuery: `.${className}`,\n};\n","/**\n * SVG path animation\n *\n * @module patterns/animation/svg path\n * @author adapted by Walter Reyneke <walter.reyneke@city.ac.uk> from CASS polaris\n * @copyright City, University of London 2019!\n */\n\nconst className = 'animate-svg';\n\n/**\n * This animation targets SVG paths. When in scrolling distance the path will animated from a starting position of zero till the full length of the path is shown.\n *\n * @param {class} animateSvg - Selects a parent class which will contain the paths targetted for animation\n *\n */\n\nfunction initSvgPathAnimation(animateSvg) {\n    const viewPortHeight = window.innerHeight; // calculates viewport height\n\n    window.addEventListener('DOMContentLoaded', () => {\n        var paths = animateSvg.querySelectorAll('.animate--svg-path');\n\n        // prepares the animation\n        paths.forEach(path => {\n            let length = path.getTotalLength() + 'px';\n            path.classList.add('animate--svg-path--jsinit');\n\n            path.style.strokeDashoffset = length;\n            path.style.strokeDasharray = `${length}, ${length}`;\n        });\n\n        // starts animation when in scrolling view\n        window.addEventListener('scroll', function() {\n            const elemOffset = animateSvg.offsetTop;\n            const screenPos = window.pageYOffset; // calculates scroll position\n\n            if (screenPos > elemOffset - viewPortHeight + 30) {\n                paths.forEach(function(path) {\n                    !path.classList.contains('animate--svg-path--jsrun')\n                        ? path.classList.add('animate--svg-path--jsrun')\n                        : null;\n                    setTimeout(() => {\n                        path.style.strokeDashoffset = 0;\n                    }, 100);\n                });\n            }\n        });\n    });\n}\n\nexport default {\n    launchFn: initSvgPathAnimation,\n    launchQuery: `.${className}`,\n};\n","/**\n * Back To Top Link Scroll\n *\n * @module patterns/back-to-top/back-to-top\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019\n */\n\nconst className = 'back-to-top',\n    viewPortHeight = window.innerHeight;\n\n/**\n * Back to top anchor anchor only appears on long pages and when you have scrolled down long enough\n *\n * Please change the parameters below to alter the behaviour of the back to top anchor.\n *\n * pageHeight - only appears on long pages which are 'X' times the viewport height.\n * scrollPos - sets how many viewport heights you need to scroll down for back to top to appear. 1 = 1 viewport height\n */\nconst pageHeight = 1.5,\n    scrollPos = 1;\n\n/**\n *  Initialises back to top anchor for long pages only\n *\n * @param {HTMLElement} - selects back to top parent element, which is used in return to select children elements\n */\nfunction initBacktoTop(backToTop) {\n    const backToTopAnchor = backToTop.querySelectorAll('a')[0];\n\n    window.addEventListener('load', function() {\n        const documentHeight = document.body.clientHeight,\n            backToTopDock = backToTop.offsetTop,\n            // deadzone is the 'area' when you scroll to the bottom of the\n            // page, where the back to top botton docks back into the footer\n            deadZone = backToTopDock - viewPortHeight;\n\n        if (\n            documentHeight > viewPortHeight * pageHeight &&\n            deadZone > viewPortHeight * scrollPos + viewPortHeight\n        ) {\n            // this route is for pages long enough to have the back to top\n            // anchor stick to the right and eventually dock in the footer\n            // once you reach the bottom of the page\n            backToTop.setAttribute('hidden', 'true');\n\n            window.addEventListener(\n                'scroll',\n                () => {\n                    updateProgress(backToTopAnchor);\n                    showAnchor(backToTop, deadZone);\n                },\n                false\n            );\n        } else if (documentHeight > viewPortHeight * pageHeight) {\n            // this route is for odd pages just long enough for anchor to appear\n            // in footer once scrolled down, but no long enough to have space\n            // for a sticky anchor to sit in the corner while scrolling.\n            backToTop.dataset.docked = 'true';\n        }\n    });\n}\n/**\n *  Anchor fading behaviour\n *\n * @param {HTMLElement} backToTop - back to top element.\n * @param {Number} deadZone - deadzone is the 'area' identified by vertical scroll position, when you scroll to the bottom of the page, where the back to top botton docks back into the footer.\n */\nfunction showAnchor(backToTop, deadZone) {\n    const positionOnScreen = window.pageYOffset;\n\n    if (\n        positionOnScreen < deadZone &&\n        positionOnScreen > viewPortHeight * scrollPos\n    ) {\n        // shows anchor when scrolled down far enough - see parameters\n        backToTop.dataset.docked = 'false';\n        backToTop.removeAttribute('hidden');\n    } else if (positionOnScreen < 200) {\n        // hides anchor when close to top of the page\n        backToTop.setAttribute('hidden', 'true');\n        backToTop.dataset.docked = 'false';\n    } else if (positionOnScreen >= deadZone) {\n        // docks anchor in footer when reaching bottom of the page\n        backToTop.removeAttribute('hidden');\n        backToTop.dataset.docked = 'true';\n    }\n}\n\n/**\n *  Progress meter\n *\n * @param {HTMLElement} backToTopAnchor - The anchor of the back to top element.\n */\nfunction updateProgress(backToTopAnchor) {\n    // Setting up SVG animation\n    const progressPath = backToTopAnchor.querySelector('path'),\n        pathLength = progressPath.getTotalLength();\n\n    progressPath.style.strokeDasharray = pathLength + ' ' + pathLength;\n    progressPath.style.strokeDashoffset = pathLength;\n\n    // Calculate values\n    const scroll = window.pageYOffset,\n        height = document.documentElement.scrollHeight - window.innerHeight,\n        progress = pathLength - (scroll * pathLength) / height;\n\n    // Updates progress bar\n    progressPath.style.strokeDashoffset = progress;\n}\n\nexport default {\n    launchFn: initBacktoTop,\n    launchQuery: `.${className}`,\n};\n","/**\n * Warning removal\n *\n * @module patterns/cms-editor-warning/cms-editor-warning\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport { removeClass } from '../../util';\n\nconst className = 'cms-editor',\n    warningClass = className + '-warning',\n    buttonClass = warningClass + '-remover',\n    wrapperClass = 'wrapper--' + buttonClass;\n\n/**\n * Create a warning remover button.\n *\n * @returns {HTMLButtonElement} A button element.\n */\nfunction createButton() {\n    const button = document.createElement('button');\n    button.className = buttonClass;\n    button.setAttribute('type', 'button');\n    button.appendChild(document.createTextNode('Remove CMS editor warnings'));\n    return button;\n}\n\n/**\n * The Web 2020 design adds a class .cms-editor to the body tag if the current\n * has write access to the page.\n *\n * If there are any CMS editor warnings inside the launch element, this will\n * append a button to the element that will remove that class, the warnings,\n * and the button itself, leaving the page as it would appear to the user.\n *\n * @param {HTMLElement} elem - An HTML element with the cms-editor class.\n */\nfunction launchRemover(elem) {\n    const warnings = Array.from(elem.querySelectorAll(`.${warningClass}`));\n\n    if (warnings.length) {\n        const button = createButton(),\n            wrapper = document.createElement('div');\n\n        button.addEventListener(\n            'click',\n            () => {\n                warnings.forEach(w => w.parentNode.removeChild(w));\n                button.parentNode.removeChild(button);\n                removeClass(elem, className, false);\n            },\n            true\n        );\n\n        wrapper.className = wrapperClass;\n        wrapper.appendChild(button);\n\n        document\n            .querySelector('body')\n            .insertBefore(wrapper, document.querySelector('.global-footer'));\n    }\n}\n\nexport default {\n    launchFn: launchRemover,\n    launchQuery: `.${className}`,\n};\n","/**\n * Cookie notice\n *\n * @module patterns/cookie-notice/cookie-notice\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport cookies from 'js-cookie';\nimport aria from '../../aria-attributes';\n\nconst className = 'cookie-notice',\n    cookieName = 'cityCookieNotice',\n    cookieOptions = {\n        expires: 365,\n        path: '/',\n        samesite: 'strict',\n        secure: true,\n    };\n\n/**\n * Remove the cookie notice and set a cookie so it won't come back.\n */\nfunction dismissCookieNotice() {\n    const now = new Date(),\n        notice = this.closest(`.${className}`);\n    cookies.set(cookieName, now.toISOString(), cookieOptions);\n    notice.parentNode.removeChild(notice);\n}\n\n/**\n * Add a button to dismiss the cookie notice, then set it to display.\n *\n * @param {HTMLElement} elem\n */\nfunction launchCookieNotice(elem) {\n    const agreeButton = document.createElement('button'),\n        agreeButtonSpan = document.createElement('span'),\n        agreeButtonText = document.createTextNode('Agree and dismiss');\n\n    agreeButton.setAttribute('type', 'button');\n    agreeButtonSpan.appendChild(agreeButtonText);\n    agreeButton.appendChild(agreeButtonSpan);\n\n    elem.appendChild(agreeButton);\n    elem.setAttribute(aria.live, 'polite');\n\n    agreeButton.addEventListener('click', dismissCookieNotice, true);\n    elem.dataset.display = true;\n}\n\nexport default {\n    launchFn: launchCookieNotice,\n    launchQuery: `.${className}`,\n};\n","/**\n * Devcorate\n *\n * @module patterns/devcorate/devcorate\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport { parametersToObject, objectToParameters } from '../../util';\n\n/**\n * Persist a query parameter to all same-site anchors inside an element.\n *\n * @param {HTMLElement} elem - An element containing anchors to decorate.\n * @param {string} param - The name of a query parameter.\n * @param {string} value - The value for the query parameter.\n */\nexport function devcorate(elem, param, value) {\n    Array.from(elem.querySelectorAll('a')).forEach(anchor => {\n        if (anchor.origin === window.location.origin) {\n            const parameters = anchor.search\n                ? parametersToObject(anchor.search)\n                : {};\n\n            parameters[param] = value;\n            anchor.href = `${anchor.origin}${\n                anchor.pathname\n            }${objectToParameters(parameters)}${anchor.hash}`;\n        }\n    });\n}\n","/**\n * Dropdown filter\n *\n * @module patterns/dropdown-filter/dropdown-filter\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nconst className = 'dropdown-filter';\n\n/**\n * Entry function: loops through and hides list items, sets up event listener on\n * child select box\n *\n * @param {HTMLElement} element: the dropdown div containing all elements\n */\nfunction prepareDropdown(element) {\n    // only get direct children\n    const listItems = element.querySelectorAll('ul.data-group > li');\n\n    // hide list items\n    hideListItems(listItems);\n\n    // get select element and apply change event listener\n    const selectFilter = element.querySelector('.select-filter');\n    selectFilter.addEventListener('change', selectChange);\n}\n\n/**\n * Hide list items: both functions require all list items to be hidden.\n * Ths function takes care of this\n *\n * @param {HTMLElement} items: the list of items to hide\n */\nfunction hideListItems(items) {\n    // hide list items\n    items.forEach(function(item) {\n        item.setAttribute('data-hidden', 'true');\n    });\n}\n\n/**\n * Select change: respond to select change\n *\n * @param {HTMLElement} element: the dropdown div containing all elements\n */\nfunction selectChange(e) {\n    // get the ul containing the list items\n    const dataGroup = e.target.nextElementSibling;\n\n    // get direct list items\n    const listItems = dataGroup.querySelectorAll('ul.data-group > li');\n\n    // hide all items before displaying chosen item\n    hideListItems(listItems);\n\n    // if first option selected, return\n    if (e.srcElement.selectedIndex == 0) {\n        return;\n    }\n\n    // get the list item corresponding to the select value chosen\n    const targetListItem = dataGroup.querySelector(\n        'li[data-value=' + e.target.value + ']'\n    );\n\n    // remove data-hidden\n    targetListItem.removeAttribute('data-hidden');\n}\n\nexport default {\n    launchFn: prepareDropdown,\n    launchQuery: `.${className}`,\n};\n","/**\n * Feedback\n *\n * @module patterns/feedback/feedback\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport aria from '../../aria-attributes';\nimport { gaEvent, appendAll } from '../../util';\n\nconst className = 'feedback',\n    feedbackPage = '/feedback';\n\n/**\n * Push a Google Analytics page feedback event into the data layer queue.\n *\n * @param {string} action - The event action.\n * @param {number} value - The event value\n */\nfunction sendFeedback(action, value) {\n    gaEvent(\n        'pageFeedback',\n        'Page feedback',\n        action,\n        window.location.toString(),\n        value,\n        true\n    );\n}\n\n/**\n * Handle a click on the \"no, it's not useful\" button.\n *\n * @param {HTMLParagraphElement} container - The button container.\n */\nfunction handleNo(container) {\n    sendFeedback('Not useful', 0);\n\n    const message = document.createElement('p'),\n        messagePrefix = document.createTextNode(\n            'Were sorry to hear that, please consider '\n        ),\n        linkText = document.createTextNode('sending us some feedback'),\n        link = document.createElement('a'),\n        messageSuffix = document.createTextNode(' so we can make it better.');\n    container.childNodes.forEach(elem => container.removeChild(elem));\n    link.href = feedbackPage;\n    link.appendChild(linkText);\n    appendAll(message, [messagePrefix, link, messageSuffix]);\n    message.setAttribute(aria.live, 'polite');\n    container.appendChild(message);\n}\n\n/**\n * Handle a click on the \"yes, it's useful\" button.\n *\n * @param {HTMLParagraphElement} container - The button container.\n */\nfunction handleYes(container) {\n    sendFeedback('Useful', 1);\n\n    const message = document.createElement('p'),\n        messageText = document.createTextNode(\n            'Thanks! Your feedback will be used to improve our website.'\n        );\n    container.childNodes.forEach(elem => container.removeChild(elem));\n    message.appendChild(messageText);\n    message.setAttribute(aria.live, 'polite');\n    container.appendChild(message);\n}\n\n/**\n * By default, the Feedback widget contains a link to the feedback form.\n *\n * With JavaScript, we add is it useful? buttons to track events to GA.\n *\n * @param {HTMLElement} elem - The feedback widget.\n */\nfunction launchFeedback(elem) {\n    const questionText = document.createTextNode('Is this page useful?'),\n        directFeedbackWrapper = document.createElement('div'),\n        directFeedbackForm = document.createElement('form'),\n        directFeedbackFieldset = document.createElement('fieldset'),\n        questionLegend = document.createElement('legend'),\n        buttonWrapper = document.createElement('div'),\n        yesButton = document.createElement('button'),\n        noButton = document.createElement('button');\n\n    yesButton.setAttribute('type', 'button');\n    yesButton.appendChild(document.createTextNode('Yes'));\n    yesButton.addEventListener(\n        'click',\n        () => handleYes(directFeedbackWrapper),\n        true\n    );\n\n    noButton.setAttribute('type', 'button');\n    noButton.appendChild(document.createTextNode('No'));\n    noButton.addEventListener(\n        'click',\n        () => handleNo(directFeedbackWrapper),\n        true\n    );\n\n    buttonWrapper.className = 'feedback__direct__buttons';\n\n    questionLegend.appendChild(questionText);\n    appendAll(buttonWrapper, [yesButton, noButton]);\n    appendAll(directFeedbackFieldset, [questionLegend, buttonWrapper]);\n    directFeedbackForm.appendChild(directFeedbackFieldset);\n    directFeedbackWrapper.appendChild(directFeedbackForm);\n    directFeedbackWrapper.className = className + '__direct';\n\n    elem.insertBefore(directFeedbackWrapper, elem.firstElementChild);\n}\n\nexport default {\n    launchFn: launchFeedback,\n    launchQuery: `.${className}`,\n};\n","/**\n * @module patterns/finder/components/cards/finder__results__bestbet\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Render a Funnelback best bet as a results card.\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__results__bestbet(props) {\n    return (\n        <li className=\"finder__results__card finder__results__bestbet\">\n            <a href={props.details.clickTrackingUrl}>\n                <div className=\"finder__results__card__details\">\n                    <h3 className=\"finder__results__card__heading underline-transition__title\">\n                        {props.details.title}\n                    </h3>\n                    <p className=\"finder__results__card__description\">\n                        {props.details.description}\n                    </p>\n                </div>\n            </a>\n        </li>\n    );\n}\n\nfinder__results__bestbet.propTypes = {\n    details: PropTypes.object,\n};\n\nexport default finder__results__bestbet;\n","/**\n * @module patterns/finder/components/cards/finder__results__bestbet\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Course from './finder__results__course';\nimport Profile from './finder__results__profile';\n\n/**\n * Render a Funnelback result as the appropriate card type.\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__results__course(props) {\n    switch (props.type) {\n        case 'course':\n            return <Course details={props.details} query={props.query} />;\n        case 'profile':\n            return <Profile details={props.details} />;\n    }\n}\n\nfinder__results__course.propTypes = {\n    details: PropTypes.object,\n    query: PropTypes.object,\n    type: PropTypes.string,\n};\n\nexport default finder__results__course;\n","/**\n * @module patterns/finder/components/cards/finder__results__course\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport formatLabel from '../results/finder__results__highlight__query';\n\n/**\n * Render a Funnelback result as a course card.\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__results__course(props) {\n    const courseCode = props.details.metaData.code && (\n        <p className=\"finder__results__card__tag\">\n            <span\n                className=\"fal fa-fw fa-graduation-cap icon\"\n                aria-hidden=\"true\"\n            />{' '}\n            <span>Course code:</span> <span>{props.details.metaData.code}</span>\n        </p>\n    );\n\n    const award = props.details.metaData.qualification && (\n        <p className=\"finder__results__card__tag\">\n            <span className=\"fal fa-fw fa-award icon\" aria-hidden=\"true\" />{' '}\n            <span>Award:</span>{' '}\n            <span>\n                {props.details.metaData.qualification.split('|').length > 2\n                    ? props.details.metaData.qualification\n                          .split('|')\n                          .slice(0, -1)\n                          .join(', ') +\n                      ' or ' +\n                      props.details.metaData.qualification.split('|').slice(-1)\n                    : props.details.metaData.qualification\n                          .split('|')\n                          .join(' or ')}\n            </span>\n        </p>\n    );\n\n    const duration = props.details.metaData.duration && (\n        <p className=\"finder__results__card__tag\">\n            <span className=\"fal fa-fw fa-clock icon\" aria-hidden=\"true\" />{' '}\n            <span>Duration:</span>{' '}\n            <span>{props.details.metaData.duration}</span>\n        </p>\n    );\n\n    const method = props.details.metaData.method && props.query.facets.method && (\n        <p className=\"finder__results__card__tag\">\n            <span\n                className=\"fas fa-fw fa-book-reader icon\"\n                aria-hidden=\"true\"\n            />{' '}\n            <span>Method of study:</span>{' '}\n            <span>{props.details.metaData.method}</span>\n        </p>\n    );\n\n    const location = props.details.metaData.location && (\n        <p className=\"finder__results__card__tag\">\n            <span\n                className=\"fas fa-fw fa-map-marker-alt icon\"\n                aria-hidden=\"true\"\n            />{' '}\n            <span>Location:</span>{' '}\n            <span>{props.details.metaData.location}</span>\n        </p>\n    );\n\n    const school = props.details.metaData.school && (\n        <p className=\"finder__results__card__tag\">\n            <span className=\"far fa-fw fa-building icon\" aria-hidden=\"true\" />{' '}\n            <span>School:</span> <span>{props.details.metaData.school}</span>\n        </p>\n    );\n\n    const clearing = props.details.metaData.clearing === '1' && (\n        <div className=\"clearing_label\">\n            <p>Available in clearing</p>\n        </div>\n    );\n\n    return (\n        <li className=\"finder__results__card finder__results__course\">\n            <a href={props.details.clickTrackingUrl}>\n                {clearing}\n                <div className=\"finder__results__card__details\">\n                    <h3 className=\"finder__results__card__heading underline-transition__title\">\n                        {props.query.query\n                            ? formatLabel(\n                                  props.details.title,\n                                  props.query.query\n                              )\n                            : props.details.title}\n                    </h3>\n                    <p className=\"finder__results__card__description\">\n                        {props.query.query\n                            ? formatLabel(\n                                  props.details.metaData.level &&\n                                      props.details.metaData.level.replace(\n                                          new RegExp('_', 'g'),\n                                          ' '\n                                      ),\n                                  props.query.query\n                              )\n                            : props.details.metaData.level &&\n                              props.details.metaData.level}\n                    </p>\n                    <p>\n                        {props.query.query\n                            ? formatLabel(\n                                  props.details.metaData.c &&\n                                      props.details.metaData.c.replace(\n                                          new RegExp('_', 'g'),\n                                          ' '\n                                      ),\n                                  props.query.query\n                              )\n                            : props.details.metaData.c &&\n                              props.details.metaData.c}\n                    </p>\n                    {school}\n                    {award}\n                    {duration}\n                    {courseCode}\n                    {method}\n                    {location}\n                </div>\n            </a>\n        </li>\n    );\n}\n\nfinder__results__course.propTypes = {\n    details: PropTypes.object,\n    query: PropTypes.object,\n};\n\nexport default finder__results__course;\n","/**\n * @module patterns/finder/components/cards/finder__results__profile\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Render a Funnelback result as a profile card.\n *\n * TODO: once the new collections are set up, standardise the metadata labels.\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__results__profile(props) {\n    // render school and department, if they have them\n    const school = (props.details.metaData.E || props.details.metaData.D) && (\n        <p className=\"finder__results__card__tag\">\n            <span className=\"fal fa-fw fa-university icon\" aria-hidden=\"true\" />{' '}\n            {props.details.metaData.E && props.details.metaData.E}\n            {props.details.metaData.E && props.details.metaData.D && ', '}\n            {props.details.metaData.D && props.details.metaData.D}\n        </p>\n    );\n\n    // headshot, if they have a thumbnail\n    const headshot = props.details.metaData.K && (\n        <div className=\"thumbnail__image-container\">\n            <img src={props.details.metaData.K} alt=\"\" />\n        </div>\n    );\n\n    return (\n        <li className=\"finder__results__card finder__results__profile\">\n            <a href={'/fb' + props.details.clickTrackingUrl}>\n                {headshot}\n                <div className=\"finder__results__card__details\">\n                    <h3 className=\"finder__results__card__heading underline-transition__title\">\n                        <span>{props.details.title}</span>\n                    </h3>\n                    <p className=\"finder__results__card__description\">\n                        {props.details.metaData.J}\n                    </p>\n                    {school}\n                </div>\n            </a>\n        </li>\n    );\n}\n\nfinder__results__profile.propTypes = {\n    details: PropTypes.object,\n};\n\nexport default finder__results__profile;\n","/**\n * @module patterns/finder/components/finder__filters\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport SelectFilter from './finder__select';\nimport ClearFilters from '../query/finder__clear';\nimport ToggleFilter from './finder__toggle';\n\n/**\n * Predicate for whether a facet should be displayed, if it's dependent on\n * another facet being set.\n *\n * @param {object} facet The facet to potentially display.\n * @param {object} facetMap The facets currently set on the query.\n * @return {bool} - Has any dependency been met\n */\nfunction dependencyMet(facet, facetMap) {\n    const setFacets = Object.keys(facetMap);\n\n    if (!facet.dependency) {\n        return true;\n    }\n\n    if (\n        setFacets.indexOf(facet.dependency) >= 0 &&\n        facetMap[facet.dependency] !== ''\n    ) {\n        return true;\n    }\n\n    return false;\n}\n\n/**\n * Component to update facet values in the query.\n *\n * @param {object} props React props.\n * @returns {object} - React component.\n */\nfunction finder__filters(props) {\n    const clearFilters = Object.keys(props.query.facets).length > 0 && (\n        <div className=\"finder__filters__clear--desktop\">\n            <ClearFilters clear={props.clear} query={props.query} />\n        </div>\n    );\n\n    return (\n        <div className=\"finder__filters\">\n            <h2 className=\"finder__filters__heading\">\n                {`Filter ${props.config.summariseAs.plural}`}{' '}\n                <div className=\"finder__filters__heading__btn-icon\">\n                    <ClearFilters clear={props.clear} query={props.query} />\n                    <span\n                        className=\"far fa-sliders-h icon\"\n                        aria-hidden=\"true\"\n                    />\n                </div>\n            </h2>\n\n            <fieldset>\n                <div className=\"finder__filters__wrapper--filters\">\n                    {props.config.facetLabels.map(facet => {\n                        if (dependencyMet(facet, props.query.facets)) {\n                            switch (facet.type) {\n                                case 'select':\n                                    return (\n                                        <SelectFilter\n                                            key={facet.meta}\n                                            facet={facet}\n                                            query={props.query}\n                                            responseFacet={\n                                                props.response &&\n                                                props.response.facets\n                                                    ? props.response.facets.filter(\n                                                          funnelbackFacet =>\n                                                              funnelbackFacet.name ===\n                                                              facet.funnelbackName\n                                                      )\n                                                    : []\n                                            }\n                                            update={props.update}\n                                            dependencies={props.config.facetLabels.filter(\n                                                candidate => {\n                                                    if (\n                                                        candidate.dependency ===\n                                                        facet.meta\n                                                    ) {\n                                                        return candidate;\n                                                    }\n                                                }\n                                            )}\n                                        />\n                                    );\n                                case 'toggle':\n                                    return (\n                                        <ToggleFilter\n                                            key={facet.meta}\n                                            facet={facet}\n                                            query={props.query}\n                                            responseFacet={\n                                                props.response &&\n                                                props.response.facets\n                                                    ? props.response.facets.filter(\n                                                          funnelbackFacet =>\n                                                              funnelbackFacet.name ===\n                                                              facet.funnelbackName\n                                                      )\n                                                    : []\n                                            }\n                                            update={props.update}\n                                        />\n                                    );\n                            }\n                        } else {\n                            return null;\n                        }\n                    })}\n                    {clearFilters}\n                    <p className=\"finder__filters__nofilters\">\n                        No filters are valid for the current query.\n                    </p>\n                </div>\n            </fieldset>\n        </div>\n    );\n}\n\nfinder__filters.propTypes = {\n    config: PropTypes.object,\n    query: PropTypes.object,\n    response: PropTypes.object,\n    update: PropTypes.object,\n    clear: PropTypes.func,\n    mobile: PropTypes.bool,\n};\n\nexport default finder__filters;\n","/**\n * @module patterns/finder/components/finder__mobilefilters\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport Filters from './finder__filters';\nimport Summary from '../results/finder__results__summary';\nimport createFocusTrap from 'focus-trap';\n// seems to fix most issues with old iPhones and position: fixed\n// may not be necessary long-term, but I was in a hurry\nimport { disableBodyScroll, enableBodyScroll } from 'body-scroll-lock';\n\n/**\n * Render the mobile version of the filters.\n *\n * TODO: this is a bit flaky on old iPhones with long facets (i.e. longer than\n * the main body of the page)\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__mobilefilters(props) {\n    const [display, setDisplay] = useState(false);\n    const [focusTrap, setFocusTrap] = useState({});\n\n    let filters = null;\n    const getFilters = () => filters;\n\n    // trap tab focus when the filters are open\n    useEffect(() => {\n        if (!focusTrap.activate) {\n            setFocusTrap(\n                createFocusTrap(getFilters(), {\n                    onDeactivate: () => setDisplay(false),\n                    clickOutsideDeactivates: true,\n                })\n            );\n        }\n\n        if (display) {\n            focusTrap.activate && focusTrap.activate();\n            disableBodyScroll(getFilters());\n        } else {\n            focusTrap.deactivate && focusTrap.deactivate();\n            enableBodyScroll(getFilters());\n        }\n    }, [display]);\n\n    const totalMatching =\n        props.response &&\n        props.response.summary &&\n        props.response.summary.totalMatching;\n\n    const result =\n        totalMatching === 1\n            ? props.summariseAs.singular\n            : props.summariseAs.plural;\n\n    const totalMatchingMessage = totalMatching\n        ? `Show ${totalMatching} ${result}`\n        : 'Close';\n\n    const summary =\n        totalMatching > 0 ? (\n            <Summary\n                currEnd={props.response.summary.currEnd}\n                currStart={props.response.summary.currStart}\n                query={props.query}\n                numRanks={props.response.summary.numRanks}\n                summariseAs={props.summariseAs}\n                totalMatching={props.response.summary.totalMatching}\n            />\n        ) : (\n            <div className=\"finder__results__summary\">\n                <h2 className=\"finder__results__summary__heading-wrap\">\n                    No {props.summariseAs.plural}\n                </h2>\n            </div>\n        );\n\n    const filtersCount =\n        Object.keys(props.query.facets).length > 0 ? (\n            <span>\n                Filters{' '}\n                <span className=\"finder__mobilefilters__toggle__filterNo\">\n                    ({Object.keys(props.query.facets).length})\n                </span>\n            </span>\n        ) : (\n            <span>Filter</span>\n        );\n\n    return (\n        <div className=\"finder__filters--mobile\" data-open={display}>\n            <button\n                type=\"button\"\n                className=\"finder__filters--mobile__toggle\"\n                aria-haspopup={true}\n                aria-expanded={display}\n                onClick={() => setDisplay(!display)}\n                data-filters-applied={\n                    Object.keys(props.query.facets).length !== 0 ? true : false\n                }\n            >\n                <span>\n                    <span\n                        className=\"far fa-sliders-h icon\"\n                        aria-hidden=\"true\"\n                    />{' '}\n                    {filtersCount}\n                </span>\n            </button>\n            <div\n                className=\"finder__filters--mobile__filters\"\n                ref={mobilefilters => {\n                    filters = mobilefilters;\n                }}\n            >\n                <div className=\"finder__filters--mobile__filters__content\">\n                    <Filters\n                        config={props.config}\n                        query={props.query}\n                        response={props.response}\n                        update={props.update}\n                        clear={props.clear}\n                        mobile={true}\n                    />\n                    <button\n                        type=\"button\"\n                        className=\"finder__filters--mobile__apply\"\n                        aria-expanded={display}\n                        onClick={() => setDisplay(!display)}\n                        disabled={props.updating}\n                    >\n                        {Object.keys(props.query.facets).length === 0 ? null : (\n                            <span className=\"far fa-chevron-left\"></span>\n                        )}\n\n                        <span aria-live=\"polite\">\n                            {props.updating ? (\n                                <React.Fragment>\n                                    <span\n                                        className=\"fas fa-spinner fa-pulse icon\"\n                                        aria-hidden=\"true\"\n                                    />{' '}\n                                    <span>\n                                        Updating {props.summariseAs.plural}\n                                    </span>\n                                </React.Fragment>\n                            ) : (\n                                <React.Fragment>\n                                    <span>\n                                        {Object.keys(props.query.facets)\n                                            .length === 0\n                                            ? 'Close'\n                                            : totalMatchingMessage}\n                                    </span>\n                                </React.Fragment>\n                            )}\n                        </span>\n                    </button>\n                </div>\n            </div>\n            {summary}\n        </div>\n    );\n}\n\nfinder__mobilefilters.propTypes = {\n    config: PropTypes.object,\n    query: PropTypes.object,\n    response: PropTypes.object,\n    update: PropTypes.object,\n    clear: PropTypes.func,\n    updating: PropTypes.bool,\n    summariseAs: PropTypes.object,\n};\n\nexport default finder__mobilefilters;\n","/**<\n * @module patterns/finder/components/finder__select\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction finder__select(props) {\n    const randomNumber = Math.random()\n            .toString(16)\n            .slice(-4),\n        currentValue = props.query.facets[props.facet.meta] || '';\n\n    // reduce the facet configuration to an array of all possible values for\n    // the facet\n    const allFacets = props.facet.values.reduce((acc, data) => {\n        return [...acc, data];\n    }, []);\n\n    // reduce the Funnelback response for the facet to an array of valid\n    // values for the current query\n    const responseFacets =\n        props.responseFacet[0] &&\n        props.responseFacet[0].categories[0] &&\n        props.responseFacet[0].categories[0].values\n            ? props.responseFacet[0].categories[0].values.reduce(\n                  (acc, data) => {\n                      return [...acc, data.data];\n                  },\n                  []\n              )\n            : [];\n\n    // count how many possible facets are not valid for the current query\n    // and will be hidden\n    const hiddenFacets = allFacets\n        .map(facet => facet.data)\n        .filter(facet => responseFacets.indexOf(facet) < 0).length;\n\n    const setFacet = value => {\n        const newQuery = props.query,\n            newValue = value;\n\n        props.dependencies.map(facet => {\n            delete newQuery.facets[facet.meta];\n        });\n\n        if (newValue) {\n            newQuery.facets[props.facet.meta] = newValue;\n        } else {\n            delete newQuery.facets[props.facet.meta];\n        }\n\n        newQuery.startRank = 1;\n\n        props.update.query(newQuery);\n        props.update.results(!props.update.updateState);\n    };\n\n    if (props.facet.values.length > hiddenFacets) {\n        return (\n            <div\n                className={`finder__filter finder__select ${currentValue &&\n                    'finder__select--selected'}`}\n            >\n                <label\n                    className=\"finder__select__overline\"\n                    htmlFor={`meta_${props.facet.meta}_sand--${randomNumber}`}\n                >\n                    {props.facet.name}\n                </label>\n                <select\n                    name={props.facet.name}\n                    id={`meta_${props.facet.meta}_sand--${randomNumber}`}\n                    onChange={e => setFacet(e.target.value)}\n                    value={currentValue}\n                >\n                    <option\n                        value=\"\"\n                        id={`meta${props.facet.meta}all`}\n                        name={`meta_${props.facet.meta}_sand--${randomNumber}`}\n                    >\n                        {props.facet.noSelection}\n                    </option>\n\n                    {props.facet.values.map((value, i) => {\n                        const responseFacetDetails =\n                            props.responseFacet[0] &&\n                            props.responseFacet[0].categories[0] &&\n                            props.responseFacet[0].categories[0].values.filter(\n                                responseFacetValue =>\n                                    responseFacetValue.data === value.data\n                            );\n\n                        if (\n                            currentValue === value.data ||\n                            (responseFacetDetails && responseFacetDetails[0])\n                        ) {\n                            return (\n                                <option\n                                    key={i}\n                                    value={value.data}\n                                    id={`meta${props.facet.meta}${i}`}\n                                    name={`meta_${props.facet.meta}_sand--${randomNumber}`}\n                                >\n                                    {value.label}\n                                    {currentValue !== value.data\n                                        ? responseFacetDetails[0].count > 0 &&\n                                          ` (${responseFacetDetails[0].count})`\n                                        : ''}\n                                </option>\n                            );\n                        } else {\n                            return null;\n                        }\n                    })}\n                </select>\n            </div>\n        );\n    } else {\n        return null;\n    }\n}\n\nfinder__select.propTypes = {\n    facet: PropTypes.object,\n    query: PropTypes.object,\n    responseFacet: PropTypes.arrayOf(PropTypes.object),\n    update: PropTypes.object,\n    dependencies: PropTypes.arrayOf(PropTypes.object),\n};\n\nexport default finder__select;\n","/**\n * @module patterns/finder/components/finder__toggle\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction finder__toggle(props) {\n    const randomNumber = Math.random()\n        .toString(16)\n        .slice(-4);\n\n    const setFacet = e => {\n        const newQuery = props.query,\n            newValue = e.target.value,\n            checked = e.target.checked;\n        checked\n            ? (newQuery.facets[props.facet.meta] = newValue)\n            : delete newQuery.facets[props.facet.meta];\n        newQuery.startRank = 1;\n        props.update.query(newQuery);\n        props.update.results(!props.update.updateState);\n    };\n\n    const idString = `${props.facet.name}-${randomNumber}`;\n\n    return (\n        <fieldset className=\"finder__filter finder__togglebox\">\n            <div className=\"finder__toggle\">\n                <label htmlFor={idString}>\n                    {props.facet.values[0].label}\n                    <input\n                        type=\"checkbox\"\n                        id={idString}\n                        name={props.facet.name}\n                        value={props.facet.values[0].data}\n                        onChange={e => setFacet(e)}\n                        checked={\n                            props.query.facets[props.facet.meta] ? true : false\n                        }\n                    />\n                    <span\n                        className={`toggle ${\n                            props.query.facets[props.facet.meta]\n                                ? 'toggle--open'\n                                : 'toggle--close'\n                        }`}\n                    />\n                </label>\n            </div>\n        </fieldset>\n    );\n}\n\nfinder__toggle.propTypes = {\n    facet: PropTypes.object,\n    query: PropTypes.object,\n    responseFacet: PropTypes.arrayOf(PropTypes.object),\n    update: PropTypes.object,\n};\n\nexport default finder__toggle;\n","/**\n * @module patterns/finder/components/finder__clear\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Clear input button.\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__clear(props) {\n    return (\n        <button\n            className=\"finder__clear\"\n            type=\"button\"\n            onClick={() => {\n                props.clear();\n            }}\n        >\n            <span\n                className=\"far fa-fw fa-times icon\"\n                aria-label=\"Clear input\"\n            />\n            <span className=\"finder__clear__text\">Reset</span>\n        </button>\n    );\n}\n\nfinder__clear.propTypes = {\n    clear: PropTypes.func,\n};\n\nexport default finder__clear;\n","/**\n * @module patterns/finder/components/finder__query\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { suggest } from '../../funnelback';\nimport Clear from './finder__clear';\n\nconst maximumSuggestions = 5,\n    [keyCodeEscape, keyCodeUp, keyCodeDown] = [27, 38, 40];\n\nfunction highlightQueryTerm(suggestion, partialQuery) {\n    return (\n        <React.Fragment>\n            <span>\n                <span className=\"sr-only\">{suggestion}</span>\n                <span aria-hidden=\"true\">\n                    <span className=\"finder__suggestion\">\n                        {suggestion.slice(\n                            suggestion.indexOf(partialQuery.toLowerCase()),\n                            partialQuery.length\n                        )}\n                    </span>\n                    {suggestion.slice(\n                        suggestion.indexOf(partialQuery.toLowerCase()) +\n                            partialQuery.length\n                    )}\n                </span>\n            </span>\n        </React.Fragment>\n    );\n}\n\n/**\n * Search input field and autocomplete.\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__query(props) {\n    // save what they're typing\n    const [partialQuery, setPartialQuery] = useState(props.query.query);\n    // Funnelback suggestions for the currently typed text\n    const [suggestions, setSuggestions] = useState([]);\n    // Request token for calls to the Funnelback suggestions service, so we\n    // can cancel it\n    const [call, setCall] = useState({ cancel: () => {} });\n    // ref for the input field, so we can .focus() it\n    const [inputId] = useState(\n        'finder--' +\n            props.query.collection +\n            '--' +\n            Math.random()\n                .toString(16)\n                .slice(-4)\n    );\n    // boolean to show or hide suggestions\n    const [showSuggestions, setShowSuggestions] = useState(false);\n\n    useEffect(() => {\n        setPartialQuery(props.query.query);\n    }, [props.updating]);\n\n    let textInput = null;\n    function focusInput() {\n        textInput.focus();\n    }\n\n    // on clear, make a default request for results\n    const clearQuery = () => {\n        call.cancel();\n        setPartialQuery('');\n        setSuggestions([]);\n        focusInput();\n\n        const newQuery = props.query;\n        newQuery.query = '';\n        newQuery.sortBy = props.config.sort;\n        props.update.query(newQuery);\n        props.update.results(!props.update.updateState);\n    };\n\n    const submitForm = () => {\n        window.location.replace(`https://web2020.city.ac.uk/prospective-students/courses?query=${partialQuery}`);\n    };\n\n    const submitSuggestion = s => {\n        call.cancel();\n        const newQuery = props.query;\n        newQuery.query = s;\n        props.update.query(newQuery);\n        props.update.results(!props.update.updateState);\n    };\n\n    const clear = partialQuery && (\n        <Clear\n            clear={() => {\n                clearQuery();\n            }}\n        />\n    );\n\n    // render suggestions\n    // TODO: probably should be refactored into a separate component\n    const suggestionsList = suggestions && suggestions.length > 0 && (\n        <ul\n            className={\n                showSuggestions\n                    ? 'finder__query__suggestions show'\n                    : 'finder__query__suggestions hide'\n            }\n        >\n            {[...new Set(suggestions)]\n                .slice(0, maximumSuggestions)\n                .map(suggestion => (\n                    <li key={suggestion}>\n                        <button\n                            type=\"button\"\n                            onBlur={() => setShowSuggestions(false)}\n                            onFocus={() => setShowSuggestions(true)}\n                            onMouseDown={() => {\n                                //for browsers because onBlur get excuted before onClick\n                                setShowSuggestions(true);\n                                setPartialQuery(suggestion);\n                                setSuggestions([]);\n                                focusInput();\n                                submitSuggestion(suggestion); //passing suggestion because partialQuery value get overwritten for some reason.\n                            }}\n                            onClick={() => {\n                                //for mobile\n                                setShowSuggestions(true);\n                                setPartialQuery(suggestion);\n                                setSuggestions([]);\n                                focusInput();\n                                submitSuggestion(suggestion); //passing suggestion because partialQuery value get overwritten for some reason.\n                            }}\n                            onKeyDown={e => {\n                                switch (e.keyCode) {\n                                    case keyCodeEscape:\n                                        e.target.parentNode.parentNode.parentNode\n                                            .querySelector('input')\n                                            .focus();\n                                        setSuggestions([]);\n                                        break;\n                                    case keyCodeUp:\n                                        if (\n                                            e.target.parentNode\n                                                .previousElementSibling &&\n                                            e.target.parentNode.previousElementSibling.querySelector(\n                                                'button'\n                                            )\n                                        ) {\n                                            e.preventDefault();\n                                            e.target.parentNode.previousElementSibling\n                                                .querySelector('button')\n                                                .focus();\n                                        } else {\n                                            e.preventDefault();\n                                            e.target.parentNode.parentNode.parentNode\n                                                .querySelector('input')\n                                                .focus();\n                                        }\n                                        break;\n                                    case keyCodeDown:\n                                        e.preventDefault();\n                                        if (\n                                            e.target.parentNode\n                                                .nextElementSibling &&\n                                            e.target.parentNode.nextElementSibling.querySelector(\n                                                'button'\n                                            )\n                                        ) {\n                                            e.preventDefault();\n                                            e.target.parentNode.nextElementSibling\n                                                .querySelector('button')\n                                                .focus();\n                                        }\n                                        break;\n                                }\n                            }}\n                        >\n                            {highlightQueryTerm(suggestion, partialQuery)}\n                        </button>\n                    </li>\n                ))}\n        </ul>\n    );\n\n    const input = (\n        <div className=\"finder__query__input\">\n            <div className=\"finder__query__icon--wrapper\">\n                <span className=\"finder__icon fal fa-search\"></span>\n            </div>\n            <label className=\"sr-only\" htmlFor={inputId}>\n                {`Search ${props.config.summariseAs.plural}`}\n            </label>\n            <input\n                autoComplete=\"off\"\n                id={inputId}\n                name=\"query\"\n                placeholder={props.config.placeholder}\n                ref={input => {\n                    textInput = input;\n                }}\n                type=\"text\"\n                value={partialQuery}\n                onKeyDown={e => {\n                    switch (e.keyCode) {\n                        case keyCodeEscape:\n                            clearQuery();\n                            break;\n                        case keyCodeDown:\n                            if (suggestions && suggestions.length > 0) {\n                                e.preventDefault();\n                                e.target.parentNode\n                                    .querySelector(\n                                        '.finder__query__suggestions button'\n                                    )\n                                    .focus();\n                            }\n                            break;\n                    }\n                }}\n                onFocus={() => setShowSuggestions(true)}\n                onBlur={() => setShowSuggestions(false)}\n                onChange={e => {\n                    //clear old suggestions\n                    setSuggestions([]);\n                    // keep  what they're typing\n                    setPartialQuery(e.target.value);\n\n                    /**\n                     * if we have a request to the suggestions service in progress,\n                     * cancel it. Stops old suggestions overwriting new ones because\n                     * the requests can't keep up with fast typing.\n                     */\n                    call.cancel();\n\n                    if (e.target.value) {\n                        // input is populated, ask for suggestions\n                        const [suggestionsPromise, newCall] = suggest(\n                            props.query.collection,\n                            e.target.value\n                        );\n\n                        // update our request cancel function for the new request\n                        setCall({\n                            cancel: () => {\n                                newCall.cancel();\n                            },\n                        });\n\n                        suggestionsPromise\n                            .then(data => setSuggestions(data))\n                            .catch(() => setSuggestions([]));\n                    } else {\n                        // input is empty, empty suggestions\n                        setSuggestions([]);\n                    }\n                }}\n            />\n            {suggestionsList}\n            {clear}\n        </div>\n    );\n\n    return (\n        <fieldset className=\"finder__query\">\n            <div>\n                {input}\n                <button\n                    type=\"submit\"\n                    className=\"finder__query__submit\"\n                    onClick={() => submitForm()}\n                >\n                    <span\n                        className=\"fal fa-search finder__query__submit__icon\"\n                        aria-hidden=\"true\"\n                    />{' '}\n                    <span className=\"finder__query__submit__text\">Find</span>\n                </button>\n            </div>\n        </fieldset>\n    );\n}\n\nexport default finder__query;\n","/**\n * @module patterns/finder/components/finder__query\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { suggest } from '../../funnelback';\nimport Clear from './finder__clear';\n\nconst maximumSuggestions = 5,\n    [keyCodeEscape, keyCodeUp, keyCodeDown, keyCodeEnd, keyCodeHome] = [\n        27,\n        38,\n        40,\n        35,\n        36,\n    ];\n\nfunction highlightQueryTerm(suggestion, partialQuery) {\n    return (\n        <React.Fragment>\n            <span>\n                <span className=\"sr-only\">{suggestion}</span>\n                <span aria-hidden=\"true\">\n                    <span className=\"finder__suggestion\">\n                        {suggestion.slice(\n                            suggestion.indexOf(partialQuery.toLowerCase()),\n                            partialQuery.length\n                        )}\n                    </span>\n                    {suggestion.slice(\n                        suggestion.indexOf(partialQuery.toLowerCase()) +\n                            partialQuery.length\n                    )}\n                </span>\n            </span>\n        </React.Fragment>\n    );\n}\n\n/**\n * Search input field and autocomplete.\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__query(props) {\n    // save what they're typing\n    const [partialQuery, setPartialQuery] = useState(props.query.query);\n    // Funnelback suggestions for the currently typed text\n    const [suggestions, setSuggestions] = useState([]);\n    // Request token for calls to the Funnelback suggestions service, so we\n    // can cancel it\n    const [call, setCall] = useState({ cancel: () => {} });\n    // ref for the input field, so we can .focus() it\n    const [inputId] = useState(\n        'finder--' +\n            props.query.collection +\n            '--' +\n            Math.random()\n                .toString(16)\n                .slice(-4)\n    );\n\n    const [showSuggestions, setShowSuggestions] = useState(false),\n        [activeSuggestionID, setActiveSuggestionID] = useState('');\n\n    useEffect(() => {\n        setPartialQuery(props.query.query);\n    }, [props.updating]);\n\n    let textInput = null;\n    function focusInput() {\n        textInput.focus();\n    }\n\n    // on clear, make a default request for results\n    const clearQuery = () => {\n        call.cancel();\n        setPartialQuery('');\n        setSuggestions([]);\n        focusInput();\n\n        const newQuery = props.query;\n        newQuery.query = '';\n        newQuery.sortBy = props.config.sort;\n        props.update.query(newQuery);\n        props.update.results(!props.update.updateState);\n    };\n\n    const submitForm = query => {\n        call.cancel();\n        setSuggestions([]);\n\n        const newQuery = props.query;\n        newQuery.query = query ? query : partialQuery ? partialQuery : '';\n        newQuery.startRank = 1;\n        newQuery.sortBy = partialQuery ? null : props.config.sort;\n        props.update.query(newQuery);\n        props.update.results(!props.update.updateState);\n    };\n\n    const clear = partialQuery && (\n        <Clear\n            clear={() => {\n                clearQuery();\n            }}\n        />\n    );\n\n    const submitSuggestion = suggestion => {\n        setShowSuggestions(false);\n        setSuggestions([]);\n        focusInput();\n        submitForm(suggestion);\n    };\n\n    // render suggestions\n    const suggestionsList = suggestions && suggestions.length > 0 && (\n        <ul\n            role=\"listbox\"\n            aria-label=\"Search suggestions\"\n            aria-activedescendant={activeSuggestionID}\n            className={\n                showSuggestions\n                    ? 'finder__query__suggestions show'\n                    : 'finder__query__suggestions hide'\n            }\n        >\n            {[...new Set(suggestions)]\n                .slice(0, maximumSuggestions)\n                .map((suggestion, i) => (\n                    <li key={suggestion} role=\"option\" id={inputId + '--' + i}>\n                        <button\n                            type=\"button\"\n                            onBlur={() => {\n                                setActiveSuggestionID('');\n                                setShowSuggestions(false);\n                            }}\n                            onFocus={() => setShowSuggestions(true)}\n                            onMouseDown={() => submitSuggestion(suggestion)}\n                            onClick={() => submitSuggestion(suggestion)}\n                            onKeyDown={e => {\n                                switch (e.keyCode) {\n                                    case keyCodeEscape:\n                                        e.target.parentNode.parentNode.parentNode\n                                            .querySelector('input')\n                                            .focus();\n                                        setSuggestions([]);\n                                        setActiveSuggestionID('');\n                                        break;\n                                    case keyCodeUp:\n                                        if (\n                                            e.target.parentNode\n                                                .previousElementSibling &&\n                                            e.target.parentNode.previousElementSibling.querySelector(\n                                                'button'\n                                            )\n                                        ) {\n                                            e.preventDefault();\n                                            e.target.parentNode.previousElementSibling\n                                                .querySelector('button')\n                                                .focus();\n                                            setActiveSuggestionID(\n                                                e.target.parentNode\n                                                    .previousElementSibling.id\n                                            );\n                                        } else {\n                                            e.preventDefault();\n                                            e.target.parentNode.parentNode.parentNode\n                                                .querySelector('input')\n                                                .focus();\n                                            setActiveSuggestionID('');\n                                        }\n                                        break;\n                                    case keyCodeDown:\n                                        e.preventDefault();\n                                        if (\n                                            e.target.parentNode\n                                                .nextElementSibling &&\n                                            e.target.parentNode.nextElementSibling.querySelector(\n                                                'button'\n                                            )\n                                        ) {\n                                            e.preventDefault();\n                                            e.target.parentNode.nextElementSibling\n                                                .querySelector('button')\n                                                .focus();\n                                            setActiveSuggestionID(\n                                                e.target.parentNode\n                                                    .nextElementSibling.id\n                                            );\n                                        }\n                                        break;\n                                    case keyCodeHome:\n                                        e.preventDefault();\n                                        if (\n                                            e.target.parentNode.parentNode\n                                                .firstChild &&\n                                            e.target.parentNode.parentNode.firstChild.querySelector(\n                                                'button'\n                                            )\n                                        ) {\n                                            e.preventDefault();\n                                            e.target.parentNode.parentNode.firstChild\n                                                .querySelector('button')\n                                                .focus();\n                                            setActiveSuggestionID(\n                                                e.target.parentNode.firstChild\n                                                    .id\n                                            );\n                                        }\n                                        break;\n                                    case keyCodeEnd:\n                                        e.preventDefault();\n                                        if (\n                                            e.target.parentNode.parentNode\n                                                .lastChild &&\n                                            e.target.parentNode.parentNode.lastChild.querySelector(\n                                                'button'\n                                            )\n                                        ) {\n                                            e.preventDefault();\n                                            e.target.parentNode.parentNode.lastChild\n                                                .querySelector('button')\n                                                .focus();\n                                            setActiveSuggestionID(\n                                                e.target.parentNode.lastChild.id\n                                            );\n                                        }\n                                        break;\n                                }\n                            }}\n                        >\n                            {highlightQueryTerm(suggestion, partialQuery)}\n                        </button>\n                    </li>\n                ))}\n        </ul>\n    );\n\n    const input = (\n        <div className=\"finder__query__input\">\n            <div className=\"finder__query__icon--wrapper\">\n                <span\n                    className=\"finder__icon fal fa-search icon\"\n                    aria-hidden=\"true\"\n                ></span>\n            </div>\n            <label className=\"sr-only\" htmlFor={inputId}>\n                {`Search ${props.config.summariseAs.plural}`}\n            </label>\n            <input\n                autoComplete=\"off\"\n                id={inputId}\n                name=\"query\"\n                placeholder={props.config.placeholder}\n                ref={input => {\n                    textInput = input;\n                }}\n                type=\"text\"\n                value={partialQuery}\n                onKeyDown={e => {\n                    switch (e.keyCode) {\n                        case keyCodeEscape:\n                            clearQuery();\n                            break;\n                        case keyCodeDown:\n                            if (suggestions && suggestions.length > 0) {\n                                e.preventDefault();\n                                e.target.parentNode\n                                    .querySelector(\n                                        '.finder__query__suggestions button'\n                                    )\n                                    .focus();\n                                setActiveSuggestionID(\n                                    e.target.parentNode.querySelector(\n                                        '.finder__query__suggestions li'\n                                    ).id\n                                );\n                            }\n                            break;\n                    }\n                }}\n                onFocus={() => setShowSuggestions(true)}\n                onBlur={() => setShowSuggestions(false)}\n                onChange={e => {\n                    //clear old suggestions\n                    setSuggestions([]);\n                    // keep  what they're typing\n                    setPartialQuery(e.target.value);\n\n                    /**\n                     * if we have a request to the suggestions service in progress,\n                     * cancel it. Stops old suggestions overwriting new ones because\n                     * the requests can't keep up with fast typing.\n                     */\n                    call.cancel();\n\n                    if (e.target.value) {\n                        // input is populated, ask for suggestions\n                        const [suggestionsPromise, newCall] = suggest(\n                            props.query.collection,\n                            e.target.value\n                        );\n\n                        // update our request cancel function for the new request\n                        setCall({\n                            cancel: () => {\n                                newCall.cancel();\n                            },\n                        });\n\n                        suggestionsPromise\n                            .then(data => setSuggestions(data))\n                            .catch(() => setSuggestions([]));\n                    } else {\n                        // input is empty, empty suggestions\n                        setSuggestions([]);\n                    }\n                }}\n            />\n            {suggestionsList}\n            {clear}\n        </div>\n    );\n\n    return (\n        <fieldset className=\"finder__query\">\n            <div>\n                {input}\n                <button\n                    type=\"submit\"\n                    className=\"finder__query__submit\"\n                    onClick={() => submitForm()}\n                >\n                    <span\n                        className=\"fal fa-search finder__query__submit__icon\"\n                        aria-hidden=\"true\"\n                    />{' '}\n                    <span className=\"finder__query__submit__text\">Find</span>\n                </button>\n            </div>\n        </fieldset>\n    );\n}\n\nfinder__query.propTypes = {\n    config: PropTypes.object,\n    query: PropTypes.object,\n    update: PropTypes.object,\n    updating: PropTypes.bool,\n};\n\nexport default finder__query;\n","/**\n * @module patterns/finder/components/finder__didyoumean\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Returns a Funnelback spelling suggestion as a button to update the query.\n *\n * @param {object} props React props.\n * @returns {object} - React component.\n */\nfunction finder__didyoumean(props) {\n    // response from Funnelback may include facet values, which we're ignoring\n    // for now and certainly shouldn't be shown to the user\n    const presentableText = props.text.split(/\\|/)[0].trim();\n\n    return (\n        <p>\n            Did you mean \n            <button\n                type=\"button\"\n                className=\"finder__didyoumean__button\"\n                onClick={() => {\n                    const newQuery = props.query;\n                    newQuery.query = presentableText;\n                    newQuery.startRank = 1;\n                    props.update.query(newQuery);\n                    props.update.results(!props.update.updateState);\n                }}\n            >\n                {presentableText}\n            </button>\n            ?\n        </p>\n    );\n}\n\nfinder__didyoumean.propTypes = {\n    query: PropTypes.object,\n    text: PropTypes.string,\n    update: PropTypes.object,\n};\n\nexport default finder__didyoumean;\n","/**\n * @module patterns/finder/components/finder__pagination\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Renders standard pagination controls patttern for the results.\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__pagination(props) {\n    const numberOfPages = Math.ceil(props.totalMatching / props.numRanks),\n        currentPage = Math.ceil(props.currStart / props.numRanks),\n        pages = [];\n\n    const changePage = pageNumber => {\n        const newStartRank = 1 + (pageNumber - 1) * props.numRanks,\n            newQuery = props.query;\n        newQuery.startRank = newStartRank;\n        props.update.query(newQuery);\n        props.update.results(!props.update.updateState);\n    };\n\n    pages.push(\n        <button\n            className=\"pagination__controls__button--prev\"\n            key=\"prev\"\n            type=\"button\"\n            disabled={currentPage === 1 ? true : false}\n            onClick={() => {\n                changePage(currentPage - 1);\n            }}\n        >\n            <span>Previous page</span>\n        </button>\n    );\n\n    for (let page = 1; page <= numberOfPages; page++) {\n        let className;\n        switch (page - numberOfPages) {\n            case 0:\n                className =\n                    'pagination__controls__element pagination__controls__button pagination__controls__button--last';\n                break;\n            case -1:\n                className =\n                    'pagination__controls__element pagination__controls__button pagination__controls__button--penultimate';\n                break;\n            default:\n                className =\n                    'pagination__controls__element pagination__controls__button';\n        }\n\n        pages.push(\n            <button\n                aria-current={page === currentPage ? 'page' : null}\n                aria-expanded={page === currentPage ? true : false}\n                aria-label={`Open page ${page}`}\n                className={className}\n                data-page={page}\n                data-proximity={Math.abs(page - currentPage)}\n                disabled={page === currentPage ? true : false}\n                key={page}\n                type=\"button\"\n                onClick={() => {\n                    changePage(page);\n                }}\n            >\n                <span>{page}</span>\n            </button>\n        );\n\n        if (page === 1) {\n            pages.push(\n                <span\n                    key=\"firstEllipsis\"\n                    className=\"pagination__controls__element pagination__controls__ellipsis pagination__controls__ellipsis--first\"\n                >\n                    <span></span>\n                </span>\n            );\n        } else if (page === numberOfPages - 1) {\n            pages.push(\n                <span\n                    key=\"lastEllipsis\"\n                    className=\"pagination__controls__element pagination__controls__ellipsis pagination__controls__ellipsis--last\"\n                >\n                    <span></span>\n                </span>\n            );\n        }\n    }\n\n    pages.push(\n        <button\n            className=\"pagination__controls__button--next\"\n            key=\"next\"\n            type=\"button\"\n            disabled={currentPage === numberOfPages ? true : false}\n            onClick={() => {\n                changePage(currentPage + 1);\n            }}\n        >\n            <span>Next page</span>\n        </button>\n    );\n\n    return (\n        <div className=\"pagination__wrapper\">\n            <nav\n                className=\"pagination__controls\"\n                data-pagecount={numberOfPages}\n            >\n                {pages}\n            </nav>\n        </div>\n    );\n}\n\nfinder__pagination.propTypes = {\n    currStart: PropTypes.number,\n    query: PropTypes.object,\n    numRanks: PropTypes.number,\n    totalMatching: PropTypes.number,\n    update: PropTypes.object,\n};\n\nexport default finder__pagination;\n","/**\n * @module patterns/finder/components/finder__results\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Card from '../cards/finder__results__card';\nimport BestBet from '../cards/finder__results__bestbet';\nimport DidYouMean from './finder__didyoumean';\nimport Summary from './finder__results__summary';\nimport Pagination from './finder__pagination';\n\n/**\n * Render Funnelback results.\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__results(props) {\n    const updating = (\n        <p className=\"finder__results__updating\" aria-live=\"polite\">\n            <span className=\"fas fa-spinner fa-pulse icon\" aria-hidden=\"true\" />{' '}\n            <span>Updating {props.summariseAs.plural}</span>\n        </p>\n    );\n\n    if (props.response) {\n        // Response may include spelling suggestion\n        const didYouMean = props.response.spell &&\n            props.response.spell.text &&\n            props.response.summary.totalMatching === 0 && (\n                <DidYouMean\n                    query={props.query}\n                    text={props.response.spell.text}\n                    update={props.update}\n                />\n            );\n\n        // if we have more results than will fit on a single page, we need\n        // pagination\n        const pagination = props.response.summary.totalMatching >\n            props.response.summary.numRanks && (\n            <Pagination\n                currStart={props.response.summary.currStart}\n                numRanks={props.response.summary.numRanks}\n                query={props.query}\n                totalMatching={props.response.summary.totalMatching}\n                update={props.update}\n            />\n        );\n\n        // render either the results, or a spinner while we wait for Funnelback\n        const resultsContent = props.updating ? (\n            <React.Fragment>{updating}</React.Fragment>\n        ) : (\n            <React.Fragment>\n                <Summary\n                    clear={props.clear}\n                    config={props.config}\n                    currEnd={props.response.summary.currEnd}\n                    currStart={props.response.summary.currStart}\n                    numRanks={props.response.summary.numRanks}\n                    query={props.query}\n                    summariseAs={props.summariseAs}\n                    totalMatching={props.response.summary.totalMatching}\n                    update={props.update}\n                />\n                {didYouMean}\n                <ol\n                    start={props.response.summary.currStart}\n                    className=\"finder__results__list\"\n                >\n                    {props.response.bestBets.map(card => (\n                        <BestBet details={card} key={card.docNum} />\n                    ))}\n\n                    {props.response.results.map(card => (\n                        <Card\n                            bestBet={false}\n                            details={card}\n                            key={card.docNum}\n                            type={props.type}\n                            query={props.query}\n                        />\n                    ))}\n                </ol>\n                {pagination}\n            </React.Fragment>\n        );\n        return <div className=\"finder__results\">{resultsContent}</div>;\n    } else {\n        return <div className=\"finder__results\">{updating}</div>;\n    }\n}\n\nfinder__results.propTypes = {\n    query: PropTypes.object,\n    response: PropTypes.object,\n    summariseAs: PropTypes.object,\n    type: PropTypes.string,\n    update: PropTypes.object,\n    updating: PropTypes.bool,\n    clear: PropTypes.func,\n};\n\nexport default finder__results;\n","import React from 'react';\n\nconst formatLabel = (label, value) => {\n    if (value) {\n        return label;\n    }\n    return (\n        <React.Fragment>\n            {label.split(value).reduce((prev, current, i) => {\n                if (!i) {\n                    return [current];\n                }\n                return prev.concat(\n                    <span className=\"highlightText\" key={value + current}>\n                        {value}\n                    </span>,\n                    current\n                );\n            }, [])}\n        </React.Fragment>\n    );\n};\n\nexport default formatLabel;\n","/**\n * @module patterns/finder/components/finder__results__summary\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Results heading, summarising the response.\n *\n * @param {object} props React props.\n * @return {object} - React component.\n */\nfunction finder__results__summary(props) {\n    let searchHints;\n    const result =\n        props.totalMatching === 1\n            ? props.summariseAs.singular\n            : props.summariseAs.plural;\n\n    if (props.totalMatching == 0) {\n        searchHints = (\n            <div>\n                <p>Your search did not match any {props.summariseAs.plural}.</p>\n                <p>Suggestions:</p>\n                <ul>\n                    <li>Make sure that all words are spelled correctly</li>\n                    <li>Try different keywords</li>\n                    <li>Try more general keywords</li>\n                    <li>Try fewer keywords</li>\n                    <li>Try fewer filters</li>\n                    <li>\n                        <button\n                            type=\"button\"\n                            onClick={() => {\n                                props.clear();\n                            }}\n                        >\n                            Reset filters\n                        </button>\n                    </li>\n                    <li>\n                        <button\n                            type=\"button\"\n                            onClick={() => {\n                                const newQuery = props.query;\n                                newQuery.query = '';\n                                newQuery.sortBy = props.config.sort;\n                                props.update.query(newQuery);\n                                props.update.results(!props.update.updateState);\n                            }}\n                        >\n                            Reset search\n                        </button>\n                    </li>\n                </ul>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"finder__results__summary\">\n            <h2\n                aria-live=\"polite\"\n                className=\"finder__results__summary__heading\"\n            >\n                {props.query.query || Object.keys(props.query.facets).length > 0\n                    ? 'Matching'\n                    : 'All'}{' '}\n                {result} (showing{' '}\n                {props.totalMatching > props.numRanks &&\n                    `${props.currStart}${props.currEnd} of `}\n                {props.totalMatching} {result}\n                {props.query.query && ` for ${props.query.query}`})\n            </h2>\n            {searchHints}\n        </div>\n    );\n}\n\nfinder__results__summary.propTypes = {\n    clear: PropTypes.func,\n    config: PropTypes.object,\n    currEnd: PropTypes.number,\n    currStart: PropTypes.number,\n    numRanks: PropTypes.number,\n    query: PropTypes.object,\n    summariseAs: PropTypes.object,\n    totalMatching: PropTypes.number,\n    update: PropTypes.object,\n};\n\nexport default finder__results__summary;\n","/**\n * Universal finder\n *\n * Don't run this via patterns.js, it's a separate compilation.\n *\n * @module patterns/finder/finder\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { find } from './funnelback';\nimport Query from './components/query/finder__query--mini';\n\n/**\n * Retrieve current values for facets from the URL parameters.\n *\n * @param {object[]} facets Array of facet definitions.\n * @param {object} params URLSearchParams object for the current page.\n * @return {object} - Map of facet meta labels to their current value from the URL.\n */\nfunction getFacetParams(facets, params) {\n    return facets\n        .map(facet => {\n            const param = {};\n            if (params.get(`meta_${facet.meta}_orsand`)) {\n                param[facet.meta] = params.get(`meta_${facet.meta}_orsand`);\n            }\n            return param;\n        })\n        .reduce((facetParams, facet) => Object.assign(facetParams, facet));\n}\n\n/**\n * Preserve the search state in the URL parameters.\n *\n * @param {string} currQuery The search query.\n * @param {integer} currStartRank The start rank.\n * @param {object[]} currFacets A map of facet meta labels to their values.\n * @param {*} facetLabels Array of facet definitions.\n */\nfunction replaceHistory(currQuery, currStartRank, currFacets, facetLabels) {\n    const params = new URLSearchParams(window.location.search);\n\n    currQuery !== '' ? params.set('query', currQuery) : params.delete('query');\n\n    currStartRank !== 1\n        ? params.set('start_rank', currStartRank)\n        : params.delete('start_rank');\n\n    facetLabels.forEach(facet => {\n        if (currFacets[facet.meta]) {\n            params.set(`meta_${facet.meta}_orsand`, currFacets[facet.meta]);\n        } else {\n            params.delete(`meta_${facet.meta}_orsand`);\n        }\n    });\n\n    const hasParams = params.toString().length ? '?' : '';\n\n    window.history.replaceState(\n        {},\n        '',\n        `${window.location.pathname}${hasParams}${params.toString()}`\n    );\n}\n\n/**\n * Launch the universal Finder.\n *\n * @param {object} props The JSON configuration file for the Finder.\n * @return {object} The React component to render.\n */\nfunction Finder(props) {\n    const params = new URLSearchParams(window.location.search);\n\n    /**\n     * initial state for the Funnelback query, taken from URL parameters and\n     * configuration\n     **/\n    const initialQuery = {\n        collection: props.config.collection,\n        fixedFacets: props.config.fixedFacets,\n        query: params.get('query') || '',\n        sortBy: params.get('query')\n            ? null\n            : params.get('sort') || props.config.sort,\n        sortDirection:\n            params.get('sortdirection') || props.config.sortDirection,\n        startRank: params.get('start_rank') || 1,\n        numRanks: params.get('num_ranks') || props.config.numRanks,\n        facets: getFacetParams(props.config.facetLabels, params),\n    };\n\n    // State objects for the Funnelback query and response\n    const [query, setQuery] = useState(initialQuery);\n\n    // Boolean to indicate when a query is in progress\n    const [updating, setUpdating] = useState(true);\n    // Request token from the Funnelback request object, so we can cancel if\n    // another request is triggered by the user\n    const [call, setCall] = useState({\n        cancel: () => {},\n    });\n    // useEffect doesn't deep inspect objects, so we need an additional, plain\n    // state variable to indicate that the query state has changed and the\n    // component should render\n    // the value isn't important, it's just easy to toggle a bool back and forth\n    const [update, setUpdate] = useState(false);\n\n    // Retrieve Funnelback results\n    useEffect(() => {\n        // preserve the state\n        replaceHistory(\n            query.query,\n            query.startRank,\n            query.facets,\n            props.config.facetLabels\n        );\n\n        // indicate a request is in progress\n        setUpdating(true);\n\n        /**\n         * cancel any request already in progress\n         *\n         * async requests can return out of order\n         */\n        call.cancel();\n\n        // make a new, asynchronous request to Funnelback\n        const [request, requestToken] = find(\n            query.collection,\n            query.fixedFacets,\n            query.query,\n            query.sortBy,\n            query.sortDirection,\n            query.startRank,\n            query.numRanks,\n            query.facets\n        );\n\n        // save the requestToken, so\n        setCall({\n            cancel: () => {\n                requestToken.cancel();\n            },\n        });\n\n        // when the response from Funnelback arrives,\n        // update the results and display them\n        request\n            .then(() => {\n                setUpdating(false);\n            })\n            .catch(() => {\n                setUpdating(false);\n            });\n    }, [update]);\n\n    // update props so child components can update the query\n\n    const updater = {\n        query: newQuery => setQuery(newQuery),\n        results: newUpdate => setUpdate(newUpdate),\n        updateState: update,\n    };\n\n    return (\n        <form\n            onSubmit={e => {\n                e.preventDefault();\n            }}\n        >\n            <Query\n                config={props.config}\n                query={query}\n                update={updater}\n                updating={updating}\n            />\n        </form>\n    );\n}\n\nFinder.propTypes = {\n    config: PropTypes.object,\n};\n\nexport default Finder;\n","/**\n * Universal finder\n *\n * Don't run this via patterns.js, it's a separate compilation.\n *\n * @module patterns/finder/finder\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { find } from './funnelback';\nimport Query from './components/query/finder__query';\nimport Filters from './components/filters/finder__filters';\nimport MobileFilters from './components/filters/finder__mobilefilters';\nimport Results from './components/results/finder__results';\n\n/**\n * Retrieve current values for facets from the URL parameters.\n *\n * @param {object[]} facets Array of facet definitions.\n * @param {object} params URLSearchParams object for the current page.\n * @return {object} - Map of facet meta labels to their current value from the URL.\n */\nfunction getFacetParams(facets, params) {\n    return facets\n        .map(facet => {\n            const param = {};\n            if (params.get(`meta_${facet.meta}_sand`)) {\n                param[facet.meta] = params.get(`meta_${facet.meta}_sand`);\n            }\n            return param;\n        })\n        .reduce((facetParams, facet) => Object.assign(facetParams, facet));\n}\n\n/**\n * Preserve the search state in the URL parameters.\n *\n * @param {string} currQuery The search query.\n * @param {integer} currStartRank The start rank.\n * @param {object[]} currFacets A map of facet meta labels to their values.\n * @param {*} facetLabels Array of facet definitions.\n */\nfunction replaceHistory(currQuery, currStartRank, currFacets, facetLabels) {\n    if (window) {\n        const params = new URLSearchParams(window.location.search);\n\n        currQuery !== ''\n            ? params.set('query', currQuery)\n            : params.delete('query');\n\n        currStartRank !== 1\n            ? params.set('start_rank', currStartRank)\n            : params.delete('start_rank');\n\n        facetLabels.forEach(facet => {\n            if (currFacets[facet.meta]) {\n                params.set(`meta_${facet.meta}_sand`, currFacets[facet.meta]);\n            } else {\n                params.delete(`meta_${facet.meta}_sand`);\n            }\n        });\n\n        const hasParams = params.toString().length ? '?' : '';\n\n        window.history.replaceState(\n            {},\n            '',\n            `${window.location.pathname}${hasParams}${params.toString()}`\n        );\n    }\n}\n\n/**\n * Launch the universal Finder.\n *\n * @param {object} props The JSON configuration file for the Finder.\n * @return {object} The React component to render.\n */\nfunction Finder(props) {\n    const params = new URLSearchParams(window.location.search);\n\n    /**\n     * initial state for the Funnelback query, taken from URL parameters and\n     * configuration\n     **/\n    const initialQuery = {\n        collection: props.config.collection,\n        fixedFacets: props.config.fixedFacets,\n        query: params.get('query') || '',\n        sortBy: params.get('query')\n            ? null\n            : params.get('sort') || props.config.sort,\n        sortDirection:\n            params.get('sortdirection') || props.config.sortDirection,\n        startRank: params.get('start_rank') || 1,\n        numRanks: params.get('num_ranks') || props.config.numRanks,\n        facets: getFacetParams(props.config.facetLabels, params),\n    };\n\n    /**\n     * Dummy, empty Funnelback response object for initial state.\n     */\n    const initialResponse = {\n        bestBets: [],\n        facets: [],\n        results: [],\n        spell: null,\n        summary: {\n            currEnd: 0,\n            currStart: 0,\n            numRanks: 0,\n            totalMatching: 0,\n        },\n    };\n\n    // State objects for the Funnelback query and response\n    const [query, setQuery] = useState(initialQuery);\n    const [funnelbackResponse, setResponse] = useState(initialResponse);\n    // Boolean to indicate when a query is in progress\n    const [updating, setUpdating] = useState(true);\n    // Request token from the Funnelback request object, so we can cancel if\n    // another request is triggered by the user\n    const [call, setCall] = useState({\n        cancel: () => {},\n    });\n    // useEffect doesn't deep inspect objects, so we need an additional, plain\n    // state variable to indicate that the query state has changed and the\n    // component should render\n    // the value isn't important, it's just easy to toggle a bool back and forth\n    const [update, setUpdate] = useState(false);\n\n    // Retrieve Funnelback results\n    useEffect(() => {\n        // preserve the state\n        replaceHistory(\n            query.query,\n            query.startRank,\n            query.facets,\n            props.config.facetLabels\n        );\n\n        // indicate a request is in progress\n        setUpdating(true);\n\n        /**\n         * cancel any request already in progress\n         *\n         * async requests can return out of order\n         */\n        call.cancel();\n\n        // make a new, asynchronous request to Funnelback\n        const [request, requestToken] = find(\n            query.collection,\n            query.fixedFacets,\n            query.query,\n            query.sortBy,\n            query.sortDirection,\n            query.startRank,\n            query.numRanks,\n            query.facets\n        );\n\n        // save the requestToken, so\n        setCall({\n            cancel: () => {\n                requestToken.cancel();\n            },\n        });\n\n        // when the response from Funnelback arrives,\n        // update the results and display them\n        request\n            .then(data => {\n                setResponse(data);\n                setUpdating(false);\n            })\n            .catch(() => {\n                setResponse(initialResponse);\n                setUpdating(false);\n            });\n    }, [update]);\n\n    // update props so child components can update the query\n    const updater = {\n        query: newQuery => setQuery(newQuery),\n        results: newUpdate => setUpdate(newUpdate),\n        updateState: update,\n    };\n\n    const clear = () => {\n        const clearQuery = Object.assign({}, query);\n        clearQuery.facets = {};\n        setQuery(clearQuery);\n        setUpdate(!update);\n    };\n\n    return (\n        <form\n            className={\n                props.config.facetLabels.length > 0\n                    ? 'finder'\n                    : 'finder finder--nofilters'\n            }\n            onSubmit={e => {\n                e.preventDefault();\n            }}\n        >\n            <Query\n                config={props.config}\n                query={query}\n                update={updater}\n                updating={updating}\n            />\n\n            {props.config.facetLabels.length > 0 && (\n                <React.Fragment>\n                    <MobileFilters\n                        config={props.config}\n                        query={query}\n                        response={funnelbackResponse}\n                        update={updater}\n                        updating={updating}\n                        summariseAs={props.config.summariseAs}\n                        clear={clear}\n                    />\n\n                    <div className=\"finder__filters--desktop\">\n                        <Filters\n                            config={props.config}\n                            query={query}\n                            response={funnelbackResponse}\n                            update={updater}\n                            clear={clear}\n                        />\n                    </div>\n                </React.Fragment>\n            )}\n\n            <Results\n                query={query}\n                response={funnelbackResponse}\n                summariseAs={props.config.summariseAs}\n                type={props.config.resultCard}\n                update={updater}\n                updating={updating}\n                clear={clear}\n                config={props.config}\n            />\n        </form>\n    );\n}\n\nFinder.propTypes = {\n    config: PropTypes.object,\n};\n\nexport default Finder;\n","/**\n * Functions for making requests to Funnelback\n *\n * @module funnelback\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport axios from 'axios';\nimport https from 'https';\nimport { gaEvent } from '../../util.js';\n\n/**\n * LAUNCH: change web2020.city.ac.uk to www.city.ac.uk\n */\nconst baseUrl = 'https://web2020.city.ac.uk/web-services',\n    findRootUrl = '/funnelback-find',\n    suggestRootUrl = '/funnelback-suggest',\n    httpOK = 200,\n    timeout = 30000;\n\n/**\n * Asynchronous request to Funnelback web service.\n *\n * @param {object} config An axios configuration object.\n * @return {Promise} - A promise of a Funnelback response.\n */\nfunction axiosRequest(config) {\n    return axios(config)\n        .then(response => {\n            if (httpOK === response.status) {\n                return response.data;\n            } else {\n                throw `Bad response: ${response.status}`;\n            }\n        })\n        .catch(e => {\n            if (!axios.isCancel(e)) {\n                gaEvent(\n                    'jsError',\n                    'JavaScript error',\n                    `Line ${e.lineNumber}  ${e.message}`,\n                    `axiosRequest ${e.fileName} (${window.location})`,\n                    true\n                );\n            }\n        });\n}\n\n/**\n * Funnelback search query.\n *\n * @param {string} collection The Funnelback collection to query.\n * @param {string} [query] The query string.\n * @param {string} [sortBy] The field to sort by.\n * @param {string} sortDirection Sort 'asc'ending or 'desc'ending.\n * @param {integer} startRank The first result to return.\n * @param {integer} numRank The number of results to return.\n * @param {object} [facets] A map of facets to query strings.\n * @return {Promise} - A promise of search results.\n */\nexport function find(\n    collection,\n    fixedFacets,\n    query,\n    sortBy,\n    sortDirection,\n    startRank,\n    numRank,\n    facets\n) {\n    const fixedFacetParams = {};\n    fixedFacets.forEach(facet => {\n        fixedFacetParams[`meta_${facet.meta}_sand`] = facet.value;\n    });\n\n    const facetParams = {},\n        facetKeys = Object.keys(facets);\n\n    facetKeys.forEach(key => (facetParams[`meta_${key}_sand`] = facets[key]));\n\n    const CancelToken = axios.CancelToken,\n        call = CancelToken.source(),\n        config = {\n            baseURL: baseUrl,\n            cancelToken: call.token,\n            httpsAgent: new https.Agent({ keepAlive: true }),\n            url: findRootUrl,\n            timeout: timeout,\n            params: {\n                ...fixedFacetParams,\n                ...facetParams,\n                collection: collection,\n                num_ranks: numRank,\n                query: query,\n                sort: sortBy\n                    ? `${'desc' === sortDirection ? 'd' : ''}${sortBy}`\n                    : null,\n                start_rank: startRank,\n            },\n        };\n\n    return [axiosRequest(config), call];\n}\n\n/**\n * Funnelback suggestion query.\n *\n * @param {string} collection The Funnelback collection to query.\n * @param {string} partialQuery The string to make suggestions for.\n * @return {Promise} - A promise of an array of suggestion strings.\n */\nexport function suggest(collection, partialQuery) {\n    const CancelToken = axios.CancelToken,\n        call = CancelToken.source(),\n        config = {\n            baseURL: baseUrl,\n            cancelToken: call.token,\n            url: suggestRootUrl,\n            timeout: timeout,\n            params: {\n                collection: collection,\n                partial_query: partialQuery,\n            },\n        };\n\n    return [axiosRequest(config), call];\n}\n\n/**\n * Finder configuration.\n *\n * @param {string} url The Finder configuration file.\n * @return {Promise} - A promise of  configuration object.\n */\nexport function finderConfig(url) {\n    const config = {\n        timeout: timeout,\n        url: url,\n    };\n\n    return axiosRequest(config);\n}\n","import { init, onClickThunbnail, translateThumbnails } from '../image-carousel';\nimport { checkIntersectionObserver } from '../../../util';\n\nconst className = 'carousel-gallery';\n\n/**\n *\n * Init the defualt gallery\n *\n *\n *\n * HTML e.g.\n *\n *  <div class=\"carousel-gallery-default\">\n *      <div class=\"carousel-gallery\">\n *          <h3>Gallery title</h3>\n *          <ul class=\"swiper-wrapper\">\n *              <li class=\"swiper-slide\">\n *                  <div class=\"swiper-slide__image-wrapper\">\n *                      <img src=\"centre-healthcare-innovation-research.jpg\" alt=\"Banner depicting \">\n *                  </div>\n *              </li>\n *              <li class=\"swiper-slide\">\n *                  <div class=\"swiper-slide__image-wrapper\">\n *                      <img class=\"lazy\" src=\"centre-healthcare-innovation-research.jpg\" alt=\"Banner depicting \">\n *                  </div>\n *              </li>\n *              <li class=\"swiper-slide\">\n *                  <div class=\"swiper-slide__image-wrapper\">\n *                      <img class=\"lazy\" src=\"centre-healthcare-innovation-research.jpg\" alt=\"Banner depicting \">\n *                      <noscript>\n *                          <img class=\"lazy\" src=\"https://web2020.city.ac.uk/__data/assets/image/0019/341236/Phonetics-lab.jpg\" alt=\"Woman using the phonetics lab\">\n *                      </noscript>\n *                  </div>\n *              </li>\n *          </ul>\n *          <div class=\"galleria-thumbnails-wrap\">\n *              <ul class=\"galleria-thumbnails-list\">\n *                  <li class=\"galleria-thumbnail\">\n *                      <img src=\"big_thumbnail.jpg\" alt=\"Banner depicting \"/>\n *                  </li>\n *                  <li class=\"galleria-thumbnail\">\n *                      <img src=\"big_thumbnail.jpg\" alt=\"Banner depicting \"/>\n *                  </li>\n *                  <li class=\"galleria-thumbnail\">\n *                      <img src=\"big_thumbnail.jpg\" alt=\"Banner depicting \"/>\n *                  </li>\n *              </ul>\n *          </div>\n *      </div>\n *  </div>\n *\n * @param {HTMLElement} elem - The element to carousel.\n */\n\nfunction carouselGallery(elem) {\n    init(elem, {\n        defaultCarousel: true,\n        hidNumInd: true,\n    });\n    let thumbnails = [].slice.call(\n        elem.querySelector('.galleria-thumbnails-list').querySelectorAll('li')\n    );\n    //edge work around intersectionObserver not triggering using isIntersecting\n    let options = {\n            rootMargin: '0px',\n            threshold: [0, 1],\n        },\n        edge = document.documentElement.classList.contains('edge');\n\n    let edgeThumbnailsObserver = new IntersectionObserver(function(entries) {\n        entries.forEach(function(entry) {\n            if (entry.intersectionRatio === 1) {\n                entry.target.setAttribute('aria-hidden', 'false');\n            } else {\n                entry.target.setAttribute('aria-hidden', 'true');\n            }\n        });\n    }, options);\n\n    let thumbnailsObserver = new IntersectionObserver(function(entries) {\n        entries.forEach(function(entry) {\n            if (entry.isIntersecting) {\n                entry.target.setAttribute('aria-hidden', 'false');\n            } else if (!entry.isIntersecting) {\n                entry.target.setAttribute('aria-hidden', 'true');\n            }\n        });\n    });\n\n    thumbnails.forEach(function(e, i) {\n        if (i === 0) {\n            e.classList.add('active');\n        }\n        e.addEventListener(\n            'click',\n            function(t) {\n                onClickThunbnail(t, i);\n            },\n            false\n        );\n        e.addEventListener(\n            'keyup',\n            function(e) {\n                switch (e.keyCode) {\n                    case 13:\n                        onClickThunbnail(e, i);\n                        break;\n\n                    case 9:\n                        translateThumbnails(i, e);\n                }\n            },\n            false\n        );\n        e.setAttribute('aria-hidden', 'false');\n        if (checkIntersectionObserver && !edge) {\n            thumbnailsObserver.observe(e);\n        } else if (checkIntersectionObserver && edge) {\n            edgeThumbnailsObserver.observe(e);\n        }\n    });\n}\n\nexport default {\n    launchFn: carouselGallery,\n    launchQuery: `.${className}`,\n};\n","import { toArray, detectIE } from '../../util';\n\nconst className = 'swiper-container';\nconst ie = detectIE();\n\nlet i = 0,\n    x0 = null,\n    locked = false,\n    config = {},\n    sliderTranslateCoOr = 0;\n\n/**\n *\n * Adds and setups carousel controls\n * e.g.\n *\n *  <div class=\"swiper-viewport\">\n *      <div class=\"swiper-container\">\n *\n *          <ul class=\"swiper-wrapper\">\n *              <li class=\"swiper-slide\">\n *                  <div class=\"swiper-slide__image-wrapper\">\n *                      <img src=\"https://web2020.city.ac.uk/documentation/patterns/carousel/_DP57645_1920x1080.jpg\" alt=\"Image\">\n *                  </div>\n *                  <div class=\"swiper-slide__text\">\n *                      <p>We are a leading provider of healthcare .....</p>\n *                  </div>\n *              </li>\n *              <li class=\"swiper-slide\">\n *                  <div class=\"swiper-slide__image-wrapper\">\n *                      <img class=\"lazy\" src=\"https://web2020.city.ac.uk/documentation/patterns/carousel/_DP57645_1920x1080.jpg\" alt=\"Image\">\n *                  </div>\n *                  <div class=\"swiper-slide__text\">\n *                      <p>We are a leading provider of healthcare .....</p>\n *                  </div>\n *              </li>\n *          </ul>\n *\n *      </div>\n *  </div>\n *\n *@param {HTMLElement} elem - The element to carousel.\n *@param {Object} object - Object containing setting to setup defualt carousel. if using full width carousel\n * then do not pass in object unless you want to hide the number indicators.\n * To intialise the defualt carousel pass this object\n * {\n *  defaultCarousel: true,\n *  hidNumInd: true,\n *  }\n *\n */\n\nfunction init(elem, options) {\n    if (options) {\n        config = options;\n    }\n\n    //inital setup\n    //lazy load images\n    const lazyImages = [].slice.call(document.querySelectorAll('img.lazy'));\n\n    if (\n        'IntersectionObserver' in window &&\n        'IntersectionObserverEntry' in window &&\n        'intersectionRatio' in window.IntersectionObserverEntry.prototype\n    ) {\n        let lazyImageObserver = new IntersectionObserver(function(entries) {\n            entries.forEach(function(entry, i) {\n                if (i === 0) {\n                    entry.target.firstElementChild.classList.remove('lazy');\n                }\n                if (entry.isIntersecting) {\n                    let lazyImage =\n                        entry.target.parentNode.nextSibling.firstElementChild\n                            .firstElementChild;\n                    lazyImage.src = lazyImage.dataset.src;\n                    lazyImage.classList.remove('lazy');\n                    lazyImageObserver.unobserve(entry.target);\n                }\n            });\n        });\n\n        lazyImages.forEach(function(lazyImage, i, a) {\n            if (i !== a.length - 1) {\n                lazyImageObserver.observe(lazyImage.parentNode);\n            } else {\n                lazyImage.classList.remove('lazy');\n            }\n        });\n    }\n\n    const _C = elem.querySelector('.swiper-wrapper'),\n        numInd = document.createElement('div'),\n        numIndActiveSl = document.createElement('span'),\n        numIndSeparator = document.createElement('span'),\n        numbIndSlLength = document.createElement('span'),\n        buttonsWrap = document.createElement('div'),\n        prevBtnWrap = document.createElement('div'),\n        nextBtnWrap = document.createElement('div'),\n        nextBtn = document.createElement('BUTTON'),\n        prevBtn = document.createElement('BUTTON');\n    //setup carousel buttons\n    buttonsWrap.className = 'swiper-buttons-wrap';\n    prevBtnWrap.className = 'swiper-button-prev';\n    nextBtnWrap.className = 'swiper-button-next';\n    nextBtn.name = 'nextButton';\n    nextBtn.type = 'button';\n    nextBtn.className =\n        'fas fa-arrow-right swiper-slider-arrow arrow-right--btn-next';\n    nextBtn.setAttribute('aria-label', 'Next slider');\n    nextBtn.addEventListener('click', next, false);\n    prevBtn.name = 'prevButton';\n    prevBtn.type = 'button';\n    prevBtn.className =\n        'fas fa-arrow-left swiper-slider-arrow arrow-left--btn-prev';\n    prevBtn.setAttribute('aria-label', 'Previous slider');\n    prevBtn.addEventListener('click', previous, false);\n    prevBtn.disabled = true;\n\n    nextBtnWrap.appendChild(nextBtn);\n    prevBtnWrap.appendChild(prevBtn);\n    buttonsWrap.appendChild(prevBtnWrap);\n    buttonsWrap.appendChild(nextBtnWrap);\n\n    if (!config.hidNumInd) {\n        //perpare the indicators to append to html\n        numInd.className = 'swiper-indicator';\n        numIndActiveSl.className = 'swiper-indicator__active-slider';\n        numbIndSlLength.className = 'swiper-indicator__slider-length';\n        numIndActiveSl.innerText = i + 1;\n        numbIndSlLength.innerText = _C.children.length;\n        numIndSeparator.innerText = ' /';\n\n        numInd.appendChild(numIndActiveSl);\n        numInd.appendChild(numIndSeparator);\n        numInd.appendChild(numbIndSlLength);\n\n        elem.appendChild(numInd);\n    }\n\n    elem.appendChild(buttonsWrap);\n\n    config.sliderLength = _C.children.length;\n\n    if (config.defaultCarousel) {\n        elem.querySelector('.galleria-thumbnails-list').style.setProperty(\n            '--thumbnails',\n            config.sliderLength\n        );\n    }\n\n    _C.style.setProperty('--n', config.sliderLength);\n    //add event listeners\n    _C.addEventListener('mousedown', lock, false);\n    _C.addEventListener('touchstart', lock, false);\n    _C.addEventListener('mousemove', drag, false);\n    _C.addEventListener('touchmove', drag, false);\n    _C.addEventListener('mouseup', move, false);\n    _C.addEventListener('touchend', move, false);\n    _C.addEventListener('mouseout', stopDrag, false);\n\n    _C.firstElementChild.classList.toggle('active');\n\n    activeSlider(i, _C);\n}\n\n/**\n * Set the number indicators Number\n *\n * @param {number} carousel index - current carousel index\n * @param {HTMLelement} indicator html - pass HTML containing the indicator\n */\n\nfunction numIndicator(index, e) {\n    e.querySelector('.swiper-indicator__active-slider').innerText = index + 1;\n}\n\n/**\n *\n * Set active slider\n *\n * @param {number} carousel index - current carousel index\n * @param {HTMLelement} sliders html - pass HTML containing the sliders\n */\n\nfunction activeSlider(index, sliders) {\n    let a = toArray(sliders.querySelectorAll('.swiper-slide'));\n    a.forEach(e => {\n        e.classList.remove('active');\n        e.querySelectorAll('a').forEach(a => (a.tabIndex = -1)); // disable focus on non active slider with hyperlinks\n        e.setAttribute('aria-hidden', 'true');\n    });\n    a[index].classList.toggle('active');\n    a[index].querySelectorAll('a').forEach(a => (a.tabIndex = 0));\n    a[index].setAttribute('aria-hidden', 'false');\n}\n\n/**\n *\n * Toggle next button\n *\n * @param {number} carousel index - current carousel index\n * @param {number} length of sliders -\n * @param {event} user event - interaction event perform by user\n */\n\nfunction toogleNextBtn(index, length, e) {\n    let nextBtn = checkEventType(e);\n\n    if (index + 1 === length) {\n        nextBtn.querySelector('.swiper-button-next button').disabled = true;\n        nextBtn.querySelector('.swiper-button-prev button').disabled = false;\n    } else if (i + 1 < length) {\n        nextBtn.querySelector('.swiper-button-next button').disabled = false;\n        nextBtn.querySelector('.swiper-button-prev button').disabled = false;\n    }\n    activeSlider(index, nextBtn);\n    if (!config.hidNumInd) {\n        numIndicator(index, nextBtn);\n    }\n}\n\n/**\n *\n * Toggle previous button\n *\n * @param {number} carousel index - current carousel index\n * @param {number} length of sliders -\n * @param {event} user event - interaction event perform by user\n */\n\nfunction tooglePrevBtn(index, length, e) {\n    let prevBtn = checkEventType(e);\n\n    if (index + 1 === 1) {\n        prevBtn.querySelector('.swiper-button-prev button').disabled = true;\n        prevBtn.querySelector('.swiper-button-next button').disabled = false;\n    } else if (i + 1 > 1) {\n        prevBtn.querySelector('.swiper-button-prev button').disabled = false;\n        prevBtn.querySelector('.swiper-button-next button').disabled = false;\n    }\n    activeSlider(index, prevBtn);\n    if (!config.hidNumInd) {\n        numIndicator(index, prevBtn);\n    }\n}\n\n/**\n *\n * Move slide either forwards or backwards\n *\n * @param {event} user event - interaction event perform by user from onClick on btn or thumbnail\n * @param {boolean} boolean for either next or pervious - boolean to check if next or previous is called\n */\n\nfunction moveSlide(e, t) {\n    const sl = checkEventType(e).querySelector('.swiper-wrapper');\n\n    if (sl.classList.contains('smooth')) {\n        sl.classList.toggle('smooth');\n    }\n\n    if (!ie) {\n        if (config.defaultCarousel && e.target.tagName === 'INPUT') {\n            sl.style.setProperty('--i', i);\n        } else {\n            t\n                ? sl.style.setProperty('--i', i != 0 ? (i += 1) : (i = 1))\n                : sl.style.setProperty('--i', i != 0 ? (i -= 1) : (i = 1));\n        }\n\n        sl.classList.toggle('smooth');\n\n        t\n            ? toogleNextBtn(i, sl.children.length, e)\n            : tooglePrevBtn(i, sl.children.length, e);\n    } else {\n        let sliderWidthIndex = (totalSliderWidth(e) / sl.children.length) * i,\n            sliderWidth = totalSliderWidth(e) / sl.children.length;\n\n        t\n            ? (sliderTranslateCoOr -= sliderWidth)\n            : (sliderTranslateCoOr += sliderWidth);\n\n        sl.classList.toggle('smooth');\n\n        if (config.defaultCarousel && e.target.tagName === 'INPUT') {\n            sliderTranslateCoOr = -sliderWidthIndex;\n            sl.style.setProperty(\n                'transform',\n                'translate(-' + sliderWidthIndex + 'px)'\n            );\n            sl.style.setProperty('--i', i);\n        } else {\n            sl.style.setProperty(\n                'transform',\n                'translate(' + sliderTranslateCoOr + 'px)'\n            );\n            t ? (i != 0 ? (i += 1) : (i = 1)) : i != 0 ? (i -= 1) : (i = 1);\n        }\n        t\n            ? toogleNextBtn(i, sl.children.length, e)\n            : tooglePrevBtn(i, sl.children.length, e);\n    }\n    if (config.defaultCarousel) {\n        activeThumbnail(i, e);\n    }\n}\n\n/**\n *\n * Next slide\n *\n * @param {event} user event - interaction event perform by user from onClick on btn or thumbnail\n */\n\nfunction next(e) {\n    e.preventDefault();\n    moveSlide(e, true);\n}\n\n/**\n *\n * Prvious slide\n *\n * @param {event} user event - interaction event perform by user from onClick on btn or thumbnail\n */\n\nfunction previous(e) {\n    e.preventDefault();\n    moveSlide(e, false);\n}\n\n/**\n *\n * Return touch points of either touch or mouse\n *\n * @param {event} user event - event on silder from either mouse or touch events\n * @returns {event | object} - either return the event back or the object of touch events\n */\n\nfunction unify(e) {\n    return e.changedTouches ? e.changedTouches[0] : e;\n} //return touch points or event\n\n/**\n *\n * Start of slider move Set mousedown value to global and toggle smooth class for css transition on mouse down or touch start\n *\n * @param {event} user event - user action either mosuedown or touch start\n */\n\nfunction lock(e) {\n    x0 = unify(e).clientX; //set mousedown clientX value\n    e.target.classList.toggle('smooth', !(locked = true));\n}\n\n/**\n *\n * Moving the slider - moving the slider trigger by mouse move or touch move\n *\n * @param {event} user event - mousetouch or touchmove\n */\n\nfunction drag(e) {\n    //e.preventDefault();\n    if (i !== e.target.children.length - 1 && i !== 0) {\n        if (locked) {\n            e.target.style.setProperty(\n                '--tx',\n                `${Math.round(unify(e).clientX - x0)}px`\n            );\n        }\n    }\n}\n\n/**\n *\n * Move slider\n *\n * @param {event} user event - mouseup or touchend\n */\n\nfunction move(e) {\n    if (locked) {\n        let dx = unify(e).clientX - x0, //dx is value calculate by using clientX mousedown and after value\n            s = Math.sign(dx), //check if swipe is left or right by checking value is negative or positive\n            tx = getComputedStyle(e.target).getPropertyValue('--tx'),\n            p = parseInt(tx.replace(/\\D/g, '')); // MAY use the drag length as a condition to move slider\n\n        if (\n            (i > 0 || s < 0) &&\n            (i < e.target.children.length - 1 || s > 0) &&\n            (p > 100 || i === 0 || i === e.target.children.length - 1) //conditions to swip to slider\n        ) {\n            if (!ie) {\n                e.target.style.setProperty('--i', (i -= s)); //increment i (i repersent the slider)\n                e.target.style.setProperty('--tx', '0px'); //reset touch x value\n                e.target.classList.toggle('smooth', !(locked = false));\n                x0 = null;\n                if (s === -1) {\n                    toogleNextBtn(i, e.target.children.length, e);\n                } else {\n                    tooglePrevBtn(i, e.target.children.length, e);\n                }\n            } else {\n                animateSlider(e, s);\n                s === -1\n                    ? toogleNextBtn(i, e.target.children.length, e)\n                    : tooglePrevBtn(i, e.target.children.length, e);\n            }\n            if (config.defaultCarousel) {\n                activeThumbnail(i, e);\n            }\n        }\n    }\n}\n\n/**\n *\n * Stop drag when mouse or touch move outside the slider element\n *\n * @param {event} user event - mouseup or touchend\n */\n\nfunction stopDrag(e) {\n    e.target.style.setProperty('--tx', '0px');\n    e.stopPropagation();\n    e.target.classList.toggle('smooth', !(locked = false));\n}\n\n/**\n *\n * Check event type and passing the correct parent node\n *\n * @param {event} user event - either mouse, touch, click events and thumbnail click events\n * @returns {HTMLSliderElement} -\n */\n\nfunction checkEventType(e) {\n    if (e.target.parentElement.classList.contains('galleria-thumbnail')) {\n        return e.target.parentElement.parentElement.parentElement.parentElement;\n    } else {\n        switch (e.type) {\n            case 'mouseup':\n                return e.target.parentElement.parentElement;\n\n            case 'touchend':\n                return e.target.parentElement.parentElement;\n\n            default:\n                return e.target.parentElement.parentElement.parentElement;\n        }\n    }\n}\n\n/**\n *\n * For edge browsers calculate silders total width\n *\n * @param {event} user event -\n * @returns {number} - total width of slider\n */\n\n//edge fall back cannot use CSS var inside a cal()\nfunction totalSliderWidth(e) {\n    const sliders = toArray(\n        checkEventType(e).querySelectorAll('.swiper-slide')\n    );\n    let totalWidth = 0;\n\n    sliders.forEach(s => {\n        let style = window.getComputedStyle\n            ? getComputedStyle(s, null)\n            : s.currentStyle;\n\n        totalWidth += s.offsetWidth + parseInt(style.marginRight) || 0;\n    });\n\n    return totalWidth;\n}\n\n/**\n *\n * Animate slider by setting translate value\n *\n * @param {event} user event -\n * @param {number}  - number either negative or a positive number\n */\n\nfunction animateSlider(e, lr) {\n    let sliderWidth = totalSliderWidth(e) / e.target.children.length;\n\n    lr === -1\n        ? (sliderTranslateCoOr -= sliderWidth)\n        : (sliderTranslateCoOr += sliderWidth);\n    e.target.style.setProperty(\n        'transform',\n        'translate(' + sliderTranslateCoOr + 'px)'\n    );\n    e.target.classList.toggle('smooth');\n    i -= lr;\n}\n\n/**\n *\n * Exported function for defualt caousel to preform when thumbnail it cliked on\n * move slider forward or backwards\n *\n * @param {event} user event - onlcik event on thumbnail\n * @param {number} thumbnail index -\n */\n\nfunction onClickThunbnail(thumbnail, thumbindex) {\n    if (thumbindex > i) {\n        i = thumbindex;\n        next(thumbnail);\n    } else if (thumbindex < i) {\n        i = thumbindex;\n        previous(thumbnail);\n    }\n\n    activeThumbnail(thumbindex, thumbnail);\n}\n\n/**\n *\n * Set click on thumbnail to be active\n *\n * @param {number} thumbnail index -\n * @param {event} user event - onlcik event on thumbnail\n */\n\nfunction activeThumbnail(thumbindex, e) {\n    let thumbnail = checkEventType(e),\n        currentThumbnailSpan = document.createElement('span'),\n        listThumbnail = thumbnail\n            .querySelector('.galleria-thumbnails-list')\n            .getElementsByTagName('li');\n    currentThumbnailSpan.innerText = 'Current thumbnail';\n    currentThumbnailSpan.className = 'galleria-thumbnail__current-thumbnail';\n    for (const li of listThumbnail) {\n        li.classList.remove('active');\n        if (li.querySelector('.galleria-thumbnail__current-thumbnail')) {\n            li.querySelector('.galleria-thumbnail__current-thumbnail').remove();\n        }\n    }\n\n    /*slider === 1\n        ? listThumbnail[thumbindex + 3].classList.add('fade')\n        : slider > lastTwoSlider\n        ? null\n        : listThumbnail[thumbindex + 2].classList.add('fade');*/\n\n    listThumbnail[thumbindex].classList.add('active');\n    listThumbnail[thumbindex].appendChild(currentThumbnailSpan);\n    translateThumbnails(thumbindex, e);\n}\n\n/**\n *\n * Move thumbnail\n *\n * @param {number} thumbnail index -\n * @param {event} user event - onlcik event on thumbnail\n */\n\nfunction translateThumbnails(thumbindex, e) {\n    let thumbnailLi = checkEventType(e).querySelector(\n            '.galleria-thumbnails-list'\n        ),\n        thumbnailLength = thumbnailLi.getElementsByTagName('li').length,\n        translate = 0;\n\n    if (thumbindex !== 0 && thumbnailLength > 4) {\n        let galleria = thumbnailLi.getElementsByTagName('li');\n        galleria.forEach((e, i) => {\n            if (i < thumbindex - 1) {\n                let style = window.getComputedStyle\n                    ? getComputedStyle(e, null)\n                    : e.currentStyle;\n                let width = parseInt(style.width) + parseInt(style.marginRight);\n                translate += width;\n            }\n        });\n        if (thumbindex >= 2) {\n            thumbnailLi.style.setProperty(\n                'transform',\n                'translate(-' + translate + 'px)'\n            );\n        } else {\n            thumbnailLi.style.setProperty('transform', 'translate(0px)');\n        }\n    }\n}\n\nexport { init, onClickThunbnail, translateThumbnails, checkEventType };\n\nexport default {\n    launchFn: init,\n    launchQuery: `.${className}`,\n};\n","/**\n * Key information box\n *\n * @module patterns/key-info-box/key-info-box\n * @author Mark Skinsley <mark.skinsley@city.ac.uk>\n * @copyright City, University of London 2019\n */\n\nimport scroll from 'zenscroll';\n// import { pxToRem } from '../../util';\n\nconst className = 'key-information--lifelong-learning';\n\nlet listings = document.querySelector(\n        '.key-information--lifelong-learning > ul'\n    ),\n    batchQuantity = 3,\n    contentToggles = Array.from(\n        document.querySelectorAll('.content-toggle button')\n    ),\n    contentSliders = document.querySelectorAll('.content-slider'),\n    browserWidth = document.documentElement.scrollWidth,\n    prevBtn = document.getElementById('key-info-previous-item'),\n    nextBtn = document.getElementById('key-info-next-item'),\n    // listingHeight = '',\n    listingDates = document.querySelectorAll(\n        '.key-information--lifelong-learning > ul > li'\n    ),\n    listingsVisible = [],\n    defaultDuration = 2000,\n    edgeOffset = 100;\n\n// Zen scroll setup\nscroll.setup(defaultDuration, edgeOffset);\n\n// Add '-1' tabindex to all listing dates. Will give screenreaders context\nfunction dateTabIndex() {\n    for (const listingDate of listingDates) {\n        listingDate.setAttribute('tabindex', '-1');\n    }\n}\n\n// Visible listings: needed to decide if more content still to be loaded.\nfunction calculateVisibleListings() {\n    listingsVisible = [];\n    Array.from(listings.children).forEach(elem => {\n        if (!elem.classList.contains('hide')) {\n            listingsVisible.push(elem);\n        }\n    });\n}\n\n// Initial listings display\nfunction defaultListingsDisplay() {\n    const listElements = Array.from(listings.children);\n\n    listElements.forEach((elem, i) => {\n        i > batchQuantity - 1\n            ? elem.classList.add('hide')\n            : (elem.style.display = 'grid');\n    });\n}\n\n/**\n * Launches Key Info slider pattern. Pass in how many listings should display per batch,\n * i.e. each time user selects 'Load more'.\n *  */\n\nfunction launchKeyInfo(batchQuantity) {\n    const digit = document.querySelector(\n        '.key-information--lifelong-learning__current__digit'\n    );\n    let counter = 0;\n\n    // Mobile: Show listing entry based on navigation button clicks\n    function listingDisplay() {\n        Array.from(listings.children).forEach((listing, i) => {\n            if (\n                browserWidth < 768 &&\n                Array.from(listings.children).length > 1\n            ) {\n                i === counter\n                    ? (listing.style.display = 'block')\n                    : (listing.style.display = 'none');\n            }\n            listing.setAttribute('data-id', `listing-${i}`);\n        });\n    }\n\n    // Mobile: Enable/disable navigation buttons based on position of listing in collection\n    function navBtnState() {\n        if (counter === 0) {\n            prevBtn.setAttribute('disabled', true);\n            nextBtn.removeAttribute('disabled');\n        } else if (\n            counter > 0 &&\n            counter < Array.from(listings.children).length - 1\n        ) {\n            prevBtn.removeAttribute('disabled');\n            nextBtn.removeAttribute('disabled');\n        } else {\n            nextBtn.setAttribute('disabled', true);\n            prevBtn.removeAttribute('disabled');\n        }\n    }\n\n    // // Mobile: Set mobile listings navigation buttons to correct position based on listing height\n    // function navBtnPosition() {\n    //     Array.from(listings.children).forEach((listing, i) => {\n    //         if (counter === i) {\n    //             listingHeight = listing.dataset.height;\n    //         }\n    //     });\n    // }\n\n    // Run regardless of viewport size\n    dateTabIndex();\n\n    // Desktop: Toggle control listings when more than three listings exist\n    if (browserWidth >= 768) {\n        if (Array.from(listings.children).length > batchQuantity) {\n            listingDisplay();\n            defaultListingsDisplay();\n            calculateVisibleListings();\n\n            contentToggles.forEach(contentToggle => {\n                contentToggle.addEventListener(\n                    'click',\n                    e => {\n                        // This will increase with each 'Load more' click, so visible listings\n                        // must be captured before any further listings are made visible\n                        let preExpandListingsVisible = listingsVisible.length;\n                        e.preventDefault();\n                        if (\n                            preExpandListingsVisible <\n                            Array.from(listings.children).length\n                        ) {\n                            Array.from(listings.children).forEach((elem, i) => {\n                                let targetListing = document.querySelector(\n                                    `[data-id='listing-${preExpandListingsVisible}']`\n                                );\n                                let listingsVisibleLength =\n                                    parseInt(listingsVisible.length) +\n                                    batchQuantity;\n                                const listingsLength = Array.from(\n                                    listings.children\n                                ).length;\n                                let remainingItems = parseInt(\n                                    listingsLength - listingsVisibleLength\n                                );\n                                // Zen scroll to first listing of newly visible listings and focus on date\n                                scroll.to(targetListing, 200);\n                                targetListing.focus();\n                                // let targetListingDate = targetListing.querySelectorAll(\n                                //     '.key-info__date'\n                                // );\n                                // Final batch of listings, zen scroll to 'load more' button and offset\n                                if (remainingItems <= 0) {\n                                    scroll.to(contentToggle, 200);\n                                    contentToggle.style.display = 'none';\n                                }\n                                // targetListingDate[0].focus();\n                                // Bring in newly visible listings in two phases to allow for opacity transition\n                                if (\n                                    i <\n                                    preExpandListingsVisible + batchQuantity\n                                ) {\n                                    const promise = new Promise(resolve => {\n                                        resolve((elem.style.display = 'grid'));\n                                    });\n                                    promise.then(() => {\n                                        elem.classList.remove('hide');\n                                    });\n                                    // Calculating visible listings must run here after display properties are updated\n                                    promise.then(() => {\n                                        calculateVisibleListings();\n                                    });\n                                }\n                            });\n                        }\n                    },\n                    false\n                );\n            });\n        } else {\n            contentToggles.forEach(elem => {\n                elem.style.display = 'none';\n            });\n        }\n        // Mobile: one listing visible at a time\n    } else if (browserWidth < 768 && Array.from(listings.children).length > 1) {\n        Array.from(listings.children).forEach((listing, i) => {\n            // Capture listing height and set to data attribute\n            listing.style.display = 'block';\n            listing.dataset.height = listing.offsetHeight;\n            listing.style.display = 'none';\n\n            // On load, set mobile navigation buttons at correct height\n            // counter === 0 && i === 0 ? navBtnPosition() : null;\n            i > 0\n                ? (listing.style.display = 'none')\n                : (listing.style.display = 'block');\n        });\n\n        Array.from(contentSliders).forEach(contentSlider => {\n            contentSlider.removeAttribute('hidden');\n        });\n\n        navBtnState();\n\n        prevBtn.addEventListener('click', () => {\n            counter = counter - 1;\n            navBtnState();\n            // navBtnPosition();\n            listingDisplay();\n            digit.innerText = counter + 1;\n        });\n\n        nextBtn.addEventListener('click', () => {\n            counter = counter + 1;\n            navBtnState();\n            // navBtnPosition();\n            listingDisplay();\n            digit.innerText = counter + 1;\n        });\n    } else if (\n        browserWidth < 768 &&\n        Array.from(listings.children).length === 1\n    ) {\n        Array.from(listings.children).forEach((listing, i) => {\n            i > 0\n                ? (listing.style.display = 'none')\n                : (listing.style.display = 'block');\n        });\n    }\n}\n\nfunction launchKeyInfoSlider() {\n    launchKeyInfo(batchQuantity);\n}\n\nexport default {\n    launchFn: launchKeyInfoSlider,\n    launchQuery: `.${className}`,\n};\n","/**\n * Link Finder\n *\n * @module patterns/link-finder/link-finder\n * @author Web Development\n * @copyright City, University of London 2019\n */\n\nimport aria from '../../aria-attributes';\n\nconst className = 'link-finder';\n\n/**\n * Function that prepends icon to anchor paramater\n *\n * @param {HTMLElement} anchor - HTML element to prepend icon to\n * @param {string} className - class name to specify FA icon\n */\nfunction prependIcon(anchor, className) {\n    let node = document.createElement('span');\n    node.className = 'fas ' + className + '  link-decorator';\n    node.setAttribute(aria.hidden, true);\n    anchor.parentNode.prepend(node);\n}\n\n/**\n * Checks if anchor has to have external URL icon\n *\n * @param {HTMLElement} anchor - an anchor HTML element\n */\nfunction findExternalLink(anchor) {\n    if (\n        anchor.origin !== window.location.origin &&\n        anchor.querySelectorAll('img').length < 1 &&\n        anchor.querySelectorAll('.fa-external-link').length < 1 &&\n        !anchor.parentElement.className.includes('cta-like-anchor') &&\n        anchor.className !== 'social-icon' &&\n        !anchor.parentElement.className.includes('cta-block') &&\n        anchor.href.indexOf('mailto:') !== 0 &&\n        anchor.href.indexOf('tel:') !== 0 &&\n        anchor.origin\n    ) {\n        let node = document.createElement('span');\n        node.className = 'far fa-external-link inline-external-link';\n        node.setAttribute(aria.label, '(external link)');\n        anchor.appendChild(node);\n    }\n}\n\n/**\n * This function checks if the anchor has any of the extensions from the 'fileTypes' object\n * if yes it calls prependIcon() to add the appropriate FA icon\n *\n * @param {HTMLElement} anchor - an anchor HTML element\n */\nfunction findDocumentLinks(anchor) {\n    const fileTypes = {\n        pdf: 'pdf',\n        docx: 'word',\n        doc: 'word',\n        xlsx: 'excel',\n        xls: 'excel',\n    };\n\n    for (let key in fileTypes) {\n        if (anchor.href.indexOf('.' + key) != -1) {\n            prependIcon(anchor, 'fa-file-' + fileTypes[key]);\n\n            let anchorText = anchor.textContent;\n            anchorText += ' [' + key.toUpperCase() + ']';\n            anchor.textContent = null;\n            anchor.textContent = anchorText;\n            break;\n        }\n    }\n}\n\n/**\n * Every anchor on the webpage has to have appropriate icons prepended or appended depending on predefined requirements\n * This function will iterate through every anchor of the HTML element and calls the appropriate function to add the right icon\n * if required\n *\n * @param {HTMLElement} e - an HTML element with 'link-finder' class name\n */\nfunction findLinks(e) {\n    const anchors = e.querySelectorAll('a');\n\n    anchors.forEach(function(anchor) {\n        findDocumentLinks(anchor);\n        findExternalLink(anchor);\n    });\n}\n\nexport default {\n    launchFn: findLinks,\n    launchQuery: `.${className}`,\n};\n","/**\n * Load more - show additional items on 'Load more' button click. Update URL to illustrate where user is in item set.\n *\n * @module patterns/load-more/load-more\n * @author Mark Skinsley <mark.skinsley@city.ac.uk>\n * @copyright City, University of London 2019\n */\n\nimport { numberFromString } from '../../util';\nimport scroll from 'zenscroll';\n\nconst className = 'load-more';\n\nlet hashedUrl = window.location.hash,\n    loadMoreId;\n\n/**\n * Control what items will display based on wrapper's 'data-listings-show' data attribute.\n *\n * @param {HTMLElements} [items] - Elements controlled by 'Load more' button.\n * @param {number} visibleItems - Number of items visible at any one time.\n * @param {HTMLElement} loadMoreBtn - Button controlling particular item group.\n */\nfunction itemsDisplay(items, visibleItems, loadMoreBtn) {\n    for (const item of items.entries()) {\n        item[1].setAttribute('tabindex', '-1');\n        if (item[0] >= visibleItems) {\n            item[1].classList.add('hide');\n            item[1].style.display = 'none';\n        } else {\n            item[1].classList.remove('hide');\n            item[1].style.display = 'grid';\n        }\n    }\n    // Hide 'load more' button when reached end of listings\n    if (visibleItems > items.length) {\n        loadMoreBtn.classList.add('hide');\n    } else {\n        loadMoreBtn.classList.remove('hide');\n    }\n}\n\n/**\n * Scroll to, and focus first listing of newly visible items batch.\n *\n * @param {HTMLElement} [items] - Elements controlled by 'Load more' button.\n * @param {number} visibleItems - Number of items visible at any one time.\n * @param {number} itemsIncrement - Number of additional items shown when 'Load more' button is clicked.\n */\nfunction scrollToItem(items, visibleItems, itemsIncrement) {\n    let targetItem = visibleItems - itemsIncrement;\n    for (const item of items.entries()) {\n        if (item[0] == targetItem) {\n            item[1].focus();\n            scroll.to(item[1]);\n        } else if (visibleItems == itemsIncrement) {\n            if (item[0] == 0) {\n                item[1].focus();\n                scroll.to(item[1]);\n            }\n        }\n    }\n}\n\n/**\n * Push state to URL: used to build initial hash after first 'Load more' click.\n *\n * @param {string} parentType - Data attribute describing parent group.\n * @param {string} childrenType - Data attribute describing child items.\n * @param {HTMLElement} wrapperId - Parent element wrapping items and 'Load more' button.\n * @param {number} visibleItems - Number of items visible at any one time.\n * @param {number} itemsIncrement - Number of additional tems shown when 'Load more' button is clicked.\n */\nfunction pushUrlState(\n    parentType,\n    childrenType,\n    wrapperId,\n    visibleItems,\n    itemsIncrement\n) {\n    let targetListingUrlParam = visibleItems - (itemsIncrement - 1);\n    history.pushState(\n        '',\n        '',\n        `#${parentType}${wrapperId}-${childrenType}${targetListingUrlParam}`\n    );\n}\n\n/**\n * Replace URL state: used to swap existing hash\n *\n * @param {string} parentType - Data attribute describing parent group.\n * @param {string} childrenType - Data attribute describing child items.\n * @param {HTMLElement} wrapperId - Parent element wrapping items and 'Load more' button.\n * @param {number} visibleItems - Number of items visible at any one time.\n * @param {number} itemsIncrement - Number of additional tems shown when 'Load more' button is clicked.\n */\nfunction replaceUrlState(\n    parentType,\n    childrenType,\n    wrapperId,\n    visibleItems,\n    itemsIncrement\n) {\n    let targetListingUrlParam = visibleItems - (itemsIncrement - 1);\n    history.replaceState(\n        '',\n        '',\n        `#${parentType}${wrapperId}-${childrenType}${targetListingUrlParam}`\n    );\n}\n\nfunction launchLoadMore(e) {\n    let wrapperId = e.getAttribute('id'),\n        items = e.querySelectorAll('.item'),\n        itemsIncrement = parseInt(e.dataset.increment),\n        loadMoreBtn = e.querySelector('.content-toggle button'),\n        parentType = e.getAttribute('data-item-parent'),\n        childrenType = e.getAttribute('data-item-children');\n    /**\n     * Give wrapper a numeric data attribute. As this changes, so\n     * will the number of visible items.\n     */\n    e.setAttribute('data-items-visible', itemsIncrement);\n    let visibleItems = parseInt(e.getAttribute('data-items-visible'));\n\n    // Load correct number of items based on URL hash\n    if (hashedUrl) {\n        let hashedUrlParts = hashedUrl.split('-');\n        let activeItem = parseInt(numberFromString(hashedUrlParts[1]));\n        visibleItems = activeItem + (itemsIncrement - 1);\n        e.setAttribute('data-items-visible', visibleItems);\n        itemsDisplay(items, visibleItems, loadMoreBtn);\n        scrollToItem(items, visibleItems, itemsIncrement);\n    } else {\n        itemsDisplay(items, visibleItems, loadMoreBtn);\n    }\n\n    // Run on every 'load more' click: increase listings by batch number\n    loadMoreBtn.addEventListener('click', () => {\n        visibleItems += itemsIncrement;\n        e.setAttribute('data-items-visible', visibleItems);\n        itemsDisplay(items, visibleItems, loadMoreBtn);\n        scrollToItem(items, visibleItems, itemsIncrement);\n        hashedUrl = window.location.hash;\n        hashedUrl\n            ? replaceUrlState(\n                  parentType,\n                  childrenType,\n                  wrapperId,\n                  visibleItems,\n                  itemsIncrement\n              )\n            : pushUrlState(\n                  parentType,\n                  childrenType,\n                  wrapperId,\n                  visibleItems,\n                  itemsIncrement\n              );\n        loadMoreId = e.id;\n    });\n\n    // Back/forward browser clicks.\n    window.onpopstate = () => {\n        let loadMoreIdElement = document.getElementById(loadMoreId);\n\n        // Must re-assign variable on pop state change\n        hashedUrl = window.location.hash;\n\n        if (hashedUrl) {\n            // Capture latest hash\n            let updatedUrlParts = window.location.hash.split('-');\n            let currentItem = parseInt(numberFromString(updatedUrlParts[1]));\n            currentItem = currentItem + (itemsIncrement - 1);\n            visibleItems = currentItem;\n\n            e.setAttribute('data-items-visible', visibleItems);\n            itemsDisplay(items, visibleItems, loadMoreBtn);\n            scrollToItem(items, visibleItems, itemsIncrement);\n        } else {\n            let relatedItems = loadMoreIdElement.querySelectorAll('.item');\n            visibleItems = itemsIncrement;\n            itemsDisplay(items, visibleItems, loadMoreBtn);\n            e.setAttribute('data-items-visible', itemsIncrement);\n            scrollToItem(relatedItems, visibleItems, itemsIncrement);\n        }\n    };\n}\n\nexport default {\n    launchFn: launchLoadMore,\n    launchQuery: `.${className}`,\n};\n","/**\n * Generic navigation functions for menu and secondary navigation.\n *\n * @module menu-formatters\n * @author Web Development\n * @copyright City, University of London 2020\n */\n\nimport scroll from 'zenscroll';\nimport { toBool, appendAll, reduceMotion } from '../../util';\nimport aria from '../../aria-attributes';\n\nconst scrollDuration = reduceMotion() ? 0 : 999;\n\n/**\n * Set sub-menu button attributes for the open/closed state.\n *\n * @param {HTMLButtonElement} button - The button to decorate.\n * @param {boolean} open - Should it be open?\n * @param {string} buttonTextClassName - The class of the text span.\n */\nfunction setNavigationItemButtonDetails(button, open, rootClass) {\n    const navigationItem = button.closest('li'),\n        sectionText = navigationItem.dataset.title + ' section',\n        buttonClassName = rootClass + '__button',\n        buttonTextClassName = buttonClassName + '__text',\n        textSpan = button.querySelector(`.${buttonTextClassName}`),\n        text = open ? 'Close ' : 'Open ';\n\n    open &&\n        Array.from(button.closest('ul').querySelectorAll('button')).forEach(\n            button => setNavigationItemButtonDetails(button, false, rootClass)\n        );\n\n    navigationItem.dataset.open = open;\n    button.setAttribute(aria.expanded, open);\n    button.title = text + sectionText;\n    textSpan.innerText = text + sectionText;\n}\n\n/**\n * Toggle a sub-navigation open or closed.\n */\nfunction toggleSubNavigation(button, rootClass) {\n    const expanded = button.getAttribute(aria.expanded),\n        elem = document.querySelector('html'),\n        scrollList = scroll.createScroller(elem);\n\n    toBool(expanded)\n        ? setNavigationItemButtonDetails(button, false, rootClass)\n        : setNavigationItemButtonDetails(button, true, rootClass);\n\n    scrollList.intoView(button.closest('li'), scrollDuration);\n}\n\n/**\n * Decorate sub-navigation element with the appropriate attributes.\n *\n * @param {HTMLLIElement} navigationItem - The list item representing button navigation item.\n * @param {string} rootClass - The class of the navigation element.\n */\nfunction prepareSubNavigation(navigationItem, rootClass) {\n    const navigationItemBtn = document.createElement('button'),\n        iconSpan = document.createElement('span'),\n        textSpan = document.createElement('span'),\n        controlsClassName = rootClass + '__controls',\n        buttonClassName = rootClass + '__button',\n        buttonTextClassName = buttonClassName + '__text',\n        buttonIconClassName = buttonClassName + '__icon',\n        currentClassName = rootClass + '__current',\n        hierarchyClassName = rootClass + '__hierarchy',\n        controlsWrapper = navigationItem.querySelector(`.${controlsClassName}`);\n\n    navigationItemBtn.setAttribute('type', 'button');\n    iconSpan.setAttribute(aria.hidden, 'true');\n    iconSpan.className = `${buttonIconClassName} fal fa-fw`;\n    textSpan.className = `${buttonTextClassName}`;\n    appendAll(navigationItemBtn, [iconSpan, textSpan]);\n    controlsWrapper.appendChild(navigationItemBtn);\n\n    if (\n        navigationItem.className.indexOf(currentClassName) >= 0 ||\n        navigationItem.className.indexOf(hierarchyClassName) >= 0\n    ) {\n        setNavigationItemButtonDetails(navigationItemBtn, true, rootClass);\n    } else {\n        setNavigationItemButtonDetails(navigationItemBtn, false, rootClass);\n    }\n}\n\n/**\n * Iterate over the navigation lists, transforming them into the initial\n * navigation with the current asset lineage open.\n *\n * @param {HTMLElement} navigation - The navigation container.\n * @param {string} rootClass - The class of the navigation element.\n */\nexport function prepareNavigation(navigation, rootClass) {\n    const controlsClassName = rootClass + '__controls',\n        currentClassName = rootClass + '__current';\n\n    Array.from(navigation.querySelectorAll('li')).forEach(navigationItem => {\n        const link = navigationItem.querySelector('a'),\n            subNavigation = navigationItem.querySelector('ul'),\n            linkText = 'Visit ' + navigationItem.dataset.title,\n            textWrapper = document.createElement('span'),\n            currentPageWrapper = document.createElement('span'),\n            controlsWrapper = document.createElement('div');\n\n        controlsWrapper.className = controlsClassName;\n\n        /**\n         * To format the current page the same as a link, we need to double-wrap\n         * it in spans. To programmatically focus it, we need to give it a\n         * tabindex.\n         *\n         * Actual links only need one span.\n         */\n        if (navigationItem.className.indexOf(currentClassName) >= 0) {\n            textWrapper.appendChild(navigationItem.firstChild.cloneNode(true));\n            currentPageWrapper.appendChild(textWrapper);\n            currentPageWrapper.setAttribute('tabindex', -1);\n            navigationItem.replaceChild(\n                controlsWrapper,\n                navigationItem.firstChild\n            );\n            controlsWrapper.appendChild(currentPageWrapper);\n        } else {\n            textWrapper.appendChild(link.firstChild.cloneNode(true));\n            link.replaceChild(textWrapper, link.firstChild);\n            link.title = linkText;\n            navigationItem.replaceChild(controlsWrapper, link);\n            controlsWrapper.appendChild(link);\n        }\n\n        subNavigation &&\n            subNavigation.firstElementChild &&\n            prepareSubNavigation(navigationItem, rootClass);\n    });\n}\n\n/**\n * Open/close the sub-menu when its button is clicked.\n *\n * @param {HTMLUListElement} subNavigation - Toggle the sub-navigation when its button is clicked.\n * @param {string} rootClass - The class of the navigation element.\n */\nexport function listenForNavigationToggles(subNavigation, rootClass) {\n    Array.from(subNavigation.querySelectorAll('button')).forEach(button =>\n        button.addEventListener(\n            'click',\n            () => toggleSubNavigation(button, rootClass),\n            true\n        )\n    );\n}\n","/**\n * Global menu\n *\n * @module patterns/menu/menu\n * @author Web Development\n * @copyright City, University of London 2018-2020\n */\nimport createFocusTrap from 'focus-trap';\nimport { toBool, isVisible } from '../../util';\nimport aria from '../../aria-attributes';\nimport {\n    prepareNavigation,\n    listenForNavigationToggles,\n} from './menu-formatters';\n\nconst className = 'menu',\n    hierarchyClassName = className + '__hierarchy',\n    currentClassName = className + '__current',\n    veilClassName = className + '__veil',\n    contentClassName = className + '__content',\n    contentHeaderClassName = contentClassName + '__header',\n    controlsClassName = className + '__controls',\n    buttonDisplayClassName = className + '__display__button',\n    buttonClassName = className + '__button',\n    level1ClassName = className + '__level1',\n    buttonTextClassName = buttonClassName + '__text';\n\n/**\n * Creates a function for setting a menu to be open or closed.\n *\n * @param {HTMLElement} menu - The menu container.\n * @param {HTMLButtonElement} button - The button that toggles the menu.\n * @returns {Function} A function that will set the menu to be open/closed.\n */\nfunction menuSetter(menu, button) {\n    /**\n     * @param {boolean} open - Set the menu to be open?\n     */\n    const setMenu = open => {\n        const buttonText = button.querySelector(`.${buttonTextClassName}`);\n\n        menu.dataset.open = open;\n        buttonText.innerText = open ? 'Close' : 'Menu';\n        button.setAttribute(aria.expanded, open);\n    };\n\n    return setMenu;\n}\n\n/**\n * Opens or closes the menu, (de)activates the focus trap if provided, and\n * scrolls the sub-menus so that the current page lineage or open menus are in\n * view.\n *\n * @param {HTMLButtonElement} button - The button for toggling the menu.\n * @param {Function} setMenu - A function for setting menu attributes to be open/closed.\n * @param {object} trap - The focus trap object.\n * @param {HTMLElement} veil - The veiling element.\n */\nfunction toggleMenu(button, setMenu, trap, veil) {\n    const expanded = button.getAttribute(aria.expanded);\n    if (toBool(expanded)) {\n        trap.deactivate();\n        veil.dataset.on = 'false';\n        setMenu(false);\n    } else {\n        setMenu(true);\n        veil.dataset.on = 'true';\n        trap.activate();\n    }\n}\n\n/**\n * Turn the menu label into a button to toggle the menu open and closed.\n *\n * While the menu is open, a focus trap should limit tab indexing to the menu\n * and its button.\n *\n * @param {HTMLElement} label - The menu label.\n * @param {HTMLButtonElement} button - A button element.\n * @param {Function} setMenu - A function to open/close the menu.\n * @param {HTMLElement} veil - The veiling element.\n */\nfunction createMenuToggle(label, button, setMenu, veil) {\n    const buttonWrapper = document.createElement('div'),\n        menu = label.closest(`.${className}`);\n\n    button.setAttribute('type', 'button');\n    button.setAttribute(aria.hasPopup, 'menu');\n    Array.from(label.childNodes).forEach(child =>\n        buttonWrapper.appendChild(child)\n    );\n    button.appendChild(buttonWrapper);\n\n    const trap = createFocusTrap(menu, {\n        /**\n         * Initial focus should be whichever of: the current page; a menu item\n         * in the asset lineage or; the first item in the last column appears\n         * last in the DOM and is visible.\n         */\n        initialFocus: () => {\n            const open = Array.from(\n                menu.querySelectorAll(\n                    [\n                        `.${contentHeaderClassName} > span`,\n                        `.${currentClassName} > .${controlsClassName} > span`,\n                        `.${hierarchyClassName} > .${controlsClassName} > a`,\n                        `.${level1ClassName} > ul > li:first-of-type > .${controlsClassName} > a`,\n                    ].join(',')\n                )\n            ).filter(elem => isVisible(elem));\n\n            return open[open.length - 1];\n        },\n        onDeactivate: () => toggleMenu(button, setMenu, trap, veil),\n        clickOutsideDeactivates: true,\n    });\n\n    button.addEventListener(\n        'click',\n        () => toggleMenu(button, setMenu, trap, veil),\n        true\n    );\n}\n\n/**\n * Transform the Matrix-generated menu lists into an interactive menu.\n *\n * @param {HTMLElement} menu - The menu element.\n */\nfunction launchMenu(menu) {\n    // During testing only: remove 'under construction' indicators globally\n    menu.innerHTML = menu.innerHTML.replace(/\\(\\( /g, '').replace(/ \\)\\)/g, '');\n\n    const label = menu.querySelector(`.${buttonDisplayClassName}`),\n        button = document.createElement('button'),\n        veil = document.createElement('div'),\n        setMenu = menuSetter(menu, button);\n\n    veil.className = veilClassName;\n    veil.setAttribute(aria.hidden, 'true');\n    document\n        .querySelector('body')\n        .insertBefore(veil, document.querySelector('main'));\n\n    createMenuToggle(label, button, setMenu, veil);\n    label.appendChild(button);\n    setMenu(false);\n\n    prepareNavigation(menu.querySelector(`.${level1ClassName}`), className);\n    listenForNavigationToggles(\n        menu.querySelector(`.${level1ClassName}`),\n        className\n    );\n}\n\nexport default {\n    launchFn: launchMenu,\n    launchQuery: `.${className}`,\n};\n","/**\n * modal\n *\n * @module patterns/modal/modal\n * @author Daniel Miller <daniel.miller@city.ac.uk>\n * @copyright City, University of London 2018\n *\n */\n\nimport createFocusTrap from 'focus-trap';\n\nconst className = 'modal__popup';\nlet modalBackground = document.createElement('div'),\n    trap;\n\n/**\n * Launch function: sets the modal attr to hidden, adds\n * elements to toggle the modal, adds event listeners to those\n * elements to toggle the modal and sets tab indexes\n * on all anchor elements\n *\n * @param {HTMLElement} modal - the modal\n *\n */\nfunction launchModal(modal) {\n    let modalCustomClass = modal.getAttribute('data-class');\n    modal.setAttribute('data-hidden', true);\n\n    let linkElement = document.createElement('a');\n    linkElement.className = 'modal__trigger';\n    modalCustomClass ? linkElement.classList.add(modalCustomClass) : null;\n    linkElement.setAttribute('href', '#');\n    linkElement.textContent = modal.getAttribute('data-title');\n    modal.parentNode.prepend(linkElement);\n\n    let modalCloseElement = document.createElement('a');\n    modalCloseElement.className = 'modal__close fas fa-times';\n    modalCloseElement.setAttribute('href', '#');\n    modalCloseElement.setAttribute('aria--label', 'Close modal');\n    modal\n        .querySelector('.modal__heading')\n        .parentNode.prepend(modalCloseElement);\n\n    addEventListeners(modal, linkElement, modalCloseElement);\n    setTabIndexes(modal, true);\n}\n\n/**\n * Add event listeners: adds all the required event listerners\n *\n * @param {HTMLElement} modal - the modal\n * @param {HTMLElement} linkElement - the modal trigger anchor\n * @param {HTMLElement} modalCloseElement - the modal close trigger\n *\n */\nfunction addEventListeners(modal, linkElement, modalCloseElement) {\n    linkElement.addEventListener('click', openModal, false);\n    modalCloseElement.addEventListener('click', closeModal, false);\n\n    /*\n     * listen for escape key press and close\n     */\n    modal.addEventListener('keydown', e => {\n        if (e.keyCode === 27) {\n            closeModal(e);\n        }\n    });\n\n    /*\n     * listen for a click outside of modal inner and close\n     */\n    modal.addEventListener('click', e => {\n        if (e.target.classList.contains('modal__popup')) {\n            closeModal(e);\n        }\n    });\n}\n\n/**\n * Open modal: runs all the required functions\n * to open the modal\n *\n * @param {event} e - click event\n *\n */\nfunction openModal(e) {\n    e.preventDefault();\n    let modal = e.target.nextElementSibling;\n    addBackgroundFade();\n    document.body.classList.add('modal--in', 'no-scroll');\n    modal.removeAttribute('data-hidden', true);\n    setTabIndexes(modal, false);\n    trapFocus(modal);\n}\n\n/**\n * Close modal: runs all the required functions\n * to close the modal\n *\n * @param {event} e - click event\n *\n */\nfunction closeModal(e) {\n    e.preventDefault();\n\n    let modal;\n\n    if (e.target.classList.contains('modal__close')) {\n        modal = e.target.closest('.modal__popup');\n    } else {\n        modal = e.target;\n    }\n\n    document.body.classList.remove('modal--in', 'no-scroll');\n    modal.setAttribute('data-hidden', true);\n    setTabIndexes(modal, true);\n    trap.deactivate();\n}\n\n/**\n * Add background fade: adds the background fade element\n * to the body. Only adds once if element not in source\n *\n */\nfunction addBackgroundFade() {\n    if (!document.body.contains(modalBackground)) {\n        modalBackground.setAttribute('class', 'modal__background');\n        document.body.appendChild(modalBackground);\n    }\n}\n\n/**\n * Set tab indexes: when the modal is closed, the anchors\n * lose their tab indexes, when the modal is open, the\n * attr is removed so the user can tab through them\n *\n * @param {HTMLElement} modal - the modal\n * @param {boolean} removeTabIndex - no index or remove\n *\n */\nfunction setTabIndexes(modal, removeTabIndex) {\n    let elements = modal.querySelectorAll('a');\n\n    elements.forEach(function(el) {\n        if (removeTabIndex) {\n            el.setAttribute('tabindex', '-1');\n        } else {\n            el.removeAttribute('tabindex');\n        }\n    });\n}\n\n/**\n * Trap focus: focus needs to be trapped inside the\n * modal when it's opened. This function takes care of\n * this\n *\n * @param {HTMLElement} modal - the modal\n *\n */\nfunction trapFocus(modal) {\n    let modalInner = modal.querySelector('.modal__inner');\n\n    trap = createFocusTrap(modalInner, {\n        clickOutsideDeactivates: true,\n    });\n    trap.activate();\n}\n\nexport default {\n    launchFn: launchModal,\n    launchQuery: `.${className}`,\n};\n","/**\n * Secondary navigation\n *\n * @module patterns/navigation/navigation-primary\n * @author Web Development\n * @copyright City, University of London 2019\n */\nimport { toBool, appendAll } from '../../util';\nimport aria from '../../aria-attributes';\n\nconst className = 'navigation',\n    currentClassName = className + '__current',\n    classNameSpecific = className + '--primary',\n    topLevelClassName = classNameSpecific + '__section-text',\n    buttonClassName = className + '__button',\n    openCloseTextClassName = buttonClassName + '__open-close',\n    navigationTextClassName = buttonClassName + '__navigation',\n    veilClassName = className + '__veil',\n    openText = 'Open',\n    closeText = 'Close',\n    navigationText = 'navigation section',\n    [keyCodeTab, keyCodeEscape] = [9, 27];\n\n/**\n * Return a function to toggle everything closed.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n * @param {HTMLElement} veil - The veiling element.\n * @returns {function} - A function for toggling all the menus closed.\n */\nfunction createCloseAll(navigation, veil) {\n    return () => {\n        const buttons = Array.from(\n            navigation.querySelectorAll(\n                '.navigation--primary__level1 > .navigation__button'\n            )\n        );\n\n        buttons.forEach(button => {\n            button.setAttribute(aria.expanded, 'false');\n            button\n                .querySelector(`.${openCloseTextClassName}`)\n                .replaceChild(\n                    document.createTextNode(openText),\n                    button.querySelector(`.${openCloseTextClassName}`)\n                        .firstChild\n                );\n        });\n        veil.dataset.on = 'false';\n    };\n}\n\n/**\n * Return a function to toggle whether a navigation section is open.\n * @param {HTMLElement} button - The button to toggle.\n * @param {function} closeAll - A function for closing all menus.\n * @param {HTMLElement} veil - The veiling element.\n * @returns {function} - A function for toggling a menu open or closed.\n */\nfunction createSectionToggle(button, closeAll, veil) {\n    return () => {\n        const open = !toBool(button.getAttribute(aria.expanded));\n\n        closeAll();\n\n        if (open) {\n            veil.dataset.on = 'true';\n            button.setAttribute(aria.expanded, open);\n            button\n                .querySelector(`.${openCloseTextClassName}`)\n                .replaceChild(\n                    document.createTextNode(closeText),\n                    button.querySelector(`.${openCloseTextClassName}`)\n                        .firstChild\n                );\n        }\n    };\n}\n\n/**\n * Create toggle buttons from the top level anchors.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n * @param {HTMLElement} veil - The veiling element.\n * @param {function} closeAll - A function for closing all menus.\n */\nfunction prepareTopLevel(navigation, veil, closeAll) {\n    const topLevels = Array.from(\n        navigation.querySelectorAll(`.${topLevelClassName}`)\n    );\n\n    topLevels.forEach(el => {\n        const listItem = el.parentNode,\n            button = document.createElement('button'),\n            buttonDiv = document.createElement('div'),\n            srOpenCloseSpan = document.createElement('span'),\n            srNavigationSpan = document.createElement('span'),\n            toggleSection = createSectionToggle(button, closeAll, veil);\n\n        // LIs have tabindex so they're accessible with no JS, remove it\n        el.removeAttribute('tabindex');\n\n        button.setAttribute(aria.expanded, 'false');\n        button.setAttribute(aria.owns, el.nextElementSibling.id);\n        button.setAttribute('type', 'button');\n        button.id = el.nextElementSibling.id + '-button';\n        button.className = buttonClassName;\n\n        srOpenCloseSpan.className = openCloseTextClassName;\n        srOpenCloseSpan.appendChild(document.createTextNode(openText));\n\n        srNavigationSpan.className = navigationTextClassName;\n        srNavigationSpan.appendChild(document.createTextNode(navigationText));\n\n        button.addEventListener('click', () => toggleSection(), true);\n\n        appendAll(buttonDiv, [\n            srOpenCloseSpan,\n            document.createTextNode(' '),\n            el,\n            document.createTextNode(' '),\n            srNavigationSpan,\n        ]);\n        button.append(buttonDiv);\n        listItem.prepend(button);\n    });\n}\n\n/**\n * Add event listeners to top level buttons enabling shift-tabbing into the previous\n * section.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n * @param {function} closeAll - A function for closing all menus.\n * @param {HTMLElement} veil - The veiling element.\n */\nfunction setupTabPrevious(navigation, closeAll, veil) {\n    const firstButton = navigation.querySelector(\n            '.navigation--primary__level1:first-of-type > .navigation__button'\n        ),\n        restButtons = Array.from(\n            navigation.querySelectorAll(\n                '.navigation--primary__level1:not(:first-of-type) > .navigation__button'\n            )\n        );\n\n    // If we tab out of the open, first menu into the other header content, close the menu.\n    firstButton.addEventListener('keydown', e => {\n        if (\n            toBool(firstButton.getAttribute(aria.expanded)) &&\n            keyCodeTab === e.keyCode &&\n            e.shiftKey\n        ) {\n            closeAll();\n        }\n    });\n\n    restButtons.forEach(thisSectionButton => {\n        const previousSection =\n                thisSectionButton.parentElement.previousElementSibling,\n            previousSectionButton = previousSection.querySelector('button'),\n            lastNavigationAnchor = previousSection.querySelector(\n                '.navigation__level2 > li:last-of-type > a'\n            )\n                ? previousSection.querySelector(\n                      '.navigation__level2 > li:last-of-type > a'\n                  )\n                : previousSection\n                      .querySelector('.navigation__level2 > li:last-of-type')\n                      .previousElementSibling.querySelector('a'),\n            togglePreviousSection = createSectionToggle(\n                previousSectionButton,\n                closeAll,\n                veil\n            );\n\n        thisSectionButton.addEventListener(\n            'keydown',\n            e => {\n                if (\n                    toBool(thisSectionButton.getAttribute(aria.expanded)) &&\n                    keyCodeTab === e.keyCode &&\n                    e.shiftKey\n                ) {\n                    e.preventDefault();\n\n                    togglePreviousSection();\n                    lastNavigationAnchor.focus();\n                }\n            },\n            true\n        );\n    });\n}\n\n/**\n * Add event listeners to the final anchor in each section allowing tabbing into\n * the next navigation section.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n * @param {function} closeAll - A function to close the entire menu.\n * @param {HTMLElement} veil - The veiling element.\n */\nfunction setupTabNext(navigation, closeAll, veil) {\n    const closeButton = navigation.querySelector(\n            '.navigation--primary__level1:last-of-type .wrapper--navigation--primary__menu__close button'\n        ),\n        restSectionsCloseButtons = Array.from(\n            navigation.querySelectorAll(\n                '.navigation--primary__level1:not(:last-of-type) .wrapper--navigation--primary__menu__close button'\n            )\n        );\n\n    // If we tab out of the open, first menu into the other header content, close the menu.\n    closeButton.addEventListener('keydown', e => {\n        if (\n            toBool(\n                closeButton\n                    .closest('.navigation--primary__level1')\n                    .querySelector('button')\n                    .getAttribute(aria.expanded)\n            ) &&\n            keyCodeTab === e.keyCode &&\n            !e.shiftKey\n        ) {\n            closeAll();\n        }\n    });\n\n    restSectionsCloseButtons.forEach(closeButton => {\n        const nextSectionButton = closeButton\n                .closest('.navigation--primary__level1')\n                .nextElementSibling.querySelector('button'),\n            toggleNextSection = createSectionToggle(\n                nextSectionButton,\n                closeAll,\n                veil\n            );\n\n        closeButton.addEventListener(\n            'keydown',\n            e => {\n                if (keyCodeTab === e.keyCode && !e.shiftKey) {\n                    e.preventDefault();\n\n                    toggleNextSection();\n                    nextSectionButton\n                        .closest('.navigation--primary__level1')\n                        .querySelector('.navigation--primary__menu__header a')\n                        .focus();\n                }\n            },\n            true\n        );\n    });\n}\n\n/**\n * Wrap anchor text in spans for styling.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n */\nfunction prepareLowerLevels(navigation) {\n    Array.from(navigation.querySelectorAll('.navigation__level2 li')).forEach(\n        navigationItem => {\n            const link = navigationItem.querySelector('a'),\n                textWrapper = document.createElement('span');\n\n            /**\n             * To format the current page the same as a link, we need to\n             * double-wrap.\n             *\n             * Actual links only need one span.\n             */\n            if (navigationItem.className.indexOf(currentClassName) >= 0) {\n                const currentPageWrapper = document.createElement('span'),\n                    linkText = navigationItem.firstChild.wholeText.trim();\n\n                textWrapper.appendChild(document.createTextNode(linkText));\n                currentPageWrapper.appendChild(textWrapper);\n                navigationItem.replaceChild(\n                    currentPageWrapper,\n                    navigationItem.firstChild\n                );\n            } else {\n                textWrapper.appendChild(link.firstChild.cloneNode(true));\n                link.replaceChild(textWrapper, link.firstChild);\n            }\n        }\n    );\n}\n\n/**\n * Wrap header text in spans for styling.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n */\nfunction prepareHeaders(navigation) {\n    Array.from(\n        navigation.querySelectorAll('.navigation--primary__menu__header')\n    ).forEach(header => {\n        const link = header.querySelector('a'),\n            textWrapper = document.createElement('span');\n\n        if (!link) {\n            const currentPageWrapper = document.createElement('span'),\n                linkText = header.firstChild.wholeText.trim();\n\n            textWrapper.appendChild(document.createTextNode(linkText));\n            currentPageWrapper.appendChild(textWrapper);\n            header.replaceChild(currentPageWrapper, header.firstChild);\n        } else {\n            textWrapper.appendChild(link.firstChild.cloneNode(true));\n            link.replaceChild(textWrapper, link.firstChild);\n        }\n    });\n}\n\n/**\n * Add close buttons to menu sections.\n *\n * @param {HTMLElement} navigation\n */\nfunction addCloseButtons(navigation, closeAll) {\n    Array.from(\n        navigation.querySelectorAll('.navigation--primary__menu__content')\n    ).forEach(menu => {\n        const header = menu.querySelector('.navigation--primary__menu__header'),\n            closeButtonWrapper = document.createElement('div'),\n            closeButton = document.createElement('button'),\n            closeButtonDiv = document.createElement('div'),\n            closeButtonText = document.createElement('span'),\n            closeButtonIcon = document.createElement('span'),\n            text = 'Close ' + header.innerText.trim() + ' menu';\n\n        closeButtonText.appendChild(document.createTextNode(text));\n        closeButtonText.className = 'navigation--primary__menu__close__text';\n\n        closeButtonIcon.setAttribute(aria.hidden, 'true');\n        closeButtonIcon.className =\n            'fas fa-fw fa-times navigation--primary__menu__close__icon';\n\n        closeButtonWrapper.className =\n            'wrapper--navigation--primary__menu__close';\n\n        closeButton.className = 'navigation--primary__menu__close';\n\n        appendAll(closeButtonDiv, [closeButtonText, closeButtonIcon]);\n        closeButton.appendChild(closeButtonDiv);\n        closeButton.setAttribute('type', 'button');\n        closeButton.title = text;\n        closeButton.addEventListener('click', () => closeAll(), true);\n\n        closeButtonWrapper.appendChild(closeButton);\n\n        menu.appendChild(closeButtonWrapper);\n    });\n}\n\n/**\n * Transform the Matrix-generated navigation lists into an interactive menu.\n *\n * @param {HTMLElement} navigation - The primary navigation element.\n */\nfunction launchPrimaryNavigation(navigation) {\n    // During testing only: remove 'under construction' indicators globally\n    navigation.innerHTML = navigation.innerHTML\n        .replace(/\\(\\( /g, '')\n        .replace(/ \\)\\)/g, '');\n\n    const veil = document.createElement('div'),\n        closeAll = createCloseAll(navigation, veil);\n\n    veil.className = veilClassName;\n    veil.setAttribute(aria.hidden, 'true');\n    document\n        .querySelector('body')\n        .insertBefore(veil, document.querySelector('main'));\n\n    prepareTopLevel(navigation, veil, closeAll);\n    prepareLowerLevels(navigation, veil);\n    prepareHeaders(navigation);\n    addCloseButtons(navigation, closeAll);\n\n    // Allow tabbing from one section to another,\n    // and close when tabbing out of the navigation\n    setupTabPrevious(navigation, closeAll, veil);\n    setupTabNext(navigation, closeAll, veil);\n\n    // If the navigation is open, close on escape.\n    navigation.addEventListener(\n        'keydown',\n        e => {\n            if (\n                navigation.querySelector(\n                    `.${buttonClassName}[aria-expanded='true']`\n                ) &&\n                keyCodeEscape === e.keyCode\n            ) {\n                e.preventDefault();\n                closeAll();\n            }\n        },\n        true\n    );\n\n    // If the navigation is open, close it on click outside it.\n    window.addEventListener(\n        'click',\n        e => {\n            if (\n                navigation.querySelector(\n                    `.${buttonClassName}[aria-expanded='true']`\n                ) &&\n                !e.target.closest(`.${classNameSpecific}`)\n            ) {\n                closeAll();\n            }\n        },\n        true\n    );\n}\n\nexport default {\n    launchFn: launchPrimaryNavigation,\n    launchQuery: `.${classNameSpecific}`,\n};\n","/**\n * Secondary navigation\n *\n * @module patterns/navigation/navigation-secondary\n * @author Web Development\n * @copyright City, University of London 2019\n */\nimport {\n    prepareNavigation,\n    listenForNavigationToggles,\n} from '../menu/menu-formatters';\n\nconst className = 'navigation',\n    classNameSpecific = className + '--secondary';\n\n/**\n * Transform the Matrix-generated navigation lists into an interactive menu.\n *\n * @param {HTMLElement} navigation - The secondary navigation element.\n */\nfunction launchSecondaryNavigation(navigation) {\n    // During testing only: remove 'under construction' indicators globally\n    navigation.innerHTML = navigation.innerHTML\n        .replace(/\\(\\( /g, '')\n        .replace(/ \\)\\)/g, '');\n\n    prepareNavigation(navigation, className);\n    listenForNavigationToggles(navigation, className);\n}\n\nexport default {\n    launchFn: launchSecondaryNavigation,\n    launchQuery: `.${classNameSpecific}`,\n};\n","/**\n * Paginated list\n *\n * @module patterns/paginated-list/paginated-list\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport { pageClassName, addPagination } from '../pagination/pagination.js';\nimport { removeClass } from '../../util';\nimport aria from '../../aria-attributes.js';\n\nconst className = 'paginated-list',\n    minimumPage = 1,\n    defaultPage = 8,\n    maximumPage = 12;\n\n/**\n * Ensure the page size is within the defined range.\n *\n * @param {number} pageSizeSetting - The user-requested page size.\n * @returns {number} The validated page size.\n */\nfunction setPageSize(pageSizeSetting) {\n    if (pageSizeSetting < minimumPage) {\n        return minimumPage;\n    } else if (pageSizeSetting > maximumPage) {\n        return maximumPage;\n    } else {\n        return pageSizeSetting;\n    }\n}\n\n/**\n * Transform an (un)ordered list into a paginated list, preserving the numbering\n * of the original if set.\n *\n * If the element is not a list or there are too few items to paginate, clean\n * up the DOM and return without paginating.\n *\n * @param {HTMLUListElement|HTMLOListElement} list - An (un)ordered list element with the paginated-list class.\n */\nfunction launchPaginatedList(list) {\n    if (!(list.tagName === 'UL' || list.tagName === 'OL')) {\n        /**\n         * not a list, remove the classname\n         * to avoid conflicting styles then bail\n         */\n        removeClass(list, className, false);\n        return;\n    }\n\n    const pageSizeSetting = Number.parseInt(list.dataset.pagesize)\n            ? Number.parseInt(list.dataset.pagesize)\n            : defaultPage,\n        listItems = Array.from(list.children),\n        pageSize = setPageSize(pageSizeSetting);\n\n    if (listItems.length <= pageSize) {\n        /**\n         * list too short, doesnt need pagination.\n         * remove the classname to avoid conflicting\n         * styles then bail\n         */\n        removeClass(list, className, false);\n        return;\n    }\n\n    const pages = [],\n        /** ordered lists can be reversed.\n         * if the original was reversed,\n         * all our sub-lists must be too\n         */\n        reversed =\n            list.tagName === 'OL' && list.hasAttribute('reversed')\n                ? true\n                : false,\n        /**\n         * the start attribute may be set,\n         * if not the start is either 1\n         * or the list length (if reversed)\n         */\n        start =\n            list.tagName === 'OL' && list.hasAttribute('start')\n                ? Number.parseInt(list.hasAttribute('start'))\n                : reversed\n                ? listItems.length\n                : 1;\n\n    list.setAttribute('role', 'presentation');\n\n    let pageNumber = 0,\n        pageItems = listItems.slice(0, pageSize);\n\n    /* loop through items while we can still make a page */\n    while (pageItems.length > 0) {\n        const page = document.createElement('li'),\n            newList =\n                list.tagName === 'UL'\n                    ? document.createElement('ul')\n                    : document.createElement('ol');\n\n        /**\n         * set start attribute and keep reversed attribute\n         * on ordered lists\n         */\n        if (list.tagName === 'OL') {\n            if (!reversed) {\n                newList.setAttribute('start', pageSize * pageNumber + start);\n            } else {\n                newList.setAttribute('start', start - pageSize * pageNumber);\n                newList.setAttribute('reversed', 'true');\n            }\n        }\n\n        /* move this page of items into the page and inner list */\n        pageItems.forEach(listItem => newList.appendChild(listItem));\n        page.appendChild(newList);\n        page.className = pageClassName;\n        page.setAttribute('tabindex', -1);\n        page.setAttribute(aria.label, `Page ${pageNumber + 1}`);\n        pages.push(page);\n\n        /* try to fetch another page */\n        ++pageNumber;\n        pageItems = listItems.slice(\n            pageSize * pageNumber,\n            pageSize * pageNumber + pageSize\n        );\n    }\n\n    /* add the pages to the original list in bulk */\n    pages.forEach(page => list.appendChild(page));\n    addPagination(list, listItems.length);\n}\n\nexport default {\n    launchFn: launchPaginatedList,\n    launchQuery: `.${className}`,\n};\n","/**\n * Pagination\n *\n * @module patterns/pagination/pagination\n * @author Web Development\n * @copyright City, University of London 2018\n */\nimport scroll from 'zenscroll';\nimport { removeClass, reduceMotion } from '../../util';\nimport aria from '../../aria-attributes';\n\nconst className = 'pagination',\n    pageClassName = 'page',\n    wrapperClassName = className + '__wrapper',\n    controlsClassName = className + '__controls',\n    controlsElementClassName = controlsClassName + '__element',\n    ellipsisClassName = controlsClassName + '__ellipsis',\n    buttonClassName = controlsClassName + '__button',\n    summaryClassName = className + '__summary',\n    nextPrevRegEx = new RegExp(`${buttonClassName}--(next|prev)`),\n    maximumButtonsToDisplay = 6,\n    scrollDuration = reduceMotion() ? 0 : 999;\n\n/**\n * Creates a function for enabling/disabling the next/previous page buttons when\n * there's nothing for them to do.\n *\n * @param {HTMLButtonElement} next - The next page button.\n * @param {HTMLButtonElement} prev - The previous page button.\n * @param {number} pageCount - The total number of pages in this paginated element.\n * @returns {Function} A function that will disable the next/previous buttons when there is no next/previous page.\n */\nfunction createToggleNextPrev(next, prev, pageCount) {\n    /***\n     * Disables the next/previous page buttons if there is no next/previous page\n     * relative to this page.\n     *\n     * @param {number} pageNumber - The current page number.\n     */\n    const toggleNextPrev = pageNumber => {\n        pageCount === pageNumber\n            ? next.setAttribute('disabled', 'true')\n            : next.removeAttribute('disabled');\n\n        1 === pageNumber\n            ? prev.setAttribute('disabled', 'true')\n            : prev.removeAttribute('disabled');\n    };\n    return toggleNextPrev;\n}\n\n/**\n * Calculate proximity to current page, so we can hide extraneous buttons.\n *\n * @param {number} pageCount - The total number of pages in this paginated element.\n * @param {HTMLButtonElement[]} controls - An array of control buttons.\n * @param {number} pageNumber - The number of the current page.\n */\nfunction setProximity(pageCount, controls, pageNumber) {\n    if (pageCount > maximumButtonsToDisplay) {\n        controls.forEach(function(button) {\n            if (!button.className.match(nextPrevRegEx)) {\n                const buttonNumber = Number.parseInt(button.dataset.page);\n                button.dataset.proximity = buttonNumber - pageNumber;\n            }\n        });\n    }\n}\n\n/**\n * Set the attributes to make a page button (un)selected.\n *\n * @param {HTMLButtonElement} button - The button element.\n * @param {boolean} selected - Should the button indicated selection?\n */\nfunction toggleButton(button, selected) {\n    button.setAttribute(aria.expanded, selected);\n    selected\n        ? button.setAttribute('disabled', 'true')\n        : button.removeAttribute('disabled');\n    selected\n        ? button.setAttribute(aria.current, 'page')\n        : button.removeAttribute(aria.current);\n}\n\n/**\n * 'Close' all pages and mark all buttons as not selected.\n *\n * @param {HTMLElement[]} pages - An array of page elements.\n * @param {HTMLButtonElement[]} controls - An array of control buttons.\n */\nfunction closeAll(pages, controls) {\n    pages.forEach(page => (page.dataset.open = false));\n    controls.forEach(function(button) {\n        if (!button.className.match(nextPrevRegEx)) {\n            toggleButton(button, false);\n        }\n    });\n}\n\n/**\n * Create a function that, given a page number, sets the page to be open and\n * optionally scrolls it into view.\n *\n * @param {HTMLElement[]} pages - The pages of this paginated element.\n * @param {HTMLElement} controls - The nav element containing the pagination control buttons.\n * @param {Function} toggleNextPrev - A function to enable/disable the next/previous page buttons when appropriate.\n * @returns {Function} A function for opening a given page number and optionally scrolling it into view.\n */\nfunction createOpenPage(pages, controls, toggleNextPrev) {\n    /**\n     * Open a given page number and optionally scroll it into view.\n     *\n     * @param {number} pageNumber - The number of the page to open.\n     * @param {boolean} [focus] - Focus the newly-opened page? Defaults to false.\n     * @param {boolean} [scrollTo] - Scroll to the top of the newly-opened page? Defaults to false.\n     */\n    const openPage = (pageNumber, focus, scrollTo) => {\n        const pagesArray = Array.from(\n                pages.querySelectorAll(`.${pageClassName}`)\n            ),\n            controlsArray = Array.from(controls.querySelectorAll('button'));\n        closeAll(pagesArray, controlsArray);\n        const page = pages.querySelector(\n                `.${pageClassName}:nth-of-type(${pageNumber})`\n            ),\n            button = controls.querySelector(`[data-page=\"${pageNumber}\"]`);\n        setProximity(pagesArray.length, controlsArray, pageNumber);\n        toggleNextPrev(pageNumber);\n        page.dataset.open = true;\n        toggleButton(button, true);\n        focus && page.focus();\n        scrollTo && scroll.to(page, scrollDuration);\n    };\n    return openPage;\n}\n\n/**\n * Create a function that will respond to a next or previous button click.\n *\n * @param {HTMLElement} controls - The controls container.\n * @param {Function} newPageFn - A function that, given the current page number, returns the page number to open.\n * @param {Function} openPage - A function that, given a page number, opens the page and optionally scrolls it into view.\n * @returns {Function} A function to respond to next/previous button clicks.\n */\nfunction createNextPrevOpenPage(controls, newPageFn, openPage) {\n    /**\n     * Returns a function that responds to next/previous button clicks.\n     */\n    const nextPrevOpenPage = () => {\n        const currentPage = Number.parseInt(\n            controls.querySelector(`[${aria.expanded}=\"true\"]`).dataset.page\n        );\n        openPage(newPageFn(currentPage), true, false);\n    };\n    return nextPrevOpenPage;\n}\n\n/**\n * Create and set summary text for a paginated element.\n *\n * @param {HTMLParagraphElement} summary - The element to transform into a summary.\n * @param {number} pageCount - The number of pages in the paginated element.\n * @param {number} [itemCount] - Optionally, the total number of items across all pages.\n */\nfunction setSummaryText(summary, pageCount, itemCount) {\n    let summaryText = `${pageCount} pages)`;\n    if (itemCount && Number.parseInt(itemCount)) {\n        summaryText = `(${itemCount} items on ` + summaryText;\n    } else {\n        summaryText = '(' + summaryText;\n    }\n    summary.appendChild(document.createTextNode(summaryText));\n}\n\n/**\n * Sets attributes and adds listeners to the next/previous page buttons.\n *\n * @param {HTMLButtonElement} next - The next page button element.\n * @param {HTMLButtonElement} prev - The previous page button element.\n * @param {HTMLElement} controls - The controls container element.\n * @param {number} pageCount - The total number of pages in the paginated element.\n * @param {Function} openPage - A function that, given a page number, opens the page and optionally scrolls it into view.\n */\nfunction prepareNextPrev(next, prev, controls, pageCount, openPage) {\n    [\n        {\n            button: next,\n            class: buttonClassName + '--next',\n            text: 'Next page',\n            newPageFn: pageNumber => pageNumber < pageCount && pageNumber + 1,\n        },\n        {\n            button: prev,\n            class: buttonClassName + '--prev',\n            text: 'Previous page',\n            newPageFn: pageNumber => pageNumber > 1 && pageNumber - 1,\n        },\n    ].forEach(button => {\n        const btn = button.button,\n            btnSpan = document.createElement('span');\n\n        btn.className = button.class;\n        btn.setAttribute('type', 'button');\n        btnSpan.appendChild(document.createTextNode(button.text));\n        btn.appendChild(btnSpan);\n        btn.addEventListener(\n            'click',\n            createNextPrevOpenPage(controls, button.newPageFn, openPage),\n            true\n        );\n    });\n}\n\n/**\n * Create a new page select button.\n *\n * @param {number} pageNumber - The page that this button is for.\n * @param {number} totalPages - The total number of pages in the paginated element.\n * @returns {HTMLButtonElement} A new button element.\n */\nfunction createPageButton(pageNumber, totalPages) {\n    const button = document.createElement('button'),\n        buttonSpan = document.createElement('span');\n    buttonSpan.appendChild(document.createTextNode(pageNumber));\n    button.dataset.page = pageNumber;\n    button.setAttribute('type', 'button');\n    button.setAttribute(aria.label, `Open page ${pageNumber}`);\n\n    if (totalPages - pageNumber === 1) {\n        button.className = `${controlsElementClassName} ${buttonClassName} ${buttonClassName}--penultimate`;\n    } else if (totalPages === pageNumber) {\n        button.className = `${controlsElementClassName} ${buttonClassName} ${buttonClassName}--last`;\n    } else {\n        button.className = `${controlsElementClassName} ${buttonClassName}`;\n    }\n\n    button.appendChild(buttonSpan);\n    return button;\n}\n\n/**\n * Adds pagination controls to an element containing two or more page elements.\n *\n * e.g.\n *\n * <div class=\"pagination\">\n * <div class=\"page\">Page 1 content</div>\n * <div class=\"page\">Page 2 content</div>\n * </div>\n *\n * @param {HTMLElement} elem - The element to paginate.\n * @param {number} [itemCount] - Optionally, the total number of items on all pages combined.\n */\nfunction addPagination(elem, itemCount) {\n    const wrapper = document.createElement('div'),\n        pages = Array.from(elem.querySelectorAll(`.${pageClassName}`)),\n        controls = document.createElement('nav'),\n        next = document.createElement('button'),\n        prev = document.createElement('button'),\n        pageButtons = [],\n        summary = document.createElement('p'),\n        toggleNextPrev = createToggleNextPrev(next, prev, pages.length),\n        openPage = createOpenPage(elem, controls, toggleNextPrev),\n        ellipsisFirst = document.createElement('span'),\n        ellipsisFirstInner = document.createElement('span'),\n        ellipsisLast = document.createElement('span'),\n        ellipsisLastInner = document.createElement('span');\n\n    if (!pages.length > 1) {\n        /**\n         * too few pages, doesnt need pagination.\n         * remove the classname to avoid conflicting\n         * styles then bail\n         */\n        removeClass(elem, className, false);\n        return;\n    }\n\n    ellipsisFirst.className = `${controlsElementClassName} ${ellipsisClassName} ${ellipsisClassName}--first`;\n    ellipsisFirstInner.innerText = '';\n    ellipsisFirst.appendChild(ellipsisFirstInner);\n    ellipsisLast.className = `${controlsElementClassName} ${ellipsisClassName} ${ellipsisClassName}--last`;\n    ellipsisLastInner.innerText = '';\n    ellipsisLast.appendChild(ellipsisLastInner);\n\n    prepareNextPrev(next, prev, controls, pages.length, openPage);\n\n    pageButtons.push(prev);\n    for (let pageNumber = 1; pageNumber <= pages.length; pageNumber++) {\n        const pageButton = createPageButton(pageNumber, pages.length);\n        pageButton.addEventListener('click', () =>\n            openPage(pageNumber, true, false)\n        );\n\n        if (pages.length > 2 && pageNumber === pages.length) {\n            pageButtons.push(ellipsisLast);\n        }\n\n        pageButtons.push(pageButton);\n\n        if (pages.length > 2 && pageNumber === 1) {\n            pageButtons.push(ellipsisFirst);\n        }\n    }\n    pageButtons.push(next);\n\n    wrapper.className = wrapperClassName;\n    controls.className = controlsClassName;\n    controls.dataset.pagecount = pages.length;\n    controls.setAttribute(aria.label, 'Pagination');\n    summary.className = summaryClassName;\n    setSummaryText(summary, pages.length, itemCount);\n\n    elem.parentNode.replaceChild(wrapper, elem);\n    wrapper.appendChild(elem);\n    pageButtons.forEach(pageButton => controls.appendChild(pageButton));\n    openPage(1, false, false);\n\n    wrapper.appendChild(controls);\n    wrapper.appendChild(summary);\n}\n\nexport { addPagination, pageClassName };\n\nexport default {\n    launchFn: addPagination,\n    launchQuery: `.${className}`,\n};\n","/**\n * Show-more\n *\n * @module patterns/show-more/show-more\n * @author Web Development\n * @copyright City, University of London 2018-2019\n */\nimport aria from '../../aria-attributes';\nimport { toBool } from '../../util';\n\nconst className = 'show-more';\n\n/**\n * innitial function on page load; it hides text container of 'show-more' DOM element, and calles\n * createShowMoreButton(element) function to create a control button\n *\n * @param {HTMLElement} element - HTML parent element with classname 'show-more'\n */\nfunction showMore(element) {\n    let showMoreTextElements = document.querySelectorAll('.show-more__text');\n\n    showMoreTextElements.forEach(element => {\n        element.setAttribute('data-hidden', 'true');\n    });\n\n    createShowMoreButton(element);\n}\n\n/**\n * event listener that handles click event of 'show-more' button\n *\n * @param {object} e - MouseEvent object\n */\nfunction handleShowMoreClick(e) {\n    e.preventDefault();\n    let parent = e.currentTarget.parentNode.parentNode.parentNode;\n    let showMoreText = parent.querySelector('.show-more__text');\n    let showMoreAnchorLinkText = parent.querySelector('.show-more__link-text');\n\n    let hiddenElement = toBool(showMoreText.dataset.hidden);\n\n    if (hiddenElement) {\n        e.currentTarget.setAttribute('data-open', 'true');\n        showMoreText.setAttribute('data-hidden', 'false');\n        showMoreAnchorLinkText.textContent = 'Show less';\n        showMoreText.style.maxHeight = '100%';\n        let headingElement = parent.querySelector('h2');\n        headingElement.scrollIntoView();\n    } else {\n        e.currentTarget.setAttribute('data-open', 'false');\n        showMoreText.setAttribute('data-hidden', 'true');\n        showMoreAnchorLinkText.textContent = 'Show more';\n        showMoreText.style.maxHeight = null;\n        let headingElement = parent.querySelector('h2');\n        headingElement.scrollIntoView();\n    }\n}\n\n/**\n * create 'show-more' button in the following HTML structure then append it to '.show-more' HTML element\n * <div class=\"show-more__button__container\">\n *  <span class=\"show-more__button\">\n *    <a href=\"\">\n *      <span class=\"icon fal fa-plus-circle\" aria-hidden=\"true\"></span>\n *      <span class=\"icon fal fa-minus-circle\" aria-hidden=\"true\"></span>\n *      <span class=\"show-more__link-text\">Show more</span>\n *      <span class=\"sr-only\"> about the {[data]=title} </span>\n *    </a>\n *  </span>\n * </div>\n *\n * @param {HTMLElement} element - HTML parent element with classname 'show-more'\n */\nfunction createShowMoreButton(element) {\n    let showMoreButtonDiv = document.createElement('div');\n    showMoreButtonDiv.classList.add('show-more__button__container');\n\n    let showMoreButton = document.createElement('span');\n    showMoreButton.classList.add('show-more__button');\n    showMoreButtonDiv.appendChild(showMoreButton);\n\n    let showMoreAnchor = document.createElement('a');\n    showMoreAnchor.setAttribute('href', '');\n    showMoreAnchor.addEventListener('click', handleShowMoreClick);\n\n    showMoreButton.appendChild(showMoreAnchor);\n\n    element.appendChild(showMoreButtonDiv);\n\n    let plusIcon = document.createElement('span');\n    plusIcon.classList.add('icon');\n    plusIcon.classList.add('fal');\n    plusIcon.classList.add('fa-plus-circle');\n    plusIcon.setAttribute(aria.hidden, true);\n\n    let minusIcon = document.createElement('span');\n    minusIcon.classList.add('icon');\n    minusIcon.classList.add('fal');\n    minusIcon.classList.add('fa-minus-circle');\n    minusIcon.setAttribute(aria.hidden, true);\n\n    let showMoreText = document.createElement('span');\n    showMoreText.classList.add('show-more__link-text');\n    showMoreText.appendChild(document.createTextNode('Show more'));\n\n    let dataTitle = element.getAttribute('data-title');\n\n    let srTextElement = document.createElement('span');\n    srTextElement.appendChild(document.createTextNode('about ' + dataTitle));\n    srTextElement.classList.add('sr-only');\n\n    showMoreAnchor.appendChild(plusIcon);\n    showMoreAnchor.appendChild(minusIcon);\n    showMoreAnchor.appendChild(showMoreText);\n    showMoreAnchor.appendChild(srTextElement);\n}\n\nexport default {\n    launchFn: showMore,\n    launchQuery: `.${className}`,\n};\n","/**\n * Responsive Slider\n *\n * @module patterns/slider-responsive/slider-responsive\n * @author Mark Skinsley <mark.skinsley@city.ac.uk>\n * @copyright City, University of London 2019\n */\n\nimport { removeClass, createHTMLElement } from '../../util';\nconst className = 'slider-responsive';\nlet sliderChildren, sliderChildrenLength, updatedPosition;\n\n/**\n * The number of items to display on each slide.\n *\n * @param {Number} sliderIncrement - Amount to increase/decrease visible listing index number.\n * @param {Number} currentPosition - Index number of first item to be visible.\n * @param {String} sliderDirection - Increase or decrease visible index number.\n * @param {Element} slider - The slider.\n */\nfunction itemsDisplay(\n    sliderIncrement,\n    currentPosition,\n    sliderDirection,\n    slider\n) {\n    // Show next, or previous, group of listings based on button's slider direction\n    sliderDirection == 'forward'\n        ? (updatedPosition = parseInt(currentPosition + sliderIncrement))\n        : (updatedPosition = parseInt(currentPosition - sliderIncrement));\n\n    // Prevent updated index position dropping below 1\n    updatedPosition < 1 ? (updatedPosition = 1) : null;\n\n    let items = slider.querySelectorAll('li');\n\n    /**\n     * Loop through all slides, adding data-device attributes to items based on their\n     * position within the list. The CSS will target what to show/hide at different breakpoints.\n     * You will end up with HTML similar to the following:\n     *\n     * <li data-device=\"mobile\"></li>\n     * <li data-device=\"tablet\"></li>\n     * <li data-device=\"desktop\"></li>\n     */\n    for (let i = 0; i < items.length; i++) {\n        // Check item exists before adding data attribute to prevent errors\n        items[i].getAttribute('data-device')\n            ? items[i].removeAttribute('data-device')\n            : null;\n        items[updatedPosition - 1]\n            ? items[updatedPosition - 1].setAttribute('data-device', 'mobile')\n            : null;\n        items[updatedPosition]\n            ? items[updatedPosition].setAttribute('data-device', 'tablet')\n            : null;\n        items[updatedPosition + 1]\n            ? items[updatedPosition + 1].setAttribute('data-device', 'desktop')\n            : null;\n    }\n}\n\n/**\n * Determines controller's behaviour, i.e. what slide the user is currently at within the\n * items list. Depending on the slider increment and the total number of items, the total\n * slides number adjusts too.\n *\n * For example, by default a grouping with 5 items will show as '1/2' on desktop, as this\n * viewport has an increment of 3 and there are effectively 2 slides at this point. However,\n * if user is at position 2, this will update to read '2/3'.\n *\n * This function updates all 3 controllers concurrently, updating their values indepenently.\n *\n * @param {Number} sliderIncrement - Amount to increase/decrease visible listing index number.\n * @param {Number} currentPosition - Index number of first item to be visible.\n * @param {String} sliderDirection - Increase or decrease visible index number.\n * @param {Element} slider - The slider.\n */\nfunction progressUpdate(\n    sliderIncrement,\n    currentPosition,\n    sliderDirection,\n    slider\n) {\n    let controlWraps = slider.querySelectorAll('.slider__controls__wrap');\n    for (const controlWrap of controlWraps) {\n        // Increase/decrease progrees indicator based on button click.\n        if (sliderDirection == 'forward') {\n            updatedPosition = currentPosition + sliderIncrement;\n        }\n        if (\n            sliderDirection == 'back' &&\n            currentPosition - sliderIncrement >= 1\n        ) {\n            updatedPosition = currentPosition - sliderIncrement;\n        }\n        if (\n            sliderDirection == 'back' &&\n            currentPosition - sliderIncrement < 1\n        ) {\n            updatedPosition = 1;\n        }\n        controlWrap.setAttribute('data-currentposition', updatedPosition);\n    }\n\n    // Update properties on all controls, not just the active control\n    for (const control of controlWraps) {\n        control.setAttribute('data-currentposition', updatedPosition);\n        sliderIncrement = control.getAttribute('data-increment');\n        let currentGroup = updatedPosition / sliderIncrement;\n        let progressIndicator = control.querySelector(\n            '.slide__controls__progress__active'\n        );\n\n        let totalSlides = parseInt(control.getAttribute('data-slides'));\n        let totalSlidesDisplay = control.querySelector(\n            '.slide__controls__progress__total'\n        );\n\n        /**\n         * Check if there is a remainder when dividing the current listing position by it's controller's\n         * increment. If there is, increase progress indicator and total slides by 1.\n         */\n        let firstInGroup = false;\n        if ((updatedPosition - 1) % sliderIncrement == 0) {\n            firstInGroup = true;\n        }\n\n        // If index position not first in group\n        if (!firstInGroup) {\n            // Increase group position by 1 to account for extra slide\n            currentGroup += 1;\n            // Not within final group of items and has a remainder -> add slide\n            if (\n                sliderChildrenLength - updatedPosition >= sliderIncrement &&\n                updatedPosition < sliderChildrenLength &&\n                (sliderChildrenLength - 1) % sliderIncrement !== 0\n            ) {\n                totalSlides += 1;\n                totalSlidesDisplay.textContent = totalSlides;\n                // Not within final group of items and has no remainder -> don't add slide\n            } else if (\n                sliderChildrenLength - updatedPosition >= sliderIncrement &&\n                updatedPosition < sliderChildrenLength &&\n                (sliderChildrenLength - 1) % sliderIncrement == 0\n            ) {\n                totalSlidesDisplay.textContent = totalSlides;\n                // Within final group and only one slide in group -> add slide\n            } else if (\n                sliderChildrenLength - updatedPosition < sliderIncrement &&\n                totalSlides == 1\n            ) {\n                totalSlides += 1;\n                totalSlidesDisplay.textContent = totalSlides;\n                currentGroup = totalSlides;\n            }\n            // First in group and ndex position is 1 -> don't add slide\n        } else if (\n            sliderChildrenLength == sliderIncrement &&\n            updatedPosition == 1\n        ) {\n            totalSlidesDisplay.textContent = totalSlides;\n        }\n\n        /**\n         * If increment increase exceeds total slides' length, limit the current\n         * position value to the total slides' length. This can happen when\n         * clicking on desktop viewport and reducing screen size to tablet or\n         * mobile.\n         */\n        if (currentGroup > totalSlides) {\n            control.setAttribute('data-currentposition', totalSlides);\n        } else {\n            progressIndicator.textContent = Math.ceil(currentGroup);\n        }\n\n        // Disable control buttons if at start or end of items in slider.\n        if (Math.ceil(currentGroup) >= totalSlides) {\n            control\n                .querySelector('.slider__controls__buttons__next')\n                .setAttribute('disabled', true);\n        } else {\n            control\n                .querySelector('.slider__controls__buttons__next')\n                .removeAttribute('disabled');\n        }\n        if (Math.ceil(currentGroup) <= 1) {\n            control\n                .querySelector('.slider__controls__buttons__prev')\n                .setAttribute('disabled', true);\n        } else {\n            control\n                .querySelector('.slider__controls__buttons__prev')\n                .removeAttribute('disabled');\n        }\n    }\n}\n\n/**\n * Turn a group of list items into a responsive slider where, depending on viewport, the number of visible items\n * at any one time, varies. This pattern is designed to accommodate up to three items per slide.\n *\n * @param {HTMLElement} slider - The slider.\n */\nfunction launchResponsiveSlider(slider) {\n    // Slider items count\n    sliderChildren = [...slider.children];\n    sliderChildrenLength = sliderChildren.length;\n\n    // Disable responsive slider if less than 2 items exists\n    if (sliderChildrenLength < 2) {\n        removeClass(slider, className, false);\n        return;\n    }\n\n    for (const sliderChild of sliderChildren.entries()) {\n        sliderChild[1].classList.add('slider__slide');\n        let items = slider.querySelectorAll('li');\n\n        /**\n         * Add data attribute to first three listings. This will control what is visible on load,\n         * depending on device type.\n         **/\n        for (let i = 0; i <= 2 || i < sliderChildrenLength; i++) {\n            items[0] ? items[0].setAttribute('data-device', 'mobile') : null;\n            items[1] ? items[1].setAttribute('data-device', 'tablet') : null;\n            items[2] ? items[2].setAttribute('data-device', 'desktop') : null;\n        }\n    }\n\n    /**\n     * Builds slider controls.\n     * @param {String} deviceType\n     * @param {Number} increment\n     * @param {Number} currentPosition\n     */\n    function buildControls(deviceType, increment, currentPosition) {\n        let slides = Math.ceil(sliderChildrenLength / increment);\n        let sliderControlsWrap = createHTMLElement('div', [\n            { label: 'class', val: 'slider__controls__wrap' },\n            { label: 'data-device', val: deviceType },\n            { label: 'data-increment', val: increment },\n            { label: 'data-currentPosition', val: currentPosition },\n            { label: 'data-length', val: sliderChildrenLength },\n            { label: 'data-slides', val: slides },\n        ]);\n        let sliderControls = createHTMLElement('div', [\n            { label: 'class', val: 'slider__controls' },\n        ]);\n        let sliderProgress = createHTMLElement('div', [\n            { label: 'class', val: 'slider__controls__progress' },\n        ]);\n        let sliderButtons = createHTMLElement('div', [\n            { label: 'class', val: 'slider__controls__buttons' },\n        ]);\n        // Slider progress\n        sliderProgress.appendChild(\n            createHTMLElement('span', [\n                { label: 'content', val: '1' },\n                { label: 'class', val: 'slide__controls__progress__active' },\n            ])\n        );\n        sliderProgress.appendChild(\n            createHTMLElement('span', [\n                { label: 'content', val: '/' },\n                { label: 'class', val: 'slide__controls__progress__separator' },\n            ])\n        );\n        // Total slides display\n        sliderProgress.appendChild(\n            createHTMLElement('span', [\n                {\n                    label: 'content',\n                    val: Math.ceil(sliderChildrenLength / increment),\n                },\n                { label: 'class', val: 'slide__controls__progress__total' },\n            ])\n        );\n        // Next / previous buttons\n        sliderButtons.appendChild(\n            createHTMLElement('button', [\n                { label: 'aria-label', val: 'Previous item' },\n                { label: 'disabled', val: true },\n                {\n                    label: 'class',\n                    val:\n                        'fas fa-arrow-left slider__controls__buttons__prev swiper-slider-arrow arrow-left--btn-prev',\n                },\n            ])\n        );\n\n        // If slider children items is equal to slider increment, disable next button by default.\n        if (sliderChildrenLength == increment) {\n            sliderButtons.appendChild(\n                createHTMLElement('button', [\n                    { label: 'aria-label', val: 'Next item' },\n                    {\n                        label: 'class',\n                        val:\n                            'fas fa-arrow-right slider__controls__buttons__next swiper-slider-arrow arrow-left--btn-next',\n                    },\n                    { label: 'disabled', val: true },\n                ])\n            );\n        } else {\n            sliderButtons.appendChild(\n                createHTMLElement('button', [\n                    { label: 'aria-label', val: 'Next item' },\n                    {\n                        label: 'class',\n                        val:\n                            'fas fa-arrow-right slider__controls__buttons__next swiper-slider-arrow arrow-left--btn-next',\n                    },\n                ])\n            );\n        }\n\n        sliderControlsWrap\n            .appendChild(sliderControls)\n            .appendChild(sliderProgress);\n        slider.appendChild(sliderControlsWrap);\n        sliderControls.appendChild(sliderButtons);\n        slider\n            .querySelectorAll('.slider__controls__buttons__prev')[0]\n            .classList.add('slider__controls__buttons__disabled');\n    }\n\n    // Build each type of controller (mobile, tablet, desktop)\n    sliderChildrenLength > 1 ? buildControls('mobile', 1, 1, false) : null;\n    sliderChildrenLength >= 2 ? buildControls('tablet', 2, 1, false) : null;\n    sliderChildrenLength >= 3 ? buildControls('desktop', 3, 1, false) : null;\n\n    let controlWraps = slider.querySelectorAll('.slider__controls__wrap');\n    /**\n     * For each instance of the controls, update the current position data attribute when next previous/buttons\n     * are selected. This means if the viewport changes, the correct value is passed to each control.\n     */\n    for (const controlWrap of controlWraps) {\n        let nextBtn = controlWrap.querySelector(\n            '.slider__controls__buttons__next'\n        );\n\n        /**\n         * Slide content display. Isolate event listener to specific controller clicked. This is needed\n         * to apply data attributes to the correct listings regardless of which controller is clicked.\n         */\n        nextBtn.addEventListener('click', () => {\n            //Get data attribute values from specific controller clicked.\n            let parentWrapper = nextBtn.closest('.slider__controls__wrap');\n            let sliderIncrement = parseInt(\n                parentWrapper.getAttribute('data-increment')\n            );\n            let currentPosition = parseInt(\n                parentWrapper.getAttribute('data-currentposition')\n            );\n            let sliderDirection = 'forward';\n            itemsDisplay(\n                sliderIncrement,\n                currentPosition,\n                sliderDirection,\n                slider\n            );\n        });\n\n        // Controller display. When user clicks, update each slider's progress indicator.\n        controlWrap\n            .querySelector('.slider__controls__buttons__next')\n            .addEventListener('click', () => {\n                let currentPosition = parseInt(\n                    controlWrap.getAttribute('data-currentposition')\n                );\n                let sliderIncrement = parseInt(\n                    controlWrap.getAttribute('data-increment')\n                );\n                progressUpdate(\n                    sliderIncrement,\n                    currentPosition,\n                    'forward',\n                    slider\n                );\n            });\n\n        let prevBtn = controlWrap.querySelector(\n            '.slider__controls__buttons__prev'\n        );\n\n        /**\n         * Slide content display. Isolate event listener to specific controller clicked. This is needed\n         * to apply data attributes to the correct listings regardless of which controller is clicked.\n         */\n        prevBtn.addEventListener('click', () => {\n            //Get data attribute values from specific controller clicked.\n            let parentWrapper = prevBtn.closest('.slider__controls__wrap');\n            let sliderIncrement = parseInt(\n                parentWrapper.getAttribute('data-increment')\n            );\n            let currentPosition = parseInt(\n                parentWrapper.getAttribute('data-currentposition')\n            );\n            let sliderDirection = 'back';\n            itemsDisplay(\n                sliderIncrement,\n                currentPosition,\n                sliderDirection,\n                slider\n            );\n        });\n\n        // Update all controllers' values accordingly\n        controlWrap\n            .querySelector('.slider__controls__buttons__prev')\n            .addEventListener('click', () => {\n                let currentPosition = parseInt(\n                    controlWrap.getAttribute('data-currentposition')\n                );\n                let sliderIncrement = parseInt(\n                    controlWrap.getAttribute('data-increment')\n                );\n                progressUpdate(\n                    sliderIncrement,\n                    currentPosition,\n                    'back',\n                    slider\n                );\n            });\n    }\n}\n\nexport default {\n    launchFn: launchResponsiveSlider,\n    launchQuery: `.${className}`,\n};\n","/**\n * Slider\n *\n * @module patterns/slider/slider\n * @author Walter Reyneke <walter.reyneke@city.ac.uk>\n * @copyright City, University of London 2019!\n */\n\nimport { removeClass, createHTMLElement } from '../../util';\nconst className = 'slider';\n\n/**\n * Creates a slider when adding slider class to an ul element. The li elements are the slides.\n *\n * @param {className} slider - class name of Ul element containing li (slides).\n */\n\nfunction initSlider(slider) {\n    // slider items count\n    let sliderChildren = [...slider.children];\n    let sliderChildrenLength = sliderChildren.length;\n\n    if (sliderChildrenLength < 2) {\n        removeClass(slider, className, false);\n        return;\n    }\n    \n\n    for (const sliderChild of sliderChildren.entries()) {\n        if (sliderChild[0] < 1) {\n            sliderChild[1].classList.add('slider__active-slide');\n        } else {\n            // only displays first slide and hides rest\n            sliderChild[1].classList.add('slider__slide');\n        }\n    }\n    /* generates controls */\n    let sliderControlsWrap = createHTMLElement('div', [\n        { label: 'class', val: 'slider__controls__wrap' },\n    ]);\n\n    let sliderControls = createHTMLElement('div', [\n        { label: 'class', val: 'slider__controls' },\n    ]);\n\n    let sliderProgress = createHTMLElement('div', [\n        { label: 'class', val: 'slider__controls__progress' },\n    ]);\n\n    let sliderButtons = createHTMLElement('div', [\n        { label: 'class', val: 'slider__controls__buttons' },\n    ]);\n\n    // generates progress\n    sliderProgress.appendChild(\n        createHTMLElement('span', [\n            { label: 'content', val: '1' },\n            {\n                label: 'class',\n                val: 'slide__controls__progress__active',\n            },\n        ])\n    );\n    sliderProgress.appendChild(\n        createHTMLElement('span', [\n            { label: 'content', val: ' /' },\n            {\n                label: 'class',\n                val: 'slide__controls__progress__separator',\n            },\n        ])\n    );\n    sliderProgress.appendChild(\n        createHTMLElement('span', [\n            { label: 'content', val: sliderChildrenLength },\n            { label: 'class', val: 'slide__controls__progress__total' },\n        ])\n    );\n\n    sliderControlsWrap.appendChild(sliderControls).appendChild(sliderProgress);\n    slider.appendChild(sliderControlsWrap);\n\n    // generates buttons\n    sliderButtons.appendChild(\n        createHTMLElement('button', [\n            { label: 'aria-label', val: 'Previous item' },\n            { label: 'disabled', val: 'true' },\n            {\n                label: 'class',\n                val:\n                    'fas fa-arrow-left slider__controls__buttons__prev swiper-slider-arrow arrow-left--btn-prev',\n            },\n        ])\n    );\n    sliderButtons.appendChild(\n        createHTMLElement('button', [\n            { label: 'aria-label', val: 'Next item' },\n            {\n                label: 'class',\n                val:\n                    'fas fa-arrow-right slider__controls__buttons__next swiper-slider-arrow arrow-right--btn-next',\n            },\n        ])\n    );\n\n    sliderControls.appendChild(sliderButtons);\n    slider\n        .querySelector('.slider__controls__buttons__prev')\n        .classList.add('slider__controls__buttons__disabled');\n\n    // Adds event listener to buttons\n    slider\n        .querySelector('.slider__controls__buttons__prev')\n        .addEventListener('click', function() {\n            handleSlideChange(-1, slider, sliderChildrenLength, sliderChildren);\n        });\n\n    slider\n        .querySelector('.slider__controls__buttons__next')\n        .addEventListener('click', function() {\n            handleSlideChange(1, slider, sliderChildrenLength, sliderChildren);\n        });\n}\n\n/**\n * Handles direction of slide when sliding left or right\n *\n * @param {number} direction - either 1 (next) or -1 (prev)\n * @param {className} slider - class name of Ul element containing li (slides).\n * * @param {number} sliderChildrenLength - number of element children of class name above.\n * * @param {Element} sliderChildren - the slides / li  elements.\n */\n\nfunction handleSlideChange(direction, slider, sliderChildrenLength, sliderChildren) {\n\n    // gets position of active slide\n    let activeSlide = parseInt(\n        slider.querySelector('.slide__controls__progress__active')\n            .innerText\n    );\n    let newSlide = activeSlide + direction;\n\n    // ensures you don't slide past first and last slide\n    if (newSlide !== 0 && !(newSlide > sliderChildrenLength)) {\n        // udpates progress\n        slider.querySelector(\n            '.slide__controls__progress__active'\n        ).innerHTML = newSlide;\n\n        sliderChildren.forEach(function(item, i) {\n            //displays new slide\n            if (i == newSlide - 1) {\n                item.classList.remove('slider__slide');\n                item.classList.add('slider__active-slide');\n            } else {\n                item.classList.remove('slider__active-slide');\n                item.classList.add('slider__slide');\n            }\n        });\n        // disables next & prev buttons when reaching beginning or end of slides\n        if (newSlide == 1) {\n            slider\n                .querySelector('.slider__controls__buttons__prev')\n                .classList.add('slider__controls__buttons__disabled');\n            slider\n                .querySelector('.slider__controls__buttons__prev')\n                .setAttribute('disabled', true);\n        } else {\n            slider\n                .querySelector('.slider__controls__buttons__prev')\n                .classList.remove('slider__controls__buttons__disabled');\n            slider\n                .querySelector('.slider__controls__buttons__prev')\n                .removeAttribute('disabled');\n        }\n\n        if (newSlide == sliderChildrenLength) {\n            slider\n                .querySelector('.slider__controls__buttons__next')\n                .classList.add('slider__controls__buttons__disabled');\n            slider\n                .querySelector('.slider__controls__buttons__next')\n                .setAttribute('disabled', true);\n        } else {\n            slider\n                .querySelector('.slider__controls__buttons__next')\n                .classList.remove('slider__controls__buttons__disabled');\n            slider\n                .querySelector('.slider__controls__buttons__next')\n                .removeAttribute('disabled');\n        }\n    }\n}\n\nexport default {\n    launchFn: initSlider,\n    launchQuery: `.${className}`,\n};\n","const className = 'fa-link';\n\nfunction copyIconToClipboard(elem) {\n    const copy = elem;\n    copy.parentNode.parentNode.style.position = 'relative';\n    copy.addEventListener('mouseover', e => {\n        let t = document.createElement('div');\n        let link = document.createElement('span');\n        let url = window.location.href;\n        t.className = 'tooltip';\n        link.className = 'link-copy';\n        let textlink = document.createTextNode(url);\n        let textnode = document.createTextNode('Copy link');\n        t.appendChild(textnode);\n        link.appendChild(textlink);\n        t.appendChild(link);\n        e.target.parentElement.parentElement.appendChild(t);\n        e.target.parentElement.parentElement.classList.add('copyLink');\n    });\n\n    copy.addEventListener('click', e => {\n        e.preventDefault();\n        let text = e.target.parentElement.parentElement.querySelector(\n            '.link-copy'\n        );\n        let range = document.createRange();\n        range.selectNode(text);\n        window.getSelection().addRange(range);\n        try {\n            // Now that we've selected the anchor text, execute the copy command\n            let successful = document.execCommand('copy');\n            let msg = successful ? 'successful' : 'unsuccessful';\n            e.target.parentElement.parentElement.querySelector(\n                '.tooltip'\n            ).textContent = 'Link Copied';\n            e.target.parentElement.parentElement\n                .querySelector('.tooltip')\n                .classList.add(msg);\n        } catch (err) {\n            throw new Error(e);\n        }\n\n        // Remove the selections - NOTE: Should use\n        // removeRange(range) when it is supported\n        window.getSelection().removeAllRanges();\n    });\n\n    copy.addEventListener('mouseout', e => {\n        //remove element from mouseover\n        e.target.parentElement.parentElement.querySelector('.tooltip').remove();\n    });\n}\n\nexport default {\n    launchFn: copyIconToClipboard,\n    launchQuery: `.${className}`,\n};\n","/**\n * prepareAccordionTabs\n *\n * @module patterns/tabs/prepareAccordionTabs\n * @author Web Development\n * @copyright City, University of London 2019\n */\nimport aria from '../../aria-attributes';\nimport { appendAll } from '../../util';\n\nconst className = 'tabs',\n    panelClassName = className + '__panel',\n    linksClassName = className + '__links';\n\n/**\n * Add accordion functionality for mobile.\n *\n * @param {HTMLElement} tabs - An element transformed into a tabbed section\n */\nfunction accordionize(tabs) {\n    const wrapper = document.createElement('div'),\n        accordion = document.createElement('div');\n\n    wrapper.className = 'tabs--accordion';\n    accordion.className = 'accordion';\n    accordion.id = `accordion${tabs.dataset.assetid}`;\n    accordion.dataset.allowsingle = 'false';\n    accordion.dataset.defaultopen = 'true';\n    accordion.dataset.level = tabs.dataset.level;\n    accordion.dataset.tabs = tabs.dataset.tabs;\n    accordion.dataset.toggleopen = 'true';\n\n    Array.from(\n        tabs.parentNode.querySelectorAll(`#${tabs.id} > .${panelClassName}`)\n    ).forEach(panel => {\n        const heading = panel.querySelector(`.${panelClassName}__heading`),\n            body = panel.querySelector(`.${panelClassName}__body`),\n            accordionHeading = document.createElement(\n                `h${accordion.dataset.level}`\n            ),\n            accordionSection = document.createElement('div'),\n            accordionWrapper = document.createElement('div');\n\n        accordionHeading.className = 'accordion__heading';\n        accordionHeading.id = `accordion${tabs.dataset.assetid}-header${panel.dataset.assetid}`;\n        accordionHeading.dataset.tabid = panel.getAttribute(aria.labelledBy);\n        accordionHeading.innerText = heading.innerText.trim();\n\n        accordionSection.className = 'accordion__body';\n        accordionSection.id = `accordion${tabs.dataset.assetid}-body${panel.dataset.assetid}`;\n        accordionWrapper.className = 'wrapper--accordion__body__content';\n        accordionWrapper.innerHTML = body.innerHTML;\n        accordionSection.appendChild(accordionWrapper);\n\n        appendAll(accordion, [accordionHeading, accordionSection]);\n    });\n\n    tabs.parentNode.insertBefore(wrapper, tabs);\n    wrapper.appendChild(tabs);\n    wrapper.appendChild(accordion);\n\n    return accordion;\n}\n\nfunction prepareAccordionTabs(tabs) {\n    const controls = tabs.querySelector(`.${linksClassName}`),\n        linkItems = Array.from(controls.querySelectorAll('li')),\n        numberOfTabs = Number.parseInt(tabs.dataset.mobiletabs);\n\n    if (\n        linkItems.length > numberOfTabs &&\n        (!tabs.dataset.neveraccordion ||\n            !tabs.dataset.neveraccordion === 'true')\n    ) {\n        return accordionize(tabs);\n    } else {\n        return null;\n    }\n}\n\nexport default prepareAccordionTabs;\n","/**\n * Tabs\n *\n * @module patterns/tabs/tabs\n * @author Web Development\n * @copyright City, University of London 2018-2019\n */\nimport scroll from 'zenscroll';\nimport { reduceMotion, removeClass } from '../../util';\nimport aria from '../../aria-attributes';\n\nconst className = 'tabs',\n    panelClassName = className + '__panel',\n    contentClassName = panelClassName + '__content',\n    linksClassName = className + '__links',\n    [endKey, homeKey, arrowLeft, arrowUp, arrowRight, arrowDown] = [\n        35,\n        36,\n        37,\n        38,\n        39,\n        40,\n    ],\n    scrollDuration = reduceMotion() ? 0 : 999,\n    scrollTo = false;\n\n/**\n * Set the attributes of a tab to be selected or not selected.\n *\n * Unselected tabs are removed from the tab order.\n *\n * @param {HTMLAnchorElement} link - The anchor element to toggle.\n * @param {boolean} selected - Set the element to be selected?\n */\nfunction toggleLink(link, selected) {\n    link.setAttribute(aria.selected, selected);\n\n    if (selected) {\n        link.setAttribute(aria.current, true);\n    } else {\n        link.removeAttribute(aria.current);\n    }\n}\n\n/**\n * Change the selection to the requested tab.\n *\n * @param {HTMLAnchorElement} newTab - The selected tab.\n */\nfunction selectTab(newTab) {\n    const tabs = newTab.closest(`.${className}`),\n        controls = tabs.querySelector(`.${linksClassName}`),\n        linkItems = Array.from(controls.querySelectorAll('li')),\n        panels = Array.from(tabs.childNodes).filter(\n            node => node.className && node.className === panelClassName\n        );\n\n    /**\n     * Unselect every tab and related panel.\n     */\n    linkItems.forEach(linkItem => {\n        toggleLink(linkItem.firstElementChild, false);\n    });\n    panels.forEach(panel => panel.setAttribute('hidden', 'true'));\n\n    /**\n     * Select the requested tab.\n     */\n    toggleLink(newTab, true);\n    tabs.querySelector(newTab.hash).removeAttribute('hidden');\n    history.pushState(null, null, newTab.hash);\n\n    /**\n     * Move focus to the section and optionally scroll it into view.\n     */\n    newTab.focus();\n    scrollTo && scroll.to(tabs, scrollDuration);\n}\n\n/**\n * Respond to event changing tab selection.\n *\n * @param {Event} e - The initiating event.\n * @param {HTMLAnchorElement} newTab - The selected tab.\n */\nfunction selectTabEvent(e, newTab) {\n    e.preventDefault();\n    selectTab(newTab);\n}\n\n/**\n * Respond to cursor key events inside the tabbed section.\n *\n * @param {Event} e - The initiating keydown event.\n * @param {HTMLElement} tabs - The controls for the tabbed section.\n */\nfunction keyEvents(e, tabs) {\n    const currentTab = tabs.querySelector(`[${aria.selected}=\"true\"]`),\n        currentTabLI = currentTab.parentNode;\n    let newTab = null;\n    if (arrowLeft === e.which) {\n        /**\n         * Previous tab has been requested - if we're already at the beginning,\n         * we need to wrap around to the last tab.\n         */\n        currentTabLI.previousElementSibling\n            ? (newTab = currentTabLI.previousElementSibling.firstElementChild)\n            : (newTab = tabs.querySelector('li:last-of-type a'));\n    } else if (arrowRight === e.which) {\n        /**\n         * Next tab has been requested - if we're already at the end, we need\n         * to wrap around to the first tab.\n         */\n        currentTabLI.nextElementSibling\n            ? (newTab = currentTabLI.nextElementSibling.firstElementChild)\n            : (newTab = tabs.querySelector('li:first-of-type a'));\n    } else if (arrowDown === e.which) {\n        /**\n         * Move focus into the tab content.\n         */\n        tabs.querySelector(currentTab.hash).focus();\n    } else if (arrowUp === e.which) {\n        /**\n         * Move focus to the currently selected tab control.\n         */\n        currentTab.focus();\n    } else if (homeKey === e.which) {\n        /**\n         * First tab\n         */\n        newTab = tabs.querySelector('li:first-of-type a');\n    } else if (endKey === e.which) {\n        /**\n         * Last tab\n         */\n        newTab = tabs.querySelector('li:last-of-type a');\n    }\n    newTab && selectTabEvent(e, newTab);\n}\n/**\n * Set attributes and listeners for the tabbed section controls.\n *\n * @param {HTMLLIElement[]} linkItems - An array of list items containing the tab anchors.\n * @returns {boolean} A boolean indicating whether the current URL has an anchor pointing to a panel in this tabbed section.\n */\nfunction prepareLinks(linkItems) {\n    let idLinked = false;\n\n    linkItems.forEach(linkItem => {\n        const link = linkItem.firstElementChild;\n\n        linkItem.setAttribute('role', 'presentation');\n        link.setAttribute('role', 'tab');\n\n        if (link.hash === window.location.hash) {\n            idLinked = link.hash;\n            toggleLink(link, true);\n        } else {\n            toggleLink(link, false);\n        }\n\n        link.addEventListener('click', e => selectTabEvent(e, link), true);\n    });\n\n    return idLinked;\n}\n\n/**\n * Set attributes for the tabbed section panels.\n *\n * @param {HTMLElement[]} panels - An array of tab panels.\n */\nfunction preparePanels(panels) {\n    panels.forEach(panel => {\n        const wrapper = document.createElement('div'),\n            panelElements = Array.from(panel.children);\n        wrapper.className = contentClassName;\n        panelElements.forEach(element => wrapper.appendChild(element));\n        panel.appendChild(wrapper);\n        panel.setAttribute('role', 'tabpanel');\n        panel.setAttribute('tabindex', 0);\n        panel.setAttribute('hidden', 'true');\n    });\n}\n\n/**\n * Transform an element with the tabs class name into a tabbed section.\n *\n * A tabbed section is expected to contain a list of anchors pointing to each\n * section, followed by the sections themselves.\n *\n * e.g.\n *\n * <div class=\"tabs\">\n * <ul class=\"tabs__links\">\n * <li><a href=\"#tab1\">Tab 1</a></li>\n * <li><a href=\"#tab2\">Tab 2</a></li>\n * </ul>\n * <section class=\"tabs__panel\" id=\"tab1\">Content 1</section>\n * <section class=\"tabs__panel\" id=\"tab2\">Content 2</section>\n * </div>\n *\n * @param {HTMLElement} tabs - An element with the tabs class\n */\nfunction launchTabs(tabs) {\n    const controls = tabs.querySelector(`.${linksClassName}`),\n        linkItems = Array.from(controls.querySelectorAll('li')),\n        panels = Array.from(tabs.childNodes).filter(\n            node => node.className && node.className === panelClassName\n        );\n\n    if (linkItems.length === 1) {\n        /**\n         * don't make one tab into a tabbed section, makes no sense\n         */\n        removeClass(tabs, className, false);\n        return;\n    }\n\n    controls.setAttribute('role', 'tablist');\n    preparePanels(panels);\n\n    const idLinked = prepareLinks(linkItems);\n\n    /**\n     * If the URL doesn't include a hash pointing to one of these tabs, we\n     * select the first one. Otherwise unhide the first tab.\n     */\n    if (!idLinked) {\n        toggleLink(linkItems[0].firstElementChild, true);\n        panels[0].removeAttribute('hidden');\n    } else {\n        const selectedTab = tabs.querySelector(idLinked);\n        selectedTab.removeAttribute('hidden');\n    }\n\n    /**\n     * Enable keyboard access to tabs with the cursor keys.\n     */\n    tabs.addEventListener('keydown', e => keyEvents(e, tabs), true);\n}\n\nexport default {\n    launchFn: launchTabs,\n    launchQuery: `.${className}`,\n};\n","/**\n * Useful utility functions\n *\n * @module util\n * @author Web Development\n * @copyright City, University of London 2018\n */\n\n/**\n * Turns string boolean into real boolean.\n *\n * @param {string} s - A string that may be 'true'.\n * @returns {boolean} True if 'true'.\n */\nexport function toBool(s) {\n    return s === 'true' ? true : false;\n}\n\nconst partialMatchFn = m => s => s.indexOf(m) < 0,\n    fullMatchFn = m => s => s !== m;\n\n/**\n * Remove a class name from an HTML element.\n *\n * @param {HTMLElement} elem - An HTML element.\n * @param {string} className - A string representing the class to remove.\n * @param {boolean} [removePartials] - If true, remove partially matching classes.\n */\nexport function removeClass(elem, className, removePartials) {\n    const matchFn = removePartials\n        ? partialMatchFn(className)\n        : fullMatchFn(className);\n    elem.className = elem.className\n        .split(/\\s+/)\n        .filter(s => matchFn(s))\n        .join(' ');\n}\n\n/**\n * Detect whether reduced motion is enabled.\n *\n * If it is, you should shortcut animations, disable autoplay elements, avoid\n * smooth scrolling in favour of jump scrolling, etc.\n *\n * Currently unsupported by Chrome, but works in Safari and Firefox.\n *\n * @returns {boolean} Boolean indicating that the reduce motion media query matches.\n */\nexport function reduceMotion() {\n    const reducedMotionQuery = window.matchMedia(\n        '(prefers-reduced-motion: reduce)'\n    );\n    return reducedMotionQuery.matches ? true : false;\n}\n\n/**\n * Predicate testing whether an element is currently visible, as opposed to\n * displayed: none; or similar. Doesn't necessarily mean it's visible in the\n * window.\n *\n * @param {HTMLElement} elem - An HTML element.\n * @returns {boolean} - Is it visible?\n */\nexport function isVisible(elem) {\n    return elem.offsetHeight !== 0 && elem.offsetWidth !== 0 ? true : false;\n}\n\n/**\n * Predicate testing whether an element is positioned in the window.\n *\n *\n * @param {HTMLElement} elem - An HTML element.\n * @returns {boolean} - Is it onscreen?\n */\nexport function verticallyInWindow(elem) {\n    return elem.getBoundingClientRect().top >= 0 &&\n        elem.getBoundingClientRect().top <= window.innerHeight\n        ? true\n        : false;\n}\n\n/**\n * Turn a query string into an object.\n *\n * @param {string} parameterString - An HTML query string.\n * @returns {object} An object containing the parameters.\n */\nexport function parametersToObject(parameterString) {\n    const parameters = {};\n    parameterString\n        .substr(1)\n        .split('&')\n        .forEach(parameter => {\n            const [k, v] = parameter.split('=');\n            parameters[k] = v;\n        });\n    return parameters;\n}\n\n/**\n * Turn an object into a query string.\n *\n * @param {object} parameterObj - An object containing the parameters and their values.\n * @returns {string} A string of the parameters.\n */\nexport function objectToParameters(parameterObj) {\n    if (Object.keys(parameterObj).length > 0) {\n        let parameters = '?';\n        for (const key in parameterObj) {\n            parameters.length !== 1 && (parameters += '&');\n            parameters += key + '=' + parameterObj[key];\n        }\n        return parameters;\n    } else {\n        return '';\n    }\n}\n\n/**\n * Track a Google Analytics event.\n *\n * @param {string} event - The event key for Tag Manager.\n * @param {string} eventCategory - The event category.\n * @param {string} eventAction - The event action.\n * @param {string} [eventLabel] - The event label.\n * @param {number} [eventValue] - The event value.\n * @param {boolean} [nonInteractionHit] - Does this count as interacting with the page?\n */\nexport function gaEvent(\n    event,\n    eventCategory,\n    eventAction,\n    eventLabel,\n    eventValue,\n    nonInteractionHit\n) {\n    window.dataLayer = window.dataLayer || [];\n    window.dataLayer.push({\n        event: event,\n        eventCategory: eventCategory,\n        eventAction: eventAction,\n        eventLabel: eventLabel,\n        eventValue: eventValue,\n        nonInteractionHit: nonInteractionHit,\n    });\n}\n\n/**\n * Append an array of elements to an element.\n *\n * @param {HTMLElement} elem - The parent element.\n * @param {HTMLElement[]} children - An array of elements to append to it.\n */\nexport function appendAll(elem, children) {\n    children.forEach(child => elem.appendChild(child));\n}\n\n/**\n * Convert a pixel value to equivalent REM value.\n *\n * @param {number} pxValue - Value in pixels.\n */\nexport function pxToRem(pxValue) {\n    let browserWidth = document.documentElement.scrollWidth,\n        fontBase;\n    browserWidth > 768 ? (fontBase = 18) : (fontBase = 16);\n    let remValue = pxValue / fontBase;\n    return remValue;\n}\n\n/**\n * Extract number from string, e.g. return '123' from string 'a1b2c3'.\n *\n * @param {string} string - String\n */\nexport function numberFromString(string) {\n    let number = string.replace(/\\D/g, '');\n    return number;\n}\n\n/**\n * Calculates viewport width to determinte if using mobile\n * @param {number} number - width of screen, with default value = 432.\n *\n */\nexport function isMobile(screen = 432) {\n    const viewPortWidth = window.innerWidth;\n    const mobileScreen = screen;\n\n    if (viewPortWidth < mobileScreen) {\n        return true;\n    }\n}\n\n/**\n *\n * Turn DOM elements to array e.g return [li, li, li] from DOM element selecting 'li' <ul><li></li><li></li><li></li></ul>\n *\n * @param {object} object - Object\n */\n\nexport function toArray(obj) {\n    let array = [];\n    // iterate backwards ensuring that length is an UInt32\n    for (let i = obj.length >>> 0; i--; ) {\n        array[i] = obj[i];\n    }\n    return array;\n}\n\n/**\n *\n * Check browser user agent is IE or edge and return version number\n *\n */\n\nexport function detectIE() {\n    let ua = window.navigator.userAgent;\n\n    let msie = ua.indexOf('MSIE ');\n    if (msie > 0) {\n        // IE 10 or older => return version number\n        return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n    }\n\n    let trident = ua.indexOf('Trident/');\n    if (trident > 0) {\n        // IE 11 => return version number\n        let rv = ua.indexOf('rv:');\n        return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n    }\n\n    let edge = ua.indexOf('Edge/');\n    if (edge > 0) {\n        // Edge (IE 12+) => return version number\n        return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n    }\n\n    // other browser\n    return false;\n}\n\n/**\n *\n * Check If browser support Intersection Observer API\n *\n * @returns {Boolean} -\n */\n\nexport function checkIntersectionObserver() {\n    if (\n        'IntersectionObserver' in window &&\n        'IntersectionObserverEntry' in window &&\n        'intersectionRatio' in window.IntersectionObserverEntry.prototype\n    ) {\n        return true;\n    } else {\n        return false;\n    }\n}\n\n/**\n * Create elements containing classes, content and any other attributes\n *\n * @param {string} type - Type of element to create, e.g. \"div\", \"button\".\n * @param {array} attributes - Array of objects specifying which attributes to assign to the element i.e. {label : \"class\", val : \"container\"}\n */\n\nexport function createHTMLElement(type, attributes) {\n    let el = document.createElement(type);\n    attributes.map(function(att) {\n        att.label === 'content'\n            ? el.appendChild(document.createTextNode(att.val))\n            : el.setAttribute(att.label, att.val);\n    });\n    return el;\n}\n","/* (ignored) */","/* (ignored) */"],"sourceRoot":""}